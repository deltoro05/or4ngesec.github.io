<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Written by S1eepy &amp; ZhuZi'><title>HWS2022冬令营预选赛 Writeup</title>

<link rel='canonical' href='https://or4ngesec.github.io/post/hws2022-writeup/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='HWS2022冬令营预选赛 Writeup'>
<meta property='og:description' content='Written by S1eepy &amp; ZhuZi'>
<meta property='og:url' content='https://or4ngesec.github.io/post/hws2022-writeup/'>
<meta property='og:site_name' content='or4nge'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Writeup' /><meta property='article:tag' content='HWS' /><meta property='article:tag' content='Re' /><meta property='article:tag' content='Crypto' /><meta property='article:tag' content='Misc' /><meta property='article:published_time' content='2022-01-26T13:03:21&#43;08:00'/><meta property='article:modified_time' content='2022-01-26T13:03:21&#43;08:00'/><meta property='og:image' content='https://or4ngesec.github.io/post/hws2022-writeup/cover.jpg' />
<meta name="twitter:title" content="HWS2022冬令营预选赛 Writeup">
<meta name="twitter:description" content="Written by S1eepy &amp; ZhuZi"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://or4ngesec.github.io/post/hws2022-writeup/cover.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/hws2022-writeup/">
                <img src="/post/hws2022-writeup/cover_hu31039705144761defd1e1848d4287a81_131160_800x0_resize_q75_box.jpg"
                        srcset="/post/hws2022-writeup/cover_hu31039705144761defd1e1848d4287a81_131160_800x0_resize_q75_box.jpg 800w, /post/hws2022-writeup/cover_hu31039705144761defd1e1848d4287a81_131160_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="476" 
                        loading="lazy"
                        alt="Featured image of post HWS2022冬令营预选赛 Writeup" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/hws2022-writeup/">HWS2022冬令营预选赛 Writeup</a>
    </h2>

    
    <h3 class="article-subtitle">
        Written by S1eepy &amp; ZhuZi
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 26, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="re">RE</h2>
<h3 id="babyvm">babyVM</h3>
<p>将花指令patch掉</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 406; 
			flex-basis: 975px"
	>
	<a href="/post/hws2022-writeup/image-20220124213318513.png" data-size="943x232">
		<img src="/post/hws2022-writeup/image-20220124213318513.png"
			width="943"
			height="232"
			srcset="/post/hws2022-writeup/image-20220124213318513_hu7b60cca09a3c5aed19ccb63bc8a32b5c_30800_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124213318513_hu7b60cca09a3c5aed19ccb63bc8a32b5c_30800_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 274; 
			flex-basis: 658px"
	>
	<a href="/post/hws2022-writeup/image-20220124213343256.png" data-size="741x270">
		<img src="/post/hws2022-writeup/image-20220124213343256.png"
			width="741"
			height="270"
			srcset="/post/hws2022-writeup/image-20220124213343256_hu38ef6290adb576484852bfcc831e76ce_23726_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124213343256_hu38ef6290adb576484852bfcc831e76ce_23726_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>将patch好的应用到文件。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 121; 
			flex-basis: 292px"
	>
	<a href="/post/hws2022-writeup/image-20220124213720377.png" data-size="806x662">
		<img src="/post/hws2022-writeup/image-20220124213720377.png"
			width="806"
			height="662"
			srcset="/post/hws2022-writeup/image-20220124213720377_hu05ab85e67e7f95cf07857bdd8b104ffd_61366_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124213720377_hu05ab85e67e7f95cf07857bdd8b104ffd_61366_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>能看出来是个虚拟机逆向题</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 343; 
			flex-basis: 823px"
	>
	<a href="/post/hws2022-writeup/image-20220124213829067.png" data-size="563x164">
		<img src="/post/hws2022-writeup/image-20220124213829067.png"
			width="563"
			height="164"
			srcset="/post/hws2022-writeup/image-20220124213829067_hu42eb3fcb2176931fe26fa2afdfb86a31_14931_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124213829067_hu42eb3fcb2176931fe26fa2afdfb86a31_14931_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>动态调试的过程中可以看到程序向内存里写了一段数据</p>
<pre tabindex="0"><code>0xFF,0x223,0x23B,0x237,0x237,0x24B,0x22B,0xFB,0x22B,0x223,0x24F,0xEF,0x237,0xEF,0x24F,0x24F,0x223,0x223,0x23B,0x237,0xFF,0x233,0x233,0x233,0x237,0x24B,0x233,0x24F,0x22B,0x22B,0x24B,0xEF
</code></pre><p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 695; 
			flex-basis: 1669px"
	>
	<a href="/post/hws2022-writeup/image-20220124213857515.png" data-size="988x142">
		<img src="/post/hws2022-writeup/image-20220124213857515.png"
			width="988"
			height="142"
			srcset="/post/hws2022-writeup/image-20220124213857515_hu1aae7d93d95461b307a001febb94758c_15221_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124213857515_hu1aae7d93d95461b307a001febb94758c_15221_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>这个部分把上述数据每一个都减了0x63</p>
<p>程序获得用户的输入</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 360; 
			flex-basis: 865px"
	>
	<a href="/post/hws2022-writeup/image-20220124214023035.png" data-size="483x134">
		<img src="/post/hws2022-writeup/image-20220124214023035.png"
			width="483"
			height="134"
			srcset="/post/hws2022-writeup/image-20220124214023035_huec807fb922fa529e819d2e56d9d0ff60_9215_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124214023035_huec807fb922fa529e819d2e56d9d0ff60_9215_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>比较的过程中可以发现，用户输入的长度应该是0x26</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 1135; 
			flex-basis: 2725px"
	>
	<a href="/post/hws2022-writeup/image-20220124214035403.png" data-size="1022x90">
		<img src="/post/hws2022-writeup/image-20220124214035403.png"
			width="1022"
			height="90"
			srcset="/post/hws2022-writeup/image-20220124214035403_hu65dbebb5353a1aad675fbb63c386a95d_11327_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124214035403_hu65dbebb5353a1aad675fbb63c386a95d_11327_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>并且在后面比较的过程中，flag{}这几个字符占了6个。</p>
<p>再向后跟踪的过程中发现</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 582; 
			flex-basis: 1398px"
	>
	<a href="/post/hws2022-writeup/image-20220124214239982.png" data-size="781x134">
		<img src="/post/hws2022-writeup/image-20220124214239982.png"
			width="781"
			height="134"
			srcset="/post/hws2022-writeup/image-20220124214239982_hu4365a3459f0c5ff67524505cbd202153_13834_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124214239982_hu4365a3459f0c5ff67524505cbd202153_13834_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>用户的输入和0x42做了异或</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 300; 
			flex-basis: 722px"
	>
	<a href="/post/hws2022-writeup/image-20220124214339739.png" data-size="611x203">
		<img src="/post/hws2022-writeup/image-20220124214339739.png"
			width="611"
			height="203"
			srcset="/post/hws2022-writeup/image-20220124214339739_hu17c66bc8db7f858487d4678cd9dafe2f_19942_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124214339739_hu17c66bc8db7f858487d4678cd9dafe2f_19942_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>再把结果左移两位，和前面的数据做了比较，因此最后的exp是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dump <span style="color:#f92672">=</span> [<span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">448</span>, <span style="color:#ae81ff">472</span>, <span style="color:#ae81ff">468</span>, <span style="color:#ae81ff">468</span>, <span style="color:#ae81ff">488</span>, <span style="color:#ae81ff">456</span>, <span style="color:#ae81ff">152</span>, <span style="color:#ae81ff">456</span>, <span style="color:#ae81ff">448</span>, <span style="color:#ae81ff">492</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">468</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">492</span>, <span style="color:#ae81ff">492</span>, <span style="color:#ae81ff">448</span>, <span style="color:#ae81ff">448</span>, <span style="color:#ae81ff">472</span>, <span style="color:#ae81ff">468</span>, <span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">464</span>, <span style="color:#ae81ff">464</span>, <span style="color:#ae81ff">464</span>, <span style="color:#ae81ff">468</span>, <span style="color:#ae81ff">488</span>, <span style="color:#ae81ff">464</span>, <span style="color:#ae81ff">492</span>, <span style="color:#ae81ff">456</span>, <span style="color:#ae81ff">456</span>, <span style="color:#ae81ff">488</span>, <span style="color:#ae81ff">140</span>]

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(dump)):
    print(chr((dump[i]<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">^</span><span style="color:#ae81ff">0x42</span>),end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
    
print()
<span style="color:#75715e"># e247780d029a7a992247e6667869008a</span>
</code></pre></div><h3 id="easyvm">EasyVM</h3>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 187; 
			flex-basis: 450px"
	>
	<a href="/post/hws2022-writeup/image-20220124214737380.png" data-size="904x482">
		<img src="/post/hws2022-writeup/image-20220124214737380.png"
			width="904"
			height="482"
			srcset="/post/hws2022-writeup/image-20220124214737380_hu90329dd4f804f11a6b84fdae40fc4f0a_51553_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124214737380_hu90329dd4f804f11a6b84fdae40fc4f0a_51553_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>和上题一样，去除应该应该去除的花指令。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 266; 
			flex-basis: 638px"
	>
	<a href="/post/hws2022-writeup/image-20220124215558634.png" data-size="556x209">
		<img src="/post/hws2022-writeup/image-20220124215558634.png"
			width="556"
			height="209"
			srcset="/post/hws2022-writeup/image-20220124215558634_huee033b6ad3bb9e3944781f6c5e4969e7_18619_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124215558634_huee033b6ad3bb9e3944781f6c5e4969e7_18619_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>然后引发了一个异常</p>
<p>观察异常处理函数</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 91; 
			flex-basis: 220px"
	>
	<a href="/post/hws2022-writeup/image-20220124215651860.png" data-size="603x656">
		<img src="/post/hws2022-writeup/image-20220124215651860.png"
			width="603"
			height="656"
			srcset="/post/hws2022-writeup/image-20220124215651860_hu9d013bdd10615fce5c56f95682edba1a_38201_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124215651860_hu9d013bdd10615fce5c56f95682edba1a_38201_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>看到输入的长度为42</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 176; 
			flex-basis: 424px"
	>
	<a href="/post/hws2022-writeup/image-20220124215732319.png" data-size="1073x607">
		<img src="/post/hws2022-writeup/image-20220124215732319.png"
			width="1073"
			height="607"
			srcset="/post/hws2022-writeup/image-20220124215732319_hu64b9e5529f4cbec42aa545f110a69e47_42221_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124215732319_hu64b9e5529f4cbec42aa545f110a69e47_42221_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>在这个函数里面输入经过了base64编码，而且和0xa,0xb,0xc,0xd异或</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 112; 
			flex-basis: 269px"
	>
	<a href="/post/hws2022-writeup/image-20220124215838225.png" data-size="572x509">
		<img src="/post/hws2022-writeup/image-20220124215838225.png"
			width="572"
			height="509"
			srcset="/post/hws2022-writeup/image-20220124215838225_hub6fe97bc063a3f7a40f2052f0e450051_57626_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124215838225_hub6fe97bc063a3f7a40f2052f0e450051_57626_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>然后根据函数地址表进行虚拟机逻辑。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 115; 
			flex-basis: 277px"
	>
	<a href="/post/hws2022-writeup/image-20220124215938533.png" data-size="773x668">
		<img src="/post/hws2022-writeup/image-20220124215938533.png"
			width="773"
			height="668"
			srcset="/post/hws2022-writeup/image-20220124215938533_hu9d373a3ebe2e6ad93ff8964c6d85a828_45757_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124215938533_hu9d373a3ebe2e6ad93ff8964c6d85a828_45757_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>动态调试中可以发现函数将输入经过特制变换的 base64 和前一个结果异或，和 0xee 异或，再进行比较，然后动态调试的过程中把最终的结果提取出来，可以写出脚本。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> base64

dump <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x00</span>,<span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0xAC</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0xDE</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0xEE</span>, <span style="color:#ae81ff">0x5F</span>, 
  <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0xB5</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0xB8</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xC2</span>, <span style="color:#ae81ff">0x4E</span>, <span style="color:#ae81ff">0x9C</span>, <span style="color:#ae81ff">0x4A</span>, 
  <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0xF0</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x8A</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0xE5</span>, <span style="color:#ae81ff">0x54</span>, 
  <span style="color:#ae81ff">0xFF</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xD5</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0xAD</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0xD8</span>, <span style="color:#ae81ff">0x50</span>, 
  <span style="color:#ae81ff">0xF9</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0x4A</span>, <span style="color:#ae81ff">0xFD</span>, <span style="color:#ae81ff">0x2F</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x36</span>, 
  <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0xFB</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0xE3</span>]
x <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xa</span>,<span style="color:#ae81ff">0xb</span>,<span style="color:#ae81ff">0xc</span>,<span style="color:#ae81ff">0xd</span>]

dump <span style="color:#f92672">=</span> dump[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]


dump1 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,len(dump)):
    dump1<span style="color:#f92672">.</span>append(dump[i]<span style="color:#f92672">^</span>dump[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">^</span><span style="color:#ae81ff">0xee</span>)


dump1 <span style="color:#f92672">=</span> dump1[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]


dump2 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(dump1)):
    dump2<span style="color:#f92672">.</span>append((dump1[i]<span style="color:#f92672">^</span>x[(i)<span style="color:#f92672">%</span><span style="color:#ae81ff">4</span>])<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">1</span>,byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;big&#39;</span>))

print (base64<span style="color:#f92672">.</span>b64decode(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(dump2)))
<span style="color:#75715e"># b&#39;flag{2586dc76-98d5-44e2-ad58-d06e6559d82a}&#39;</span>
</code></pre></div><h2 id="crypto">Crypto</h2>
<h3 id="babyrsa">babyrsa</h3>
<p>把 n 扔到 factordb 上直接分解了出来，拿到 pq，直接解密就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exgcd</span>(a, b):
	<span style="color:#66d9ef">if</span> b <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
		<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, a
	<span style="color:#66d9ef">else</span>:
		x, y, q <span style="color:#f92672">=</span> exgcd(b, a <span style="color:#f92672">%</span> b)
		x, y <span style="color:#f92672">=</span> y, (x <span style="color:#f92672">-</span> (a <span style="color:#f92672">//</span> b) <span style="color:#f92672">*</span> y)
		<span style="color:#66d9ef">return</span> x, y, q

p <span style="color:#f92672">=</span> <span style="color:#ae81ff">98197216341757567488149177586991336976901080454854408243068885480633972200382596026756300968618883148721598031574296054706280190113587145906781375704611841087782526897314537785060868780928063942914187241017272444601926795083433477673935377466676026146695321415853502288291409333200661670651818749836420808033</span>
q <span style="color:#f92672">=</span> <span style="color:#ae81ff">133639826298015917901017908376475546339925646165363264658181838203059432536492968144231040597990919971381628901127402671873954769629458944972912180415794436700950304720548263026421362847590283353425105178540468631051824814390421486132775876582962969734956410033443729557703719598998956317920674659744121941513</span>
N <span style="color:#f92672">=</span> <span style="color:#ae81ff">13123058934861171416713230498081453101147538789122070079961388806126697916963123413431108069961369055630747412550900239402710827847917960870358653962948282381351741121884528399369764530446509936240262290248305226552117100584726616255292963971141510518678552679033220315246377746270515853987903184512948801397452104554589803725619076066339968999308910127885089547678968793196148780382182445270838659078189316664538631875879022325427220682805580410213245364855569367702919157881367085677283124732874621569379901272662162025780608669577546548333274766058755786449491277002349918598971841605936268030140638579388226573929</span>
<span style="color:#66d9ef">assert</span> p <span style="color:#f92672">*</span> q <span style="color:#f92672">==</span> N
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">2199344405076718723439776106818391416986774637417452818162477025957976213477191723664184407417234793814926418366905751689789699138123658292718951547073938244835923378103264574262319868072792187129755570696127796856136279813658923777933069924139862221947627969330450735758091555899551587605175567882253565613163972396640663959048311077691045791516671857020379334217141651855658795614761069687029140601439597978203375244243343052687488606544856116827681065414187957956049947143017305483200122033343857370223678236469887421261592930549136708160041001438350227594265714800753072939126464647703962260358930477570798420877</span>
flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">1492164290534197296766878830710549288168716657792979479408332026408553210558539364503279432780006256047888761718878241924947937039103166564146378209168719163067531460700424309878383312837345239570897122826051628153030129647363574035072755426112229160684859510640271933580581310029921376842631120847546030843821787623965614564745724229763999106839802052036834811357341644073138100679508864747009014415530176077648226083725813290110828240582884113726976794751006967153951269748482024859714451264220728184903144004573228365893961477199925864862018084224563883101101842275596219857205470076943493098825250412323522013524</span>
d <span style="color:#f92672">=</span> exgcd(e, (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>))[<span style="color:#ae81ff">0</span>]
print(n2s(pow(flag, d, N)))
</code></pre></div><p>flag:</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 1129; 
			flex-basis: 2711px"
	>
	<a href="/post/hws2022-writeup/image-20220124162048959.png" data-size="1887x167">
		<img src="/post/hws2022-writeup/image-20220124162048959.png"
			width="1887"
			height="167"
			srcset="/post/hws2022-writeup/image-20220124162048959_hua0f4205903f448830dc5078d7cdf74b6_81039_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124162048959_hua0f4205903f448830dc5078d7cdf74b6_81039_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="crypto_elgamal">crypto_Elgamal</h3>
<p>首先是一个 LCG 的链式求解，通过五个值解出 A,B,q</p>
<p>分析 elgmal 签名，同样使用了 LCG，那么有两个加密值就能够恢复消息，推导如下</p>
<p>$$
c_{2'}\equiv mh^{Ar_1+B}
\equiv m(h^{r_1})^Ah^B
\equiv mh^{r_1}(h^{r_1})^{A-1}h^B
\equiv c_2(h^{r_1})^{A-1}h^B\pmod p
$$</p>
<p>$$
\therefore (h^{r_1})^{A-1} \equiv c_{2'}c_2^{-1}h^{-B} \pmod p
$$</p>
<p>可以设法求出 $h^{r_1}$ 的值，然后就可以通过 $c_2=mh^{r_1}$ 求解出 m 值</p>
<p>但由于 $A-1$ 和 $p-1$ 不互素，无法直接求得逆元，因此需要高次同余开根算法，这里使用了 AMM 算法进行求解，按照论文直接复现出来，得到 $h^{r_1}$ 的值</p>
<p>最后计算 $m\equiv c_2(h^{r_1})^{-1}\pmod p$ 得到flag</p>
<p>LCG 求解 ABq：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gcd</span>(a,b): 
    <span style="color:#66d9ef">if</span>(b<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>): 
        <span style="color:#66d9ef">return</span> a 
    <span style="color:#66d9ef">else</span>: 
        <span style="color:#66d9ef">return</span> gcd(b,a<span style="color:#f92672">%</span>b) 
s <span style="color:#f92672">=</span>  [<span style="color:#ae81ff">543263588863771657634119</span>, <span style="color:#ae81ff">628899245716105951093835</span>, <span style="color:#ae81ff">78708024695487418261582</span>, <span style="color:#ae81ff">598971435111109998816796</span>, <span style="color:#ae81ff">789474285039501272453373</span>]
t <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
    t<span style="color:#f92672">.</span>append(s[i]<span style="color:#f92672">-</span>s[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]) 
all_n <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
    all_n<span style="color:#f92672">.</span>append(gcd((t[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>t[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>t[i]<span style="color:#f92672">*</span>t[i]), (t[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">*</span>t[i]<span style="color:#f92672">-</span>t[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>t[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]))) 

MMI <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> A, n,s<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,t<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,N<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>: (n <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">and</span> t<span style="color:#f92672">%</span>N <span style="color:#f92672">or</span> MMI(n, A<span style="color:#f92672">%</span>n, t, s<span style="color:#f92672">-</span>A<span style="color:#f92672">//</span>n<span style="color:#f92672">*</span>t, N <span style="color:#f92672">or</span> n),<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)[n<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">1</span>] <span style="color:#75715e">#逆元计算</span>
<span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> all_n:
    n<span style="color:#f92672">=</span>abs(n)
    <span style="color:#66d9ef">if</span> n<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">continue</span>
    a<span style="color:#f92672">=</span>(s[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">-</span>s[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">*</span>MMI((s[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>s[<span style="color:#ae81ff">0</span>]),n)<span style="color:#f92672">%</span>n
    ani<span style="color:#f92672">=</span>MMI(a,n)
    b<span style="color:#f92672">=</span>(s[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>a<span style="color:#f92672">*</span>s[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">%</span>n
    print(a, b, n)
</code></pre></div><p>AMM 算法代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> random
<span style="color:#f92672">import</span> math
<span style="color:#f92672">import</span> libnum
<span style="color:#f92672">import</span> time
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> bytes_to_long,long_to_bytes
p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GF</span>(a):
    <span style="color:#66d9ef">global</span> p
    p <span style="color:#f92672">=</span> a
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">g</span>(a,b):
    <span style="color:#66d9ef">global</span> p
    <span style="color:#66d9ef">return</span> pow(a,b,p)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">AMM</span>(x,e,p):
    GF(p)
    y <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1</span>, p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">while</span> g(y, (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">//</span>e) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        y <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1</span>, p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
        print(y)
    <span style="color:#75715e">#p-1 = e^t*s</span>
    t <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">while</span> p <span style="color:#f92672">%</span> e <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        t <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        print(t)
    s <span style="color:#f92672">=</span> p <span style="color:#f92672">//</span> (e<span style="color:#f92672">**</span>t)
    <span style="color:#75715e"># s|ralpha-1</span>
    k <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>    
    <span style="color:#66d9ef">while</span>((s <span style="color:#f92672">*</span> k <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%</span> e <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>):
        k <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    alpha <span style="color:#f92672">=</span> (s <span style="color:#f92672">*</span> k <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> e
    
    a <span style="color:#f92672">=</span> g(y, (e <span style="color:#f92672">**</span> (t <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) ) <span style="color:#f92672">*</span> s)
    b <span style="color:#f92672">=</span> g(x, e <span style="color:#f92672">*</span> alpha <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
    c <span style="color:#f92672">=</span> g(y, s)
    h <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#75715e">#</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
        print(<span style="color:#e6db74">&#39;cur_i&#39;</span>,i)
        d <span style="color:#f92672">=</span> g(b,e<span style="color:#f92672">**</span>(t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>i))
        <span style="color:#66d9ef">if</span> d <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">else</span>:
            j <span style="color:#f92672">=</span> (<span style="color:#f92672">-</span>math<span style="color:#f92672">.</span>log(d,a) <span style="color:#f92672">%</span> e)
        b <span style="color:#f92672">=</span> b <span style="color:#f92672">*</span> (g(g(c, e), j))
        h <span style="color:#f92672">=</span> h <span style="color:#f92672">*</span> g(c, j)
        c <span style="color:#f92672">=</span> g(c,e)
    <span style="color:#66d9ef">return</span> (g(x,alpha <span style="color:#f92672">*</span> h)) <span style="color:#f92672">%</span> p
</code></pre></div><p>解题脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#coding=utf-8</span>
<span style="color:#f92672">from</span> gmpy2 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> amm <span style="color:#f92672">import</span> AMM
A <span style="color:#f92672">=</span> <span style="color:#ae81ff">12742153496769814072597</span>
B <span style="color:#f92672">=</span> <span style="color:#ae81ff">3035433788765894539799</span>
q <span style="color:#f92672">=</span> <span style="color:#ae81ff">791763770658839585424113</span>
<span style="color:#75715e"># A = 107868759310796409744994</span>
<span style="color:#75715e"># B = 492302818740419286543885</span>

p <span style="color:#f92672">=</span> <span style="color:#ae81ff">65211247300401312530078141569304950676358489059623557848188896752173856845051471066071652073612337629832155846984721797768267868868902023383604553319793550396610085424563231688918357710337401138108050205457200940158475922063279384491022916790549837379548978141370347556053597178221402425212594060342213485311</span>
g <span style="color:#f92672">=</span> <span style="color:#ae81ff">27642593390439430783453736408814717946185190497201679721975757020767271070510268596627490205095779429964809833535285315202625851326460572368018875381603399143376574281200028337681552876140857556460885848491160812604549770668188783258592940823128376128198726254875984002214053523752696104568469730021811399216</span>
h <span style="color:#f92672">=</span> <span style="color:#ae81ff">54585833166051670245656045196940486576634589000609010947618047461787934106392112227019662788387352615714332234871251868259282522817042504587428441746855906297390193418159792477477443129333707197013251839952389651332058368911829464978546505729530760951698134101053626585254469108630886768357270544236516534904</span>

c1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">60724920570148295800083597588524297283595971970237964464679084640302395172192639331196385150232229004030419122038089044697951208850497923486467859070476427472465291810423905736825272208842988090394035980454248119048131354993356125895595138979611664707727518852984351599604226889848831071126576874892808080133</span>
c2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">48616294792900599931167965577794374684760165574922600262773518630884983374432147726140430372696876107933565006549344582099592376234783044818320678499613925823621554608542446585829308488452057340023780821973913517239972817669309837103043456714481646128392677624092659929248296869048674230341175765084122344264</span>
c1_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">42875731538109170678735196002365281622531058597803022779529275736483962610547258618168523955709341579773947887175626960699426438456382655370090748369934296474999389316334717699127421889816721511602392591677377678759026657582648354688447456509292302633971842316239774410380221303269351351929586256938787054867</span>
c2_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">64829024929257668640929285124747107162970460545535885047576569803424908055130477684809317765011143527867645692710091307694839524199204611328374569742391489915929451079830143261799375621377093290249652912850024319433129432676683899459510155157108727860920017105870104383111111395351496171846620163716404148070</span>

k <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> q
<span style="color:#66d9ef">assert</span> k <span style="color:#f92672">*</span> q <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> p
<span style="color:#75715e"># print(q, k)</span>

hr1_A_1 <span style="color:#f92672">=</span> c2_ <span style="color:#f92672">*</span> invert(c2, p) <span style="color:#f92672">*</span> pow(h,<span style="color:#f92672">-</span>B, p) <span style="color:#f92672">%</span> p
<span style="color:#75715e"># print(hr1_A_1)</span>
d <span style="color:#f92672">=</span> xgcd(A <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">%</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)

cur_x <span style="color:#f92672">=</span> AMM(hr1_A_1, <span style="color:#ae81ff">7438</span>, p)
<span style="color:#75715e"># assert pow(cur_x, A - 1, p) == hr1_A_1</span>

d <span style="color:#f92672">=</span> xgcd(A <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">%</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
x_7438 <span style="color:#f92672">=</span> pow(hr1_A_1, d, p)

x_3719 <span style="color:#f92672">=</span> AMM(x_7438, <span style="color:#ae81ff">2</span>, p)
x_3719_ <span style="color:#f92672">=</span> p <span style="color:#f92672">-</span> x_3719

x_3719s <span style="color:#f92672">=</span> [x_3719, x_3719_]

mol <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">3719</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check</span>(mm):
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> mm:
		<span style="color:#66d9ef">if</span> i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">128</span>:
			<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>

<span style="color:#66d9ef">for</span> eve_c <span style="color:#f92672">in</span> x_3719s:
	cur_x <span style="color:#f92672">=</span> AMM(eve_c, <span style="color:#ae81ff">3719</span>, p)
	<span style="color:#66d9ef">assert</span> pow(cur_x, A <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, p) <span style="color:#f92672">==</span> hr1_A_1
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">6000</span>):
		cur_use <span style="color:#f92672">=</span> cur_x <span style="color:#f92672">*</span> pow(i, mol, p)
		<span style="color:#66d9ef">assert</span> pow(cur_use, A <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, p) <span style="color:#f92672">==</span> hr1_A_1
		cur_m <span style="color:#f92672">=</span> xgcd(cur_use, p)[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> c2 <span style="color:#f92672">%</span> p
		cur_m <span style="color:#f92672">=</span> n2s(int(cur_m))
		<span style="color:#66d9ef">if</span> check(cur_m):
			print(cur_m)
			<span style="color:#66d9ef">break</span>
<span style="color:#75715e"># b&#39;flag{19e9f185e6a680324cedd6e6d9382743}&#39;</span>
</code></pre></div><h2 id="misc">Misc</h2>
<h3 id="badpdf">badPDF</h3>
<p>文件在运行之后在 <code>%tmp%</code> 目录下释放了三个文件，将 js 和 tmp 都提取出来</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 191; 
			flex-basis: 459px"
	>
	<a href="/post/hws2022-writeup/image-20220124212037970.png" data-size="993x519">
		<img src="/post/hws2022-writeup/image-20220124212037970.png"
			width="993"
			height="519"
			srcset="/post/hws2022-writeup/image-20220124212037970_hu63f6623ef9d48b9fa7ae58442718ad86_33005_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124212037970_hu63f6623ef9d48b9fa7ae58442718ad86_33005_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>tmp的内容好像是在混淆，查了一下应该是使用 <code>winrm.vbs</code> 绕过应用白名单执行任意未签名代码(<a class="link" href="https://www.anquanke.com/post/id/151711"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/151711</a>)，再一找发现是原题</p>
<p>找个 vbs 脚本改一下</p>
<pre tabindex="0"><code class="language-vbscript" data-lang="vbscript">for i= 1 to len(&quot;676d60667a64333665326564333665326564333665326536653265643336656564333665327c&quot;) step 2:
	flag = flag &amp; chr(asc(chr(&quot;&amp;h&quot; &amp; mid(&quot;676d60667a64333665326564333665326564333665326536653265643336656564333665327c&quot;,i,2)))xor 1):
	next:
msgbox(flag)
</code></pre><p>运行结果：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 182; 
			flex-basis: 438px"
	>
	<a href="/post/hws2022-writeup/image-20220124161134316.png" data-size="298x163">
		<img src="/post/hws2022-writeup/image-20220124161134316.png"
			width="298"
			height="163"
			srcset="/post/hws2022-writeup/image-20220124161134316_hu480744dbff6bc1ed45331d426702f983_7568_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124161134316_hu480744dbff6bc1ed45331d426702f983_7568_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="gogogo">gogogo</h3>
<p>先解puzzle，gaps不知道为啥跑不动，手动硬拼，口令是3e8f092d4d7b80ce338d6e238efb01</p>
<p>随后是个内存取证，在内存剪切板上又看到了上面的口令，确定了该口令只有30位而不是个md5</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 774; 
			flex-basis: 1858px"
	>
	<a href="/post/hws2022-writeup/image-20220124212246733.png" data-size="1061x137">
		<img src="/post/hws2022-writeup/image-20220124212246733.png"
			width="1061"
			height="137"
			srcset="/post/hws2022-writeup/image-20220124212246733_hucc2b3df8a35389a3ad06fc7fe93cda85_128221_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124212246733_hucc2b3df8a35389a3ad06fc7fe93cda85_128221_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>在内存的文件找到了csgo.zip，用口令解密拿到图片，但显示不出来，用010editor打开图片，发现png文件头重复，删掉一个，看到正经图片，但是缺少定位符</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 317; 
			flex-basis: 761px"
	>
	<a href="/post/hws2022-writeup/image-20220124212525281.png" data-size="387x122">
		<img src="/post/hws2022-writeup/image-20220124212525281.png"
			width="387"
			height="122"
			srcset="/post/hws2022-writeup/image-20220124212525281_hu5711cb69a37a3679f077ddf2a23f05c1_10702_480x0_resize_box_3.png 480w, /post/hws2022-writeup/image-20220124212525281_hu5711cb69a37a3679f077ddf2a23f05c1_10702_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>图片是个Aztec码，找了个二层的定位符，硬拼一下，在线网站直接解(<a class="link" href="https://products.aspose.app/barcode/recognize/aztec#/recognized"  target="_blank" rel="noopener"
    >https://products.aspose.app/barcode/recognize/aztec#/recognized</a>)</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 100; 
			flex-basis: 240px"
	>
	<a href="/post/hws2022-writeup/flag2.jpg" data-size="433x432">
		<img src="/post/hws2022-writeup/flag2.jpg"
			width="433"
			height="432"
			srcset="/post/hws2022-writeup/flag2_huc5086ebb22bf916465b83c2a7c530445_42222_480x0_resize_q75_box.jpg 480w, /post/hws2022-writeup/flag2_huc5086ebb22bf916465b83c2a7c530445_42222_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>flag:</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 132; 
			flex-basis: 317px"
	>
	<a href="/post/hws2022-writeup/getflag.jpg" data-size="930x704">
		<img src="/post/hws2022-writeup/getflag.jpg"
			width="930"
			height="704"
			srcset="/post/hws2022-writeup/getflag_hu23b5a80d39962219c3277f1e334fbc68_253718_480x0_resize_q75_box.jpg 480w, /post/hws2022-writeup/getflag_hu23b5a80d39962219c3277f1e334fbc68_253718_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<<<<<<< HEAD

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/hws/">HWS</a>
        
            <a href="/tags/re/">Re</a>
        
            <a href="/tags/crypto/">Crypto</a>
        
            <a href="/tags/misc/">Misc</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/cazy-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/cazy-writeup-by-or4nge/cover.b7dbd864c0b986f185463e4e1e361913_hu2ef483a7301ed58558e75f3e1747bee2_206467_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-t9vYZMC5hvGFRj5OHjYZEw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">长安战“疫” Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/dnuictf-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/dnuictf-writeup-by-or4nge/Top%2010%20Teams.a2ec5f685d98dbff218d75d526fbc61d_hu9bd851d71a6520395d404c81ac536fbe_87588_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-ouxfaF2Y2/8hjXXVJvvGHQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2021暗泉杯 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/bluehat-final-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">2021蓝帽杯决赛 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/sctf2021-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/sctf2021-writeup-by-or4nge/cover.6ca02a7e0f493e356da43aef89bb74bf_hu20e70d2f1ec0ceae4e2274ecf0db6e8c_615875_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-bKAqfg9JPjVtpDrvibt0vw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SCTF2021 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/kctf2021-fall-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/kctf2021-fall-writeup-by-or4nge/cover.d3f800bd94671a07795ef31abe675705_hufd6827b5e92508a15177056d76ff05d4_2462797_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-0/gAvZRnGgd5XvMavmdXBQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">KCTF2021 Fall Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
=======

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/hws/">HWS</a>
        
            <a href="/tags/re/">Re</a>
        
            <a href="/tags/crypto/">Crypto</a>
        
            <a href="/tags/misc/">Misc</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/cazy-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/cazy-writeup-by-or4nge/cover.b7dbd864c0b986f185463e4e1e361913_hu2ef483a7301ed58558e75f3e1747bee2_206467_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-t9vYZMC5hvGFRj5OHjYZEw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">长安战“疫” Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/dnuictf-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/dnuictf-writeup-by-or4nge/Top%2010%20Teams.a2ec5f685d98dbff218d75d526fbc61d_hu9bd851d71a6520395d404c81ac536fbe_87588_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-ouxfaF2Y2/8hjXXVJvvGHQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2021暗泉杯 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/bluehat-final-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">2021蓝帽杯决赛 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/sctf2021-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/sctf2021-writeup-by-or4nge/cover.6ca02a7e0f493e356da43aef89bb74bf_hu20e70d2f1ec0ceae4e2274ecf0db6e8c_615875_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-bKAqfg9JPjVtpDrvibt0vw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SCTF2021 Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/kctf2021-fall-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/kctf2021-fall-writeup-by-or4nge/cover.d3f800bd94671a07795ef31abe675705_hufd6827b5e92508a15177056d76ff05d4_2462797_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-0/gAvZRnGgd5XvMavmdXBQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">KCTF2021 Fall Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
>>>>>>> 0b781f88c4081f7a9d007cfd2302254a37f661ad
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#re">RE</a>
      <ul>
        <li><a href="#babyvm">babyVM</a></li>
        <li><a href="#easyvm">EasyVM</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#babyrsa">babyrsa</a></li>
        <li><a href="#crypto_elgamal">crypto_Elgamal</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#badpdf">badPDF</a></li>
        <li><a href="#gogogo">gogogo</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
